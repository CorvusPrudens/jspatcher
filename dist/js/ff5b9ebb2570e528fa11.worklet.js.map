{"version":3,"sources":["webpack://JSPatcher/./src/core/PackageManager.ts","webpack://JSPatcher/./src/core/Project.ts","webpack://JSPatcher/./src/core/TaskMgr.ts","webpack://JSPatcher/./src/core/WorkletGlobalPackageManager.ts","webpack://JSPatcher/./src/core/WorkletSDK.ts","webpack://JSPatcher/./src/core/audio/TempAudioFile.ts","webpack://JSPatcher/./src/core/file/AbstractProjectFile.ts","webpack://JSPatcher/./src/core/file/AbstractProjectFolder.ts","webpack://JSPatcher/./src/core/file/AbstractProjectItem.ts","webpack://JSPatcher/./src/core/file/AbstractProjectItemManager.ts","webpack://JSPatcher/./src/core/file/FileEditor.ts","webpack://JSPatcher/./src/core/file/FileInstance.ts","webpack://JSPatcher/./src/core/file/History.ts","webpack://JSPatcher/./src/core/file/PersistentProjectFile.ts","webpack://JSPatcher/./src/core/file/PersistentProjectFolder.ts","webpack://JSPatcher/./src/core/file/TempData.ts","webpack://JSPatcher/./src/core/file/TemporaryProjectFile.ts","webpack://JSPatcher/./src/core/file/TemporaryProjectFolder.ts","webpack://JSPatcher/./src/core/file/TemporaryProjectItemManager.ts","webpack://JSPatcher/./src/core/file/WorkletProjectItemManager.ts","webpack://JSPatcher/./src/core/objects/base/AbstractObject.ts","webpack://JSPatcher/./src/core/objects/base/Bang.ts","webpack://JSPatcher/./src/core/objects/base/BaseObject.ts","webpack://JSPatcher/./src/core/objects/base/generateRemotedObject.ts","webpack://JSPatcher/./src/core/objects/base/index.jsdsppkg.aw.ts","webpack://JSPatcher/./src/core/objects/globalThis/index.jsdsppkg.ts","webpack://JSPatcher/./src/core/objects/importer/Func.tsx","webpack://JSPatcher/./src/core/objects/importer/Getter.ts","webpack://JSPatcher/./src/core/objects/importer/ImportedObject.tsx","webpack://JSPatcher/./src/core/objects/importer/Importer.ts","webpack://JSPatcher/./src/core/objects/importer/Method.ts","webpack://JSPatcher/./src/core/objects/importer/New.tsx","webpack://JSPatcher/./src/core/objects/importer/Property.ts","webpack://JSPatcher/./src/core/objects/importer/RemotedImporter.ts","webpack://JSPatcher/./src/core/objects/importer/Setter.ts","webpack://JSPatcher/./src/core/objects/importer/SetterGetter.ts","webpack://JSPatcher/./src/core/objects/importer/StaticGetter.ts","webpack://JSPatcher/./src/core/objects/importer/StaticMethod.ts","webpack://JSPatcher/./src/core/objects/importer/StaticProperty.ts","webpack://JSPatcher/./src/core/objects/importer/StaticSetter.ts","webpack://JSPatcher/./src/core/objects/importer/StaticSetterGetter.ts","webpack://JSPatcher/./src/core/objects/jsaw/AudioIn.ts","webpack://JSPatcher/./src/core/objects/jsaw/AudioOut.ts","webpack://JSPatcher/./src/core/objects/jsaw/In.ts","webpack://JSPatcher/./src/core/objects/jsaw/Out.ts","webpack://JSPatcher/./src/core/objects/jsaw/Param.ts","webpack://JSPatcher/./src/core/objects/jsaw/index.jsdsppkg.aw.ts","webpack://JSPatcher/./src/core/patcher/Box.ts","webpack://JSPatcher/./src/core/patcher/FaustPatcherAnalyser.ts","webpack://JSPatcher/./src/core/patcher/Line.ts","webpack://JSPatcher/./src/core/patcher/Patcher.ts","webpack://JSPatcher/./src/core/patcher/PatcherEditor.ts","webpack://JSPatcher/./src/core/patcher/PatcherHistory.ts","webpack://JSPatcher/./src/core/patcher/TempPatcherFile.ts","webpack://JSPatcher/./src/core/text/TempTextFile.ts","webpack://JSPatcher/./src/core/worklets/AudioWorkletProxyProcessor.ts","webpack://JSPatcher/./src/utils/TypedEventEmitter.ts","webpack://JSPatcher/./src/utils/symbols.ts","webpack://JSPatcher/./src/utils/utils.ts","webpack://JSPatcher/webpack/bootstrap","webpack://JSPatcher/webpack/runtime/compat get default export","webpack://JSPatcher/webpack/runtime/define property getters","webpack://JSPatcher/webpack/runtime/ensure chunk","webpack://JSPatcher/webpack/runtime/hasOwnProperty shorthand","webpack://JSPatcher/webpack/runtime/make namespace object","webpack://JSPatcher/webpack/runtime/publicPath","webpack://JSPatcher/./src/core/worklets/WorkletEnv.worklet.ts"],"names":["PackageManager","TypedEventEmitter","global","patcher","env","pkgMgr","mode","props","constructor","init","pkg","lib","packageRegister","remove","id","importFromURL","url","Error","emit","libOut","rootifyDepth","Infinity","pathIn","path","slice","length","ImporterDirSelfObject","el","isJSPatcherObjectConstructor","full","join","p","k","shift","key","searchInLib","query","limit","staticMethodOnly","keys","Object","sort","items","i","startsWith","o","push","object","searchInPkg","outs","indexOf","getFromPath","Project","audioCtx","envIn","name","default","author","version","setProps","changed","keyIn","save","load","clean","fileMgr","item","getProjectItemFromPath","projectFilename","json","JSON","parse","ab2str","data","error","str2ab","stringify","projectRoot","addFile","unload","instances","project","destroy","type","description","TaskManager","tasks","_tasks","filter","e","errors","_errors","newTask","emitter","message","callback","thread","globalThis","timestamp","Date","now","_id","task","$","returnValue","handleUpdate","msg","taskError","lastError","a","b","lastTask","getTasksFromEmitter","getErrorsFromEmitter","dismissLastError","dismissAllErrors","WorkletGlobalPackageManager","Map","jsaw","Base","getBase","getGlobalThis","addObjects","getDescriptors","toDescriptor","O","pkgName","isObjectDescriptor","ctor","importedObjectType","pkgIn","$self","entries","reduce","acc","v","descriptor","add","assign","fetchModule","toExport","exports","module","addWorkletModule","exported","importPackage","getter","JSPatcherWorkletSDK","Patcher","Box","Line","BaseObject","generateRemotedObject","Bang","isBang","TempAudioFile","TemporaryProjectFile","instantiate","instantiateEditor","instanceId","AudioEditor","fromProjectItem","file","AbstractProjectFile","AbstractProjectItem","getTypeFromFileName","_data","dataIn","fileExtension","splitted","split","fileMgrIn","parentIn","nameIn","onAny","eventName","eventData","isFolder","newData","by","emitChanged","saveAsCopy","parent","manager","clone","emitTreeChanged","saveAs","to","newName","from","move","AbstractProjectFolder","isDirty","getDescendantFiles","every","f","Set","findItem","itemIn","Array","find","existItem","has","uniqueName","empty","getTree","map","cur","isParentOf","getOrderedItems","folders","localeCompare","files","_fileMgr","_name","_isDirty","parentPath","projectPath","replace","RegExp","projectFolderName","addObserver","observer","_observers","removeObserver","delete","on","dirty","generateItemId","AbstractProjectItemManager","allItems","rec","forEach","root","allProjectItems","generateId","taskMgr","emptyProject","ext","extToType","getProjectItemFromId","pathArray","itemArray","pop","next","getPathIdMap","instantiateProjectPath","projectIn","FileEditor","instance","value","ctx","isInMemory","isTemporary","isReadonly","isReady","_isReady","isDestroyed","_isDestroyed","history","isLocked","fileIcon","setActive","activeEditor","isActive","handleDestroy","addEditor","handleReady","off","editorId","registerInstance","handleProjectSave","handleProjectUnload","toFileData","serialize","toTempData","undo","redo","copy","cut","paste","deleteSelected","selectAll","onUiResized","removeEditor","FileInstance","_env","_project","_file","_isReadonly","activeInstance","getEditor","size","_history","History","editor","eventListening","capture","Promise","all","editors","$editor","eventQueue","splice","saveTime","emitDirty","performance","timeOrigin","timing","navigationStart","handleEditorEvent","handleSaved","once","offAny","isUndoable","isRedoable","undoOf","redoOf","undoUntil","redoUntil","setIndex","getSyncData","syncData","PersistentProjectFile","sab","_sab","SharedArrayBuffer","byteLength","ui8ab","Uint8Array","ui8sab","lastModifiedId","readFile","Ctor","putFile","rename","newNameIn","trim","oldName","Constructor","audio","image","text","video","undefined","unknown","PersistentProjectFolder","readDir","rawItem","createProjectItem","tempItem","fileDetail","getFileDetails","addFolder","folder","TempData","persistentMgr","_this","setPrototypeOf","options","TemporaryProjectFolder","typeIn","TempPatcherFile","TempTextFile","TemporaryProjectItemManager","WorkletProjectItemManager","cachedPathIdMap","fileMgrGetPathIdMap","getDataForDiff","processDiff","diff","disabled","process","$item","$parentId","current","newFile","fileMgrReadFile","fileMgrReadDir","fileMgrGetFileDetails","exists","fileMgrExists","fileMgrPutFile","writeFile","fileMgrWriteFile","oldPath","newPath","importFileZip","subfolder","taskHost","exportProjectZip","x","isJSPatcherObject","AbstractObject","meta","package","icon","inlets","outlets","args","isPatcherInlet","isPatcherOutlet","class","_patcher","box","_box","_meta","setMeta","metaIn","oldMeta","setData","oldData","getProp","rect","presentationRect","background","presentation","setInlets","setOutlets","outletLines","inletLines","stateIn","oldState","state","propsIn","oldProps","update","oldArgs","subscribe","postInit","updateUI","updateArgs","undoable","updateProps","updateState","fn","inlet","propsInKeys","propsKeys","outlet","line","pass","outletAll","outputs","connectedOutlet","destBoxId","destInlet","lineId","connectedInlet","srcBoxId","srcOutlet","disconnectedOutlet","disconnectedInlet","post","newLog","stringifyError","s","info","warn","highlight","connectAudio","allLines","enable","connectAudioInlet","portIn","lines","port","connectAudioOutlet","disconnectAudio","disable","disconnectAudioInlet","disconnectAudioOutlet","applyBPF","param","bpf","currentTime","cancelScheduledValues","setValueAtTime","t","linearRampToValueAtTime","getSharedItem","onceCreate","newItem","tempMgr","d","handleFileMgrTreeChanged","handleTempMgrTreeChanged","toString","isUIState","uiState","isUIStateKey","thisName","superMeta","getPrototypeOf","superProps","thisProps","group","setArgs","updateUIFromProps","hidden","ignoreClick","hint","RemotedObject","proxy","patcherProcessor","handleBoxIoCountChanged","objectEmitFromWorklet","EmptyObject","InvalidObject","func","Func","new","New","getIO","RemotedImporter","Wrapper","imported","activeLib","prototype","StaticMethod","Method","output","loading","c","r","isHot","optional","varLength","Getter","ImportedObject","result","execute","handlePreInit","handleInlet","then","sync","AnyImportedObject","Importer","getObject","writeInPath","import","outIn","stackIn","depthIn","depth","out","stack","jspatcherEnv","getPropertyDescriptors","newObj","prop","enumerable","isArray","inputs","argsCount","Math","max","initialInlets","initialOutlets","call","spreadArgs","Fn","Property","NewBase","FuncBase","PropertyBase","GetterBase","Setter","SetterBase","SetterGetter","SetterGetterBase","MethodBase","StaticProperty","StaticPropertyBase","StaticGetter","StaticGetterBase","StaticSetter","StaticSetterBase","StaticSetterGetter","StaticSetterGetterBase","StaticMethodBase","DefaultImporter","isStatic","Super","setter","set","get","input","handleUpdateArgs","ImportedStaticMethodObject","AudioIn","index","sample","changeIO","emitPatcherChangeIO","_","outlet0","handlePatcherInput","AudioOut","sampleIndex","inlet0","outputAudio","In","enums","Out","Param","in","patcherIn","boxIn","_inletLines","fill","_outletLines","maxBoxIn","patching_rect","presentation_rect","prevData","storage","_editing","_parsed","parseObjText","newMeta","getObjectMeta","getObjectConstructor","_Object","defaultSize","isTPresentationRect","presentationSize","_object","UI","oIn","parsed","addInletLine","removeInletLine","addOutletLine","removeOutletLine","count","linesSetLength","uiUpdateDest","uiUpdateSrc","getInletPos","left","top","width","getOutletPos","height","inletsPositions","positions","outletsPositions","isSrc","last","getLinesBySrcID","getLinesByDestID","isOutletTo","iterator","values","done","destBox","isInletFrom","srcBox","changeText","textIn","force","oldDefaultSize","isTRect","setRect","setPresentationRect","setPresentation","setBackground","position","leftIn","topIn","presentationPosition","widthIn","heightIn","getLeft","inPresentation","rectKey","setLeft","positionKey","getTop","setTop","getWidth","setWidth","sizeKey","getHeight","setHeight","bool","getIsMovable","isRectMovable","getIsResizable","isRectResizable","highlightPort","boxChanged","changeObject","deleteLine","boxes","strIn","REGEX","strArray","match","exec","objOut","lastProp","charAt","substr","parseToPrimitive","toSerializable","mapLines","visitedBoxes","ins","recs","lineMap","sendID","sendMap","resultID","toFaustLambda","lambdaName","exprs","onces","mainIns","mainOuts","recIns","recOuts","toExpr","reverse","recIn","recOut","in_","toNormalExpr","unshift","toFaustDspCode","inspectFaustPatcher","code","imports","effects","boxId","fxOnces","fxExprs","fxIns","toOnceExpr","isConnectableByAudio","fromConnection","outletAudioConnections","toConnection","inletAudioConnections","node","isWamNode","isWebAudioModule","compare","line1","line2","positionHash","lineIn","calcType","_type","src","dest","updateType","setSrc","srcId","getSrc","srcPos","setDest","destId","getDest","destPos","getLinesByBox","isAudioParam","AudioParam","disconnect","disconnectEvents","connect","connectEvents","srcMeta","destMeta","srcType","destType","PatcherEditor","PatcherHistory","_state","log","selected","preventEmitChanged","dependencies","bgColor","editingBgColor","grid","openInPresentation","boxIndexCount","lineIndexCount","activePkg","js","gen","faust","fileName","emitGraphChanged","ArrayBuffer","Response","splitName","extMap","jspat","maxpat","gendsp","dsppat","modeIn","$init","max2js","depNames","onUpdate","createBox","numID","parseInt","createLine","getPatcherNode","PatcherNode","register","audioWorklet","patcherNode","fileId","loadFromURL","fetch","loadFromString","sIn","loadFromFile","reader","FileReader","onload","onerror","readAsText","addPackage","namespace","removePackage","findIndex","className","changeBoxText","oldText","deleteBox","canCreateLine","changeLineSrc","oldSrc","changeLineDest","destOutlet","oldDest","srcOuts","destIns","srcOutsWraped","concat","destInsWraped","idOut","idIn","inputAudio","inputParam","_inletAudioConnections","_outletAudioConnections","inspectAudioIO","inputBoxes","outputBoxes","parametersBoxes","arg0","metaFromPatcher","errorLevel","title","publicProps","spacing","js2max","Blob","arrayBuffer","locked","showGrid","snapToGrid","setState","resolve","reject","handleChanged","handleChangeBoxText","handlePassiveDeleteLine","handleBoxChanged","deselectAll","createBoxFromFile","obj","deselect","changeBox","change","select","ids","selectAllBoxes","selectOnly","selectedToString","lineSet","pasteToPatcher","clipboard","idMap","pasted","$postInit","maxBoxes","maxBox","numinlets","numoutlets","maxclass","createdBoxes","maxLines","lineArgs","patchline","source","destination","createdLine","create","objects","created","boxSet","deleted","promises","navigator","writeText","readText","duplicate","selectRegion","selectionRect","selectedBefore","right","bottom","boxLeft","boxTop","boxWidth","boxHeight","boxRight","boxBottom","moveSelectedBox","dragOffset","refBoxID","delta","y","round","moveEnd","$left","$top","resizeSelectedBox","resize","resizeEnd","$width","$height","min","sizingX","sizing","sizingY","findNearestPort","findSrc","nearest","minDistance","currentPos","currentDistance","pos","distance","canCreate","highlightNearestPort","origPos","tempLine","inspector","found","dockUI","dockable","TextEditor","AudioWorkletProcessor","Processor","fnNames","resolves","rejects","messagePortRequestId","handleDisposed","removeEventListener","handleMessage","close","postMessage","_disposed","start","addEventListener","$AnyEventType","Symbol","listeners","_listeners","getListeners","listener","listenerWithOff","arg","anyListeners","excludeAny","exclude","l","emitSerial","returnValues","emitSync","offAll","listenerCount","anyListenerCount","SharedDataNoValue","TempManagerFolder","isStringArray","isNumberArray","isMIDIEvent","rgbaMax2Css","maxColor","cssColor","floor","css2RgbaMax","color","matched","decodeBPF","tupleLength","numbers","isFinite","tuples","$tuple","decodeCurve","decodeLine","detectOS","appVersion","detectBrowserCore","window","chrome","InstallTrigger","vendor","roundedRect","radius","radii","beginPath","moveTo","lineTo","quadraticCurveTo","closePath","stroke","fillRoundedRect","selectElementRange","elementIsEditable","nodeName","selection","getSelection","focus","setBaseAndExtent","hasChildNodes","addRange","removeAllRanges","document","createRange","range","selectNodeContents","selectElementPos","setStart","childNodes","collapse","findFromAscendants","predict","ascendants","parentElement","body","getPropertyDescriptor","getOwnPropertyDescriptor","getOwnPropertyDescriptors","proto","maxPatcher","bgcolor","editing_bgcolor","gridsize","openinpresentation","convertSampleToUnit","unit","sampleRate","bpm","beatsPerMeasure","division","str","milliseconds","roundedMs","dpms","totalDivisions","roundedTotalDivisions","divisions","beats","measure","padStart","ms","h","MEASURE_UNIT_REGEX","TIME_UNIT_REGEX","convertUnitToSample","measureIn","beatsIn","divisionsIn","bps","samplesPerBeat","measures","hIn","minIn","msIn","ab2sab","ab","sab2ab","buf","String","fromCharCode","apply","Uint16Array","bufView","strLen","charCodeAt","processorId","registerProcessor","WorkletEnvProcessor","AudioWorkletProxyProcessor","fileMgrDiff","os","browser","language","generatedId","processorOptions","currentProject","bindTaskMgr","bindFileMgr","emitterIn","envNewLog","objectIn","Atomics","ee","getInstanceById","handleTaskBegin","taskBegin","handleTaskUpdate","taskUpdate","handleTaskError","handleTaskEnd","taskEnd","handleFileMgrChange","workletFileMgrDiff","console"],"mappings":"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","file":"js/ff5b9ebb2570e528fa11.worklet.js","sourcesContent":["import TypedEventEmitter from \"../utils/TypedEventEmitter\";\nimport { ImporterDirSelfObject } from \"../utils/symbols\";\nimport { isJSPatcherObjectConstructor, IJSPatcherObject } from \"./objects/base/AbstractObject\";\nimport type { TFlatPackage, TPackage } from \"./types\";\nimport type Patcher from \"./patcher/Patcher\";\n\nexport interface PackageManagerEventMap {\n    \"libChanged\": never;\n    \"pathDuplicated\": string;\n}\n\nexport interface IPackageManager extends TypedEventEmitter<PackageManagerEventMap> {\n    pkg: TPackage;\n    lib: TFlatPackage;\n    importFromURL(url: string, id: string): Promise<void>;\n    remove(id: string): void;\n}\n\nexport default class PackageManager extends TypedEventEmitter<PackageManagerEventMap> implements IPackageManager {\n    private readonly patcher: Patcher;\n    pkg: TPackage;\n    lib: TFlatPackage;\n    get global() {\n        return this.patcher.env.pkgMgr;\n    }\n    get mode() {\n        return this.patcher.props.mode;\n    }\n    constructor(patcher: Patcher) {\n        super();\n        this.patcher = patcher;\n        this.init();\n    }\n    init() {\n        this.pkg = { ...this.global[this.mode] };\n        this.lib = this.packageRegister(this.pkg);\n    }\n    remove(id: string) {}\n    async importFromURL(url: string, id: string) {\n        if (!this.global.importFromURL) throw new Error(\"Cannot import from this context\");\n        await this.global.importFromURL(url, id);\n        this.init();\n        this.emit(\"libChanged\");\n    }\n    packageRegister(pkg: TPackage, libOut: TFlatPackage = {}, rootifyDepth = Infinity, pathIn?: string[]) {\n        const path = pathIn ? pathIn.slice() : [];\n        if (path.length && ImporterDirSelfObject in pkg) {\n            const el = pkg[ImporterDirSelfObject as any];\n            if (isJSPatcherObjectConstructor(el)) {\n                const full = path.join(\".\");\n                if (full in libOut) this.emit(\"pathDuplicated\", full);\n                // this.patcher.newLog(\"warn\", \"Patcher\", \"Path duplicated, cannot register \" + full, this);\n                else libOut[full] = el as typeof IJSPatcherObject;\n                const p = path.slice();\n                while (p.length && path.length - p.length < rootifyDepth) {\n                    const k = p.join(\".\");\n                    if (!(k in libOut)) libOut[k] = el as typeof IJSPatcherObject;\n                    p.shift();\n                }\n            }\n        }\n        for (const key in pkg) {\n            const el = pkg[key];\n            if (typeof el === \"object\") {\n                this.packageRegister(el, libOut, rootifyDepth, [...path, key]);\n            } else if (isJSPatcherObjectConstructor(el)) {\n                const full = [...path, key].join(\".\");\n                if (full in libOut) this.emit(\"pathDuplicated\", full);\n                // this.patcher.newLog(\"warn\", \"Patcher\", \"Path duplicated, cannot register \" + full, this);\n                else libOut[full] = el;\n                const p = [...path, key];\n                while (p.length && path.length + 1 - p.length < rootifyDepth) {\n                    const k = p.join(\".\");\n                    if (!(k in libOut)) libOut[k] = el;\n                    p.shift();\n                }\n            }\n        }\n        return libOut;\n    }\n    searchInLib(query: string, limit = Infinity, staticMethodOnly = false, lib: TFlatPackage) {\n        const keys = Object.keys(lib).sort();\n        const items: { key: string; object: typeof IJSPatcherObject }[] = [];\n        for (let i = 0; i < keys.length; i++) {\n            if (items.length >= limit) break;\n            const key = keys[i];\n            if (key.startsWith(query)) {\n                const o = lib[key];\n                if (staticMethodOnly) {\n                    if (o[ImporterDirSelfObject as unknown as keyof typeof IJSPatcherObject]) {\n                        items.push({ key, object: o });\n                    }\n                } else {\n                    items.push({ key, object: o });\n                }\n            }\n        }\n        return items;\n    }\n    searchInPkg(query: string, limit = Infinity, staticMethodOnly = false, pkg: TPackage, path: string[] = []): { path: string[]; object?: typeof IJSPatcherObject | TPackage }[] {\n        const outs: { path: string[]; object?: typeof IJSPatcherObject | TPackage }[] = [];\n        for (const key in pkg) {\n            if (outs.length >= limit) break;\n            const o = pkg[key];\n            if (typeof o === \"object\") {\n                if (key.indexOf(query) !== -1) outs.push({ path: [...path, key], object: o });\n                else outs.push(...this.searchInPkg(query, limit, staticMethodOnly, o, [...path, key]));\n            } else {\n                if (key.indexOf(query) !== -1) outs.push({ path: [...path, key], object: o });\n            }\n        }\n        return outs;\n    }\n    getFromPath(pathIn: (string | symbol)[], pkg: TPackage) {\n        const path = pathIn.slice();\n        let o: TPackage | typeof IJSPatcherObject = pkg;\n        while (path.length) {\n            const key = path.shift() as any;\n            o = (o as TPackage)[key];\n            if (!o) return null;\n            if (typeof o !== \"object\" && !isJSPatcherObjectConstructor(o)) return null;\n        }\n        return o;\n    }\n}\n","import TypedEventEmitter from \"../utils/TypedEventEmitter\";\nimport { ab2str, str2ab } from \"../utils/utils\";\nimport type Env from \"./Env\";\nimport type FileInstance from \"./file/FileInstance\";\nimport type PersistentProjectFile from \"./file/PersistentProjectFile\";\nimport type { IJSPatcherEnv } from \"./Env\";\nimport type { IPropsMeta } from \"./objects/base/AbstractObject\";\n\nexport interface ProjectEventMap {\n    \"propsChanged\": Partial<ProjectProps>;\n    \"save\": never;\n    \"unload\": never;\n}\nexport interface ProjectProps {\n    name: string;\n    author: string;\n    version: string;\n}\n\nexport interface IProject extends TypedEventEmitter<ProjectEventMap> {\n}\n\nexport default class Project extends TypedEventEmitter<ProjectEventMap> {\n    static props: IPropsMeta<ProjectProps> = {\n        name: {\n            type: \"string\",\n            description: \"Project name\",\n            default: \"Untitled\"\n        },\n        author: {\n            type: \"string\",\n            description: \"Author\",\n            default: \"Anonymous\"\n        },\n        version: {\n            type: \"string\",\n            description: \"Current version\",\n            default: \"0.0.0\"\n        }\n    };\n    readonly projectFilename = \".jspatproj\";\n    readonly env: IJSPatcherEnv;\n    readonly instances: FileInstance[];\n    readonly props: ProjectProps = {\n        name: Project.props.name.default,\n        author: Project.props.author.default,\n        version: Project.props.version.default\n    };\n    get audioCtx() {\n        return (this.env as Env).audioCtx;\n    }\n    constructor(envIn: IJSPatcherEnv) {\n        super();\n        this.env = envIn;\n    }\n    setProps(props: Partial<ProjectProps>) {\n        let changed = false;\n        for (const keyIn in props) {\n            const key = keyIn as keyof ProjectProps;\n            if (this.props[key] === props[key]) continue;\n            changed = true;\n            (this.props as any)[key] = props[key];\n        }\n        if (changed) this.emit(\"propsChanged\", props);\n    }\n    async save() {\n        await this.emit(\"save\");\n    }\n    async load(clean = false) {\n        await this.env.fileMgr.init(clean);\n        await this.init();\n    }\n    async init() {\n        try {\n            const item = this.env.fileMgr.getProjectItemFromPath(`./${this.projectFilename}`) as PersistentProjectFile;\n            const json = JSON.parse(ab2str(item.data)) as ProjectProps;\n            this.setProps(json);\n        } catch (error) {\n            const data = str2ab(JSON.stringify(this.props));\n            await this.env.fileMgr.projectRoot.addFile(this.projectFilename, data);\n        }\n    }\n    async unload() {\n        for (const i of this.env.instances) {\n            if (i.project === this) await i.destroy();\n        }\n        await this.emit(\"unload\");\n    }\n}\n","import TypedEventEmitter from \"../utils/TypedEventEmitter\";\n\nexport interface Task {\n    /** thread + numberId */\n    id: string;\n    timestamp: number;\n    thread: string;\n    emitter: Object | string;\n    message: string;\n    callback: (onUpdate?: (newMsg: string) => any) => any | Promise<any>;\n}\n\nexport interface TaskError {\n    id: string;\n    timestamp: number;\n    thread: string;\n    emitter: Object | string;\n    message: string;\n    error: Error;\n}\n\nexport interface TaskManagerEventMap {\n    \"taskBegin\": Task;\n    \"taskUpdate\": Task;\n    \"taskEnd\": Task;\n    \"taskError\": TaskError;\n    \"tasks\": Task[];\n    \"errors\": TaskError[];\n}\n\nexport default class TaskManager extends TypedEventEmitter<TaskManagerEventMap> {\n    _id = 0;\n    _tasks: { [thread: string]: Task[] } = {};\n    _errors: { [thread: string]: TaskError[] } = {};\n    get tasks() {\n        const tasks: Task[] = [];\n        for (const key in this._tasks) {\n            tasks.push(...this._tasks[key].filter(e => !!e));\n        }\n        return tasks;\n    }\n    get errors() {\n        const errors: TaskError[] = [];\n        for (const key in this._errors) {\n            errors.push(...this._errors[key].filter(e => !!e));\n        }\n        return errors;\n    }\n    async newTask<T extends Task[\"callback\"] = Task[\"callback\"]>(emitter: string | Object, message: string, callback: T) {\n        const thread = globalThis.constructor.name;\n        const timestamp = Date.now();\n        const id = thread + this._id++;\n        const task: Task = { id, thread, timestamp, emitter, message, callback };\n        if (!(thread in this._tasks)) this._tasks[thread] = [];\n        const $ = this._tasks[thread].push(task) - 1;\n        this.emit(\"tasks\", this.tasks);\n        this.emit(\"taskBegin\", task);\n        let returnValue: ReturnType<T> extends Promise<infer R> ? R : ReturnType<T>;\n        const handleUpdate = (msg: string) => {\n            const task: Task = { id, thread, timestamp, emitter, message: `${message}: ${msg}`, callback };\n            this._tasks[thread][$] = task;\n            this.emit(\"tasks\", this.tasks);\n            this.emit(\"taskUpdate\", task);\n        };\n        try {\n            returnValue = await callback(handleUpdate);\n        } catch (error) {\n            const taskError: TaskError = { id, thread, timestamp, emitter, message, error };\n            if (!(thread in this._errors)) this._errors[thread] = [];\n            this._errors[thread].push(taskError);\n            this.emit(\"errors\", this.errors);\n            this.emit(\"taskError\", taskError);\n            throw error;\n        } finally {\n            this._tasks[thread][$] = null;\n            this.emit(\"tasks\", this.tasks);\n            this.emit(\"taskEnd\", task);\n        }\n        return returnValue;\n    }\n    get lastError(): TaskError {\n        return this.errors.sort(((a, b) => b.timestamp - a.timestamp))[0];\n    }\n    get lastTask(): Task {\n        return this.tasks.sort(((a, b) => b.timestamp - a.timestamp))[0];\n    }\n    getTasksFromEmitter(emitter: string | Object) {\n        return this.tasks.filter(task => task.emitter === emitter);\n    }\n    getErrorsFromEmitter(emitter: string | Object) {\n        return this.errors.filter(error => error.emitter === emitter);\n    }\n    dismissLastError() {\n        const { lastError } = this;\n        if (!lastError) return;\n        const $ = this._errors[lastError.thread].indexOf(lastError);\n        this._errors[lastError.thread][$] = null;\n        this.emit(\"errors\", this.errors);\n    }\n    dismissAllErrors() {\n        this._errors = {};\n        this.emit(\"errors\", this.errors);\n    }\n}\n","import { ImporterDirSelfObject } from \"../utils/symbols\";\nimport { isJSPatcherObjectConstructor } from \"./objects/base/AbstractObject\";\nimport getBase from \"./objects/base/index.jsdsppkg.aw\";\nimport getGlobalThis from \"./objects/globalThis/index.jsdsppkg\";\nimport type { TPackage, PatcherMode, ObjectDescriptor, TAbstractPackage } from \"./types\";\nimport type { AnyImportedObject } from \"./objects/importer/ImportedObject\";\nimport type WorkletEnvProcessor from \"./worklets/WorkletEnv.worklet\";\nimport type { PackageGetter } from \"./GlobalPackageManager\";\n\nexport default class WorkletGlobalPackageManager {\n    js: TPackage;\n    jsaw: TPackage;\n    faust: TPackage;\n    max: TPackage;\n    gen: TPackage;\n    private readonly env: WorkletEnvProcessor;\n    externals = new Map<string, Record<string, any>>();\n    constructor(envIn: WorkletEnvProcessor) {\n        this.env = envIn;\n    }\n    async init() {\n        this.jsaw = {\n            Base: await getBase(),\n            globalThis: await getGlobalThis()\n        };\n        await this.env.addObjects(this.getDescriptors(this.jsaw.globalThis, \"globalThis\"), \"globalThis\");\n    }\n    toDescriptor(O: typeof AnyImportedObject, pkgName: string): ObjectDescriptor {\n        const { path } = O;\n        return {\n            isObjectDescriptor: true as const,\n            ctor: O.importedObjectType,\n            path,\n            name: path[path.length - 1] || pkgName\n        };\n    }\n    getDescriptors(pkgIn = this.jsaw.globalThis, pkgName = \"globalThis\") {\n        const $self = \"__JSPatcher_Importer_ImporterDirSelfObject\";\n        const pkg = Object.entries(pkgIn).reduce((acc, [k, v]) => {\n            if (typeof v === \"function\") {\n                const descriptor = this.toDescriptor(v, pkgName);\n                if (k as any === ImporterDirSelfObject) acc[$self] = descriptor;\n                else acc[k] = descriptor;\n            } else {\n                acc[k] = this.getDescriptors(v, pkgName);\n            }\n            return acc;\n        }, {} as TAbstractPackage);\n        if (ImporterDirSelfObject in pkgIn) pkg[$self] = this.toDescriptor((pkgIn as any)[ImporterDirSelfObject], pkgName);\n        return pkg;\n    }\n    add(pkgIn: TPackage, lib: PatcherMode, pathIn: string[] = []) {\n        const path = pathIn.slice();\n        let pkg = this[lib];\n        while (path.length) {\n            const key = path.shift();\n            if (!pkg[key]) pkg[key] = {};\n            else if (isJSPatcherObjectConstructor(pkg[key])) pkg[key] = { [ImporterDirSelfObject]: pkg[key] };\n            pkg = pkg[key] as TPackage;\n        }\n        Object.assign(pkg, pkgIn);\n    }\n    async fetchModule(url: string) {\n        const toExport = {};\n        globalThis.exports = toExport;\n        globalThis.module = { exports: toExport } as any;\n        await this.env.addWorkletModule(url);\n        const exported = globalThis.module.exports;\n        delete globalThis.exports;\n        delete globalThis.module;\n        return exported;\n    }\n    async importPackage(url: string, id: string) {\n        const getter: PackageGetter = (await this.fetchModule(url)).default;\n        this.add(await getter(this.env), \"jsaw\", [id]);\n    }\n}\n","import BaseObject from \"./objects/base/BaseObject\";\nimport Patcher from \"./patcher/Patcher\";\nimport Box from \"./patcher/Box\";\nimport Line from \"./patcher/Line\";\nimport generateRemotedObject from \"./objects/base/generateRemotedObject\";\nimport Bang, { isBang } from \"./objects/base/Bang\";\nimport type { IJSPatcherSDK } from \"./SDK\";\n\nexport default class JSPatcherWorkletSDK implements IJSPatcherSDK {\n    readonly Patcher = Patcher;\n    readonly Box = Box;\n    readonly Line = Line;\n    readonly BaseObject = BaseObject;\n    readonly generateRemotedObject = generateRemotedObject;\n    readonly Bang = Bang;\n    readonly isBang = isBang;\n}\n","import TemporaryProjectFile from \"../file/TemporaryProjectFile\";\nimport type PatcherAudio from \"./PatcherAudio\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\n\nexport default class TempAudioFile extends TemporaryProjectFile<PatcherAudio> {\n    get type() {\n        return \"audio\" as const;\n    }\n    async instantiate() {\n        return this.data;\n    }\n    async instantiateEditor({ env, project, instanceId }: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }) {\n        const AudioEditor = (await import(\"./AudioEditor\")).default;\n        return AudioEditor.fromProjectItem({ file: this, env, project, instanceId });\n    }\n}\n","import type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\nimport type { ProjectItemType } from \"../types\";\nimport type { IProjectItemManager } from \"./AbstractProjectItemManager\";\nimport type { IFileEditor } from \"./FileEditor\";\nimport type { IFileInstance } from \"./FileInstance\";\nimport type { IProjectFolder } from \"./AbstractProjectFolder\";\nimport AbstractProjectItem, { IProjectItem, ProjectItemEventMap } from \"./AbstractProjectItem\";\n\nexport interface ProjectFileEventMap extends ProjectItemEventMap {\n    \"saved\": any; // here emit with the object who performed the saving\n}\n\nexport interface IProjectFile<Data = any, Manager extends IProjectItemManager = IProjectItemManager> extends IProjectItem<ProjectFileEventMap, Manager> {\n    readonly type: Exclude<ProjectItemType, \"folder\">;\n    readonly isFolder: false;\n    readonly data: Data;\n    readonly fileExtension: string;\n    clone(parentIn?: IProjectFolder, nameIn?: string, dataIn?: Data): IProjectFile<Data>;\n    /**\n     * This method calls default instantiation (from the file manager).\n     * Please use `FileInstance.fromProjectItem(item)` for a better instantiation.\n     */\n    instantiate(options: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<IFileInstance>;\n    instantiateEditor(options: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<IFileEditor>;\n    /**\n     * Save the data to the file manager\n     *\n     * @param newDataIn new data to save\n     * @param by the editor who performs the save\n     */\n    save(newDataIn: Data, by: any): Promise<void>;\n    /** Save the data to a new file, not modifying the current file, nor point current editing file to the new one. */\n    saveAsCopy(parentIn: IProjectFolder, nameIn: string, newDataIn: any, manager?: IProjectItemManager): Promise<IProjectFile>;\n    /**\n     * Not modifying the current file, save to a new file and point current editing file to the new one.\n     *\n     * @param to the folder that will contain the new file to save\n     * @param newNameIn new file name to save\n     * @param newDataIn new data to save\n     * @param by the editor who performs the save\n     */\n    saveAs(to: IProjectFolder, newNameIn: string, newDataIn: any, by: any, manager?: IProjectItemManager): Promise<IProjectFile>;\n}\n\nexport default abstract class AbstractProjectFile<Data = ArrayBuffer, Manager extends IProjectItemManager<any> = IProjectItemManager> extends AbstractProjectItem<ProjectFileEventMap, Manager> implements IProjectFile<Data, Manager> {\n    get type() {\n        return this.fileMgr.getTypeFromFileName(this.name) as Exclude<ProjectItemType, \"folder\">;\n    }\n    readonly isFolder = false;\n    protected _data: Data;\n    get data() {\n        return this._data;\n    }\n    set data(dataIn: Data) {\n        this._data = dataIn;\n    }\n    get fileExtension() {\n        const splitted = this.name.split(\".\");\n        return splitted[splitted.length - 1];\n    }\n    constructor(fileMgrIn: Manager, parentIn: IProjectFolder, nameIn: string, dataIn?: Data) {\n        super(fileMgrIn, parentIn, nameIn);\n        if (dataIn) this._data = dataIn;\n        this.onAny((eventName, eventData) => {\n            const { id, isFolder, type, path, data } = this;\n            this.fileMgr.emit(\"itemChanged\", { id, isFolder, type, path, data, eventName, eventData });\n        });\n    }\n    abstract clone(parentIn?: IProjectFolder, nameIn?: string, dataIn?: Data): IProjectFile<Data>;\n    abstract instantiate(options: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<IFileInstance>;\n    abstract instantiateEditor(options: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<IFileEditor>;\n    async save(newData: Data, by: any) {\n        this._data = newData;\n        await this.emit(\"saved\", by);\n        await this.fileMgr.emitChanged();\n    }\n    async saveAsCopy(parent: IProjectFolder, name: string, newData: any, manager?: IProjectItemManager): Promise<IProjectFile> {\n        const item = this.clone(parent, name, newData);\n        parent.items.add(item);\n        await this.emitTreeChanged();\n        await this.fileMgr.emitChanged();\n        return item;\n    }\n    async saveAs(to: IProjectFolder, newName: string, newData: any, by: any, manager?: IProjectItemManager): Promise<IProjectFile> {\n        const { parent, name, data } = this;\n        const from = parent;\n        this._data = newData;\n        await this.move(to, newName);\n        const item = this.clone(parent, name, data);\n        parent.items.add(item);\n        await parent.emitTreeChanged();\n        await this.emitTreeChanged();\n        await this.emit(\"pathChanged\", { from: from.path, to: to.path });\n        await this.emit(\"saved\", by);\n        await this.fileMgr.emitChanged();\n        return item;\n    }\n}\n","import type { RawProjectItem } from \"../types\";\nimport type { IProjectItemManager } from \"./AbstractProjectItemManager\";\nimport AbstractProjectItem, { IProjectFileOrFolder, IProjectItem } from \"./AbstractProjectItem\";\n\nexport interface IProjectFolder<Manager extends IProjectItemManager = IProjectItemManager> extends IProjectItem<{}, Manager> {\n    readonly type: \"folder\";\n    readonly isFolder: true;\n    readonly items: Set<IProjectFileOrFolder>;\n    clone(parentIn?: IProjectFolder, nameIn?: string): IProjectFolder;\n    createProjectItem(nameIn: string, isFolder: boolean, dataIn?: any): IProjectFileOrFolder;\n    findItem(itemIn: string): IProjectFileOrFolder;\n    existItem(itemIn: IProjectFileOrFolder | string): boolean;\n    uniqueName(nameIn: string): string;\n    addFile(nameIn: string, dataIn?: any): Promise<IProjectFileOrFolder>;\n    addFolder(nameIn: string): Promise<IProjectFolder>;\n    empty(): Promise<void>;\n    getTree(): RawProjectItem<\"folder\">;\n    getDescendantFiles(): IProjectFileOrFolder[];\n    isParentOf(itemIn: IProjectItem): boolean;\n    getOrderedItems(): IProjectFileOrFolder[];\n    emitTreeChanged(): Promise<void>;\n}\n\nexport default abstract class AbstractProjectFolder<Manager extends IProjectItemManager = IProjectItemManager> extends AbstractProjectItem<{}, Manager> implements IProjectFolder<Manager> {\n    get type(): \"folder\" {\n        return \"folder\";\n    }\n    readonly isFolder = true;\n    items: Set<IProjectFileOrFolder> = new Set();\n    get isDirty() {\n        return !this.getDescendantFiles().every(f => !f.isDirty);\n    }\n    constructor(fileMgrIn: Manager, parentIn: IProjectFolder, nameIn: string) {\n        super(fileMgrIn, parentIn, nameIn);\n        this.onAny((eventName, eventData) => {\n            const { id, isFolder, type, path } = this;\n            this.fileMgr.emit(\"itemChanged\", { id, isFolder, type, path, eventName, eventData });\n        });\n    }\n    abstract clone(parentIn?: IProjectFolder, nameIn?: string): IProjectFolder;\n    abstract createProjectItem(nameIn: string, isFolder: boolean, dataIn?: any): IProjectFileOrFolder;\n    findItem(itemIn: string) {\n        return Array.from(this.items).find(item => item.name === itemIn);\n    }\n    existItem(itemIn: IProjectFileOrFolder | string) {\n        return typeof itemIn === \"string\" ? !!this.findItem(itemIn) : this.items.has(itemIn);\n    }\n    uniqueName(nameIn: string) {\n        if (!this.existItem(nameIn)) return nameIn;\n        let i = 0;\n        let name;\n        do {\n            i++;\n            name = `nameIn_${i}`;\n        } while (this.existItem(nameIn));\n        return name;\n    }\n    abstract addFile(nameIn: string, dataIn?: any): Promise<IProjectFileOrFolder>;\n    abstract addFolder(nameIn: string): Promise<IProjectFolder>;\n    async empty() {\n        for (const item of this.items) {\n            await item.destroy();\n        }\n    }\n    getTree(): RawProjectItem<\"folder\"> {\n        return {\n            type: \"folder\",\n            id: this.id,\n            isFolder: true,\n            name: this.name,\n            items: Array.from(this.items).map((item) => {\n                if (item.isFolder === false) {\n                    const { id, isFolder, type, name, data } = item;\n                    return { id, isFolder, type, name, data };\n                }\n                return item.getTree();\n            })\n        };\n    }\n    getDescendantFiles() {\n        return Array.from(this.items).reduce((acc, cur) => {\n            if (cur.isFolder === false) acc.push(cur);\n            else acc.push(...cur.getDescendantFiles());\n            return acc;\n        }, [] as IProjectFileOrFolder[]);\n    }\n    isParentOf(itemIn: IProjectFileOrFolder) {\n        let { parent } = itemIn;\n        while (parent !== this) {\n            if (!parent) return false;\n            parent = parent.parent;\n        }\n        return true;\n    }\n    getOrderedItems() {\n        const items = Array.from(this.items);\n        const folders = items.filter(i => i.isFolder).sort((a, b) => a.name.localeCompare(b.name));\n        const files = items.filter(i => !i.isFolder).sort((a, b) => a.name.localeCompare(b.name));\n        return [...folders, ...files];\n    }\n}\n","import TypedEventEmitter, { ITypedEventEmitter } from \"../../utils/TypedEventEmitter\";\nimport type { IObservee, ProjectItemType } from \"../types\";\nimport type { IProjectItemManager } from \"./AbstractProjectItemManager\";\nimport type { IProjectFile } from \"./AbstractProjectFile\";\nimport type { IProjectFolder } from \"./AbstractProjectFolder\";\n\nexport type IProjectFileOrFolder = IProjectFolder | IProjectFile;\n\nexport interface ProjectItemEventMap {\n    \"ready\": never;\n    \"nameChanged\": { oldName: string; newName: string };\n    \"pathChanged\": { from: string; to: string };\n    \"treeChanged\": never;\n    \"destroyed\": never;\n    \"observers\": Set<string>;\n    \"dirty\": boolean;\n}\n\nexport interface IProjectItem<EventMap extends Record<string, any> = {}, Manager extends IProjectItemManager = IProjectItemManager> extends ITypedEventEmitter<ProjectItemEventMap & EventMap>, IObservee<string> {\n    readonly id: string;\n    readonly fileMgr: Manager;\n    readonly isFolder: boolean;\n    readonly type: ProjectItemType;\n    readonly name: string;\n    /** path used by the file manager */\n    readonly path: string;\n    /** parent path used by the file manager */\n    readonly parentPath: string;\n    /** path relative to the project root */\n    readonly projectPath: string;\n    /** Is the file is editing by some editor and modified (without saving the data), isDirty is true. */\n    readonly isDirty: boolean;\n    parent: IProjectFolder;\n    /** Load data */\n    init(): Promise<void>;\n    /** Clone with optional modifications */\n    clone(parentIn?: IProjectFolder, nameIn?: string): IProjectItem;\n    rename(newNameIn: string): Promise<void>;\n    move(to: IProjectFolder, newNameIn?: string): Promise<void>;\n    /** Delete current file from file manager and the parent folder. */\n    destroy(): Promise<void>;\n}\n\nexport default abstract class AbstractProjectItem<EventMap extends Partial<ProjectItemEventMap> & Record<string, any> = {}, Manager extends IProjectItemManager = IProjectItemManager> extends TypedEventEmitter<ProjectItemEventMap & EventMap> implements IProjectItem<EventMap, Manager> {\n    id: string;\n    get type(): ProjectItemType {\n        return \"unknown\";\n    }\n    readonly isFolder: boolean;\n    protected readonly _fileMgr;\n    get fileMgr() {\n        return this._fileMgr;\n    }\n    protected _name: string;\n    get name() {\n        return this._name;\n    }\n    parent: IProjectFolder;\n    private _isDirty: boolean;\n    get isDirty() {\n        return this._isDirty;\n    }\n    get path(): string {\n        return this.parent ? `${this.parentPath}/${this._name}` : \"\";\n    }\n    get parentPath() {\n        return this.parent?.path;\n    }\n    get projectPath() {\n        return this.path.replace(new RegExp(`^/${this._fileMgr.projectFolderName}`), \"\");\n    }\n    protected readonly _observers = new Set<string>();\n    async addObserver(observer: string) {\n        this._observers.add(observer);\n        await this.emit(\"observers\", this._observers);\n        await this.fileMgr.emitChanged();\n    }\n    async removeObserver(observer: string) {\n        this._observers.delete(observer);\n        await this.emit(\"observers\", this._observers);\n        await this.fileMgr.emitChanged();\n    }\n    constructor(fileMgrIn: Manager, parentIn: IProjectFolder, nameIn: string) {\n        super();\n        this._fileMgr = fileMgrIn;\n        this.parent = parentIn;\n        this._name = nameIn;\n        this.on(\"dirty\", dirty => this._isDirty = dirty);\n    }\n    abstract rename(newNameIn: string): Promise<void>;\n    abstract move(to: IProjectFolder, newNameIn?: string): Promise<void>;\n    abstract destroy(): Promise<void>;\n    abstract clone(parentIn?: IProjectFolder, nameIn?: string): IProjectItem;\n    async init() {\n        this.id = this.fileMgr.generateItemId(this);\n        await this.emit(\"ready\");\n        await this.fileMgr.emitChanged();\n    }\n    async emitTreeChanged() {\n        await this.emit(\"treeChanged\");\n        await (this.parent || this.fileMgr).emitTreeChanged();\n    }\n}\n","import TypedEventEmitter, { ITypedEventEmitter } from \"../../utils/TypedEventEmitter\";\nimport { extToType } from \"../../utils/utils\";\nimport type TaskMgr from \"../TaskMgr\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { ProjectItemType, RawProjectItem } from \"../types\";\nimport type { IFileInstance } from \"./FileInstance\";\nimport type { IProjectFolder } from \"./AbstractProjectFolder\";\nimport type { IProjectFileOrFolder, IProjectItem, ProjectItemEventMap } from \"./AbstractProjectItem\";\nimport { IProject } from \"../Project\";\n\nexport interface ItemChangedEvent<K extends keyof ProjectItemEventMap = keyof ProjectItemEventMap> {\n    id: string;\n    isFolder: boolean;\n    path: string;\n    type: ProjectItemType;\n    data?: any;\n    eventName: K;\n    eventData?: ProjectItemEventMap[K];\n}\n\nexport interface ProjectItemManagerEventMap {\n    \"ready\": never;\n    \"treeChanged\": RawProjectItem<\"folder\">;\n    \"itemChanged\": ItemChangedEvent;\n    \"changed\": never;\n}\n\nexport interface IProjectItemManager<EventMap extends Record<string, any> & Partial<ProjectItemManagerEventMap> = {}> extends ITypedEventEmitter<EventMap & ProjectItemManagerEventMap> {\n    readonly projectFolderName: string;\n    readonly id: string;\n    readonly taskMgr: TaskMgr;\n    readonly allItems: Record<string, IProjectFileOrFolder>;\n    readonly allProjectItems: Record<string, IProjectFileOrFolder>;\n    root: IProjectFolder;\n    /** Enpty the backend file manager */\n    empty(): Promise<any>;\n    /** Empty the project rool folder */\n    emptyProject(): Promise<void>;\n    /** Create all project items by analyzing the backend */\n    init(clean?: boolean): Promise<this>;\n    getTypeFromFileName(name: string): ProjectItemType;\n    getProjectItemFromId(id: string): IProjectFileOrFolder;\n    getProjectItemFromPath(path: string): IProjectFileOrFolder;\n    getPathIdMap(): Record<string, string>;\n    instantiateProjectPath(path: string, envIn: IJSPatcherEnv, projectIn?: IProject): Promise<IFileInstance>;\n    emitTreeChanged(): Promise<void>;\n    emitChanged(): Promise<void>;\n    generateItemId(item: IProjectItem): string;\n}\n\nexport default abstract class AbstractProjectItemManager<EventMap extends Record<string, any> & Partial<ProjectItemManagerEventMap> = {}> extends TypedEventEmitter<EventMap & ProjectItemManagerEventMap> implements IProjectItemManager<EventMap> {\n    readonly projectFolderName = \"project\";\n    readonly id: string;\n    readonly env: IJSPatcherEnv;\n    readonly taskMgr: TaskMgr;\n    get allItems() {\n        const items: Record<string, IProjectFileOrFolder> = {};\n        const rec = (cur: IProjectFileOrFolder) => {\n            items[cur.id] = cur;\n            if (cur.isFolder) cur.items.forEach(rec);\n        };\n        rec(this.root);\n        return items;\n    }\n    get allProjectItems() {\n        const items: Record<string, IProjectFileOrFolder> = {};\n        const rec = (cur: IProjectFileOrFolder) => {\n            items[cur.id] = cur;\n            if (cur.isFolder) cur.items.forEach(rec);\n        };\n        rec(this.projectRoot);\n        return items;\n    }\n    root: IProjectFolder;\n    constructor(envIn: IJSPatcherEnv) {\n        super();\n        this.env = envIn;\n        this.id = envIn.generateId(this);\n        this.taskMgr = envIn.taskMgr;\n    }\n    abstract empty(): Promise<any>;\n    emptyProject() {\n        return this.projectRoot.empty();\n    }\n    abstract init(clean?: boolean): Promise<this>;\n    getTypeFromFileName(name: string): ProjectItemType {\n        const splitted = name.split(\".\");\n        const ext = splitted[splitted.length - 1];\n        return extToType(ext);\n    }\n    getProjectItemFromId(id: string) {\n        return this.allItems[id];\n    }\n    getProjectItemFromPath(path: string) {\n        const pathArray = path.split(\"/\");\n        const itemArray: (IProjectFileOrFolder)[] = [this.root, this.projectRoot];\n        for (let i = 0; i < pathArray.length; i++) {\n            const id = pathArray[i];\n            if (id.length === 0) continue;\n            if (id === \".\") continue;\n            if (id === \"..\") {\n                itemArray.pop();\n                continue;\n            }\n            const cur = itemArray[itemArray.length - 1];\n            if (!cur.isFolder) throw new Error(`${cur.name} from path ${path} is not a folder`);\n            const next = cur.findItem(id);\n            if (!next) throw new Error(`Cannot find ${id} from path ${path}`);\n            itemArray.push(next);\n        }\n        return itemArray[itemArray.length - 1];\n    }\n    getPathIdMap() {\n        const map: Record<string, string> = {};\n        Object.entries(this.allItems).forEach(([id, { path }]) => map[path] = id);\n        return map;\n    }\n    instantiateProjectPath(path: string, envIn: IJSPatcherEnv, projectIn: IProject) {\n        const item = this.getProjectItemFromPath(path);\n        if (item.isFolder === false) return item.instantiate({ env: envIn, project: projectIn });\n        throw new Error(`Cannot instantiate ${item.name} from path ${path} as it is a folder`);\n    }\n    async emitTreeChanged() {\n        this.emit(\"treeChanged\", this.root.getTree());\n    }\n    async emitChanged() {\n        this.emit(\"changed\");\n    }\n    get projectRoot() {\n        return this.root.findItem(this.projectFolderName) as IProjectFolder;\n    }\n    generateItemId(item: IProjectItem) {\n        return this.env.generateId(item);\n    }\n}\n","import type { SemanticICONS } from \"semantic-ui-react\";\nimport TypedEventEmitter, { ITypedEventEmitter } from \"../../utils/TypedEventEmitter\";\nimport History from \"./History\";\nimport TemporaryProjectFile from \"./TemporaryProjectFile\";\nimport type { IFileInstance } from \"./FileInstance\";\nimport type { IProjectFile } from \"./AbstractProjectFile\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\nimport type { IProjectFolder } from \"./AbstractProjectFolder\";\n\nexport interface FileEditorEventMap {\n    \"ready\": never;\n    \"changed\": never;\n    \"dirty\": boolean;\n    \"saved\": never;\n    \"locked\": boolean;\n    \"destroy\": never;\n}\n\nexport interface IFileEditor<Instance extends IFileInstance = IFileInstance, EventMap extends Record<string, any> & Partial<FileEditorEventMap> = {}> extends ITypedEventEmitter<EventMap & FileEditorEventMap> {\n    readonly instance: Instance;\n    readonly env: IJSPatcherEnv;\n    readonly project: IProject;\n    readonly ctx: IFileInstance[\"ctx\"];\n    readonly isInMemory: boolean;\n    readonly isTemporary: boolean;\n    isReadonly: boolean;\n    readonly isReady: boolean;\n    readonly isDestroyed: boolean;\n    readonly isDirty: boolean;\n    readonly isLocked: boolean;\n    readonly isActive: boolean;\n    readonly editorId: string;\n    readonly fileExtension: string;\n    readonly fileIcon: SemanticICONS;\n    file: IProjectFile;\n    setActive(): void;\n    undo(): Promise<void>;\n    redo(): Promise<void>;\n    copy(): Promise<void>;\n    cut(): Promise<void>;\n    paste(): Promise<void>;\n    deleteSelected(): Promise<any>;\n    selectAll(): Promise<void>;\n    onUiResized(): void;\n    save(): Promise<void>;\n    saveAs(parent: any, name: string): Promise<void>;\n    destroy(): Promise<void>;\n}\n\nexport type AnyFileEditor = FileEditor<any, Record<string, any>>;\n\nexport default class FileEditor<Instance extends IFileInstance = IFileInstance, EventMap extends Record<string, any> & Partial<FileEditorEventMap> = {}> extends TypedEventEmitter<EventMap & FileEditorEventMap> implements IFileEditor<Instance, EventMap> {\n    static async fromProjectItem({ file, env, project, instanceId }: { file: IProjectFile; env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<IFileEditor> {\n        return new this(await file.instantiate({ env, project, instanceId }));\n    }\n    readonly instance: Instance;\n    get env() {\n        return this.instance.env;\n    }\n    get project() {\n        return this.instance.project;\n    }\n    get file() {\n        return this.instance.file;\n    }\n    set file(value) {\n        this.instance.file = value;\n    }\n    get ctx() {\n        return this.instance.ctx;\n    }\n    get isInMemory() {\n        return this.instance.isInMemory;\n    }\n    get isTemporary() {\n        return this.instance.isTemporary;\n    }\n    get isReadonly() {\n        return this.instance.isReadonly;\n    }\n    set isReadonly(value) {\n        this.instance.isReadonly = value;\n    }\n    protected _isReady = false;\n    get isReady() {\n        return this._isReady;\n    }\n    protected _isDestroyed = false;\n    get isDestroyed() {\n        return this._isDestroyed;\n    }\n    get isDirty() {\n        return this.history.isDirty;\n    }\n    get isLocked() {\n        return false;\n    }\n    get history(): History<Partial<EventMap>, this> {\n        return this.instance.history;\n    }\n    get fileExtension() {\n        return \"data\";\n    }\n    get fileIcon(): SemanticICONS {\n        return \"code\";\n    }\n    setActive() {\n        this.env.activeEditor = this;\n    }\n    get isActive(): boolean {\n        return this.env.thread === \"main\" && this.env.activeEditor === this;\n    }\n    readonly editorId: string;\n    handleProjectSave = async () => this.save();\n    handleProjectUnload = async () => this.destroy();\n    handleDestroy = () => this.destroy();\n    constructor(instance: Instance) {\n        super();\n        this.instance = instance;\n        this.instance?.addObserver(this);\n        this.instance.on(\"destroy\", this.handleDestroy);\n        this.history.addEditor(this);\n        this.on(\"dirty\", isDirty => this.file?.emit(\"dirty\", isDirty));\n        this.on(\"destroy\", () => this.file?.emit(\"dirty\", false));\n        const handleReady = () => {\n            this._isReady = true;\n            this.off(\"ready\", handleReady);\n        };\n        this.on(\"ready\", handleReady);\n        this.editorId = this.env.generateId(this);\n        if (this.env.thread === \"main\") this.env.registerInstance(this.instance);\n        if (this.project) {\n            this.project.on(\"save\", this.handleProjectSave);\n            this.project.on(\"unload\", this.handleProjectUnload);\n        }\n    }\n    async toFileData() {\n        return this.instance.serialize();\n    }\n    async toTempData(): Promise<any> {\n        return this.instance;\n    }\n    undo() {\n        return this.history.undo();\n    }\n    redo() {\n        return this.history.redo();\n    }\n    async copy() {\n        throw new Error(\"Not implemented.\");\n    }\n    async cut() {\n        throw new Error(\"Not implemented.\");\n    }\n    async paste() {\n        throw new Error(\"Not implemented.\");\n    }\n    async deleteSelected(): Promise<any> {\n        throw new Error(\"Not implemented.\");\n    }\n    async selectAll() {\n        throw new Error(\"Not implemented.\");\n    }\n    onUiResized() {\n        throw new Error(\"Not implemented.\");\n    }\n    async save() {\n        if (this.isReadonly) throw new Error(\"Cannot save readonly file\");\n        if (this.isInMemory) throw new Error(\"Cannot save in-memory instance\");\n        const data = await (this.file instanceof TemporaryProjectFile ? this.toTempData() : this.toFileData());\n        await this.file.save(data, this);\n        await this.emit(\"saved\");\n    }\n    async saveAs(parent: IProjectFolder, name: string) {\n        const data = await this.toFileData();\n        if (this.isTemporary) {\n            await this.file.saveAsCopy(parent, name, data);\n        } else if (this.isReadonly) {\n            await this.file.saveAs(parent, name, data, this);\n        } else if (this.isInMemory) {\n            this.file = await parent.addFile(name, data) as any;\n        } else {\n            await this.file.saveAs(parent, name, data, this);\n        }\n        this.isReadonly = false;\n        await this.emit(\"saved\");\n    }\n    async destroy() {\n        if (this.isDestroyed) return;\n        if (this.project) {\n            this.project.off(\"save\", this.handleProjectSave);\n            this.project.off(\"unload\", this.handleProjectUnload);\n        }\n        this.instance.off(\"destroy\", this.handleDestroy);\n        this.instance.removeObserver(this);\n        this.history.removeEditor(this);\n        this._isDestroyed = true;\n        await this.emit(\"destroy\");\n    }\n}\n","import TypedEventEmitter, { ITypedEventEmitter } from \"../../utils/TypedEventEmitter\";\nimport TemporaryProjectFile from \"./TemporaryProjectFile\";\nimport type History from \"./History\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\nimport type { IObservee } from \"../types\";\nimport type { IFileEditor } from \"./FileEditor\";\nimport type { IProjectFile } from \"./AbstractProjectFile\";\n\nexport interface FileInstanceEventMap {\n    \"observers\": Set<any>;\n    \"ready\": never;\n    \"changed\": never;\n    \"destroy\": never;\n}\n\nexport interface IFileInstance<EventMap extends Record<string, any> & Partial<FileInstanceEventMap> = {}, File extends IProjectFile = IProjectFile> extends ITypedEventEmitter<EventMap & FileInstanceEventMap>, IObservee {\n    file?: File;\n    readonly env: IJSPatcherEnv;\n    readonly project: IProject;\n    readonly ctx: File | IProject | IJSPatcherEnv;\n    /** Means it doesn't have a file to save */\n    readonly isInMemory: boolean;\n    /** Means it doesn't have a file to save in the backend */\n    readonly isTemporary: boolean;\n    isReadonly: boolean;\n    isReady: boolean;\n    readonly isActive: boolean;\n    readonly id: string;\n    readonly history: History<any, any>;\n    init(): Promise<this>;\n    setActive(): void;\n    getEditor(): Promise<IFileEditor>;\n    serialize(): Promise<ArrayBuffer>;\n    destroy(): Promise<void>;\n}\n\nexport default abstract class FileInstance<EventMap extends Record<string, any> & Partial<FileInstanceEventMap> = {}, File extends IProjectFile = IProjectFile> extends TypedEventEmitter<EventMap & FileInstanceEventMap> implements IFileInstance<EventMap, File> {\n    private readonly _env: IJSPatcherEnv;\n    get env() {\n        return this._env;\n    }\n    private readonly _project: IProject;\n    get project(): IProject {\n        return this._project;\n    }\n    private _file?: File;\n    get file(): File {\n        return this._file;\n    }\n    set file(value) {\n        if (value === this._file) return;\n        this._file?.removeObserver(this._id);\n        this._file = value;\n        this._file?.addObserver(this._id);\n    }\n    get ctx(): File | IProject | IJSPatcherEnv {\n        return this.file || this.project || this.env;\n    }\n    get isInMemory() {\n        return !this.file;\n    }\n    get isTemporary() {\n        return this.file instanceof TemporaryProjectFile;\n    }\n    private _isReadonly = false;\n    get isReadonly() {\n        return this._isReadonly;\n    }\n    set isReadonly(value) {\n        this._isReadonly = value;\n    }\n    protected _isReady = false;\n    get isReady() {\n        return this._isReady;\n    }\n    setActive() {\n        this.env.activeInstance = this;\n    }\n    get isActive(): boolean {\n        return this.env.activeInstance === this;\n    }\n    async getEditor(): Promise<IFileEditor> {\n        throw new Error(\"Not implemented.\");\n    }\n    protected readonly _observers = new Set<any>();\n    async addObserver(observer: any) {\n        this._observers.add(observer);\n        await this.emit(\"observers\", this._observers);\n    }\n    async removeObserver(observer: any) {\n        this._observers.delete(observer);\n        await this.emit(\"observers\", this._observers);\n        if (this._observers.size === 0) await this.destroy();\n    }\n    readonly _id: string;\n    get id() {\n        return this._id;\n    }\n    readonly _history: History<any, any>;\n    get history() {\n        return this._history;\n    }\n    constructor({ env, project, file, instanceId }: { env: IJSPatcherEnv; project?: IProject; file?: File; instanceId?: string }) {\n        super();\n        this._env = env;\n        this._project = project;\n        this._file = file;\n        this._id = this.env.registerInstance(this, instanceId);\n        this._file?.addObserver(this._id);\n    }\n    async init() {\n        return this;\n    }\n    async serialize(): Promise<ArrayBuffer> {\n        throw new Error(\"Not implemented.\");\n    }\n    async destroy() {\n        await this.emit(\"destroy\");\n        await this.file?.removeObserver(this._id);\n    }\n}\n","import FileEditor, { FileEditorEventMap } from \"./FileEditor\";\n\ninterface IHistoryEvent<EventMap extends Record<string, any> & Partial<FileEditorEventMap> = {}> {\n    timestamp: number;\n    editorId: string;\n    eventName: keyof EventMap & string;\n    eventData?: EventMap[keyof EventMap & string];\n}\n\nexport interface IHistoryData<EventMap extends Record<string, any> & Partial<FileEditorEventMap> = {}> {\n    /** Current index in the event queue */\n    $: number;\n    /** Last save Timestamp */\n    saveTime: number;\n    /** Queued events */\n    eventQueue: IHistoryEvent<EventMap>[];\n}\n\n/** The class records some events and allows to perform undo/redo with a specific editor. */\nexport default abstract class History<EventMap extends Record<string, any> & Partial<FileEditorEventMap> = {}, Editor extends FileEditor<any, EventMap> = FileEditor<any, EventMap>> implements IHistoryData<EventMap> {\n    /** Editors to sync and to listen */\n    editors: Set<Editor> = new Set();\n    saveTime = 0;\n    $ = 0;\n    eventQueue: IHistoryEvent<EventMap>[] = [];\n    /** Can be set to `false` to prevent recording events while undoing/redoing */\n    capture = true;\n    get eventListening(): (keyof EventMap & string)[] {\n        return [];\n    }\n    get now() {\n        if (globalThis.performance) {\n            return performance.now() + (performance.timeOrigin || performance.timing.navigationStart);\n        }\n        return Date.now();\n    }\n    addEditor(editor: Editor) {\n        this.editors.add(editor);\n        editor.onAny(this.handleEditorEvent);\n        editor.on(\"saved\", this.handleSaved);\n        editor.once(\"destroy\", () => this.removeEditor(editor));\n    }\n    removeEditor(editor: Editor) {\n        editor.offAny(this.handleEditorEvent);\n        this.editors.delete(editor);\n    }\n    handleEditorEvent = async (eventName: keyof EventMap & string, eventData: any, editor: Editor) => {\n        if (this.eventListening.indexOf(eventName) === -1) return;\n        if (!this.capture) return;\n        this.capture = false;\n        await Promise.all(Array.from(this.editors).filter($editor => $editor !== editor).map($editor => $editor.emit(eventName, eventData)));\n        this.capture = true;\n        this.eventQueue.splice(this.$);\n        this.$ = this.eventQueue.push({ eventName, eventData, timestamp: this.now, editorId: editor.editorId });\n        this.emitChanged();\n    };\n    emitChanged() {\n        this.editors.forEach(editor => editor.emit(\"changed\"));\n        this.emitDirty();\n    }\n    emitDirty() {\n        const { isDirty } = this;\n        this.editors.forEach(editor => editor.emit(\"dirty\", isDirty));\n    }\n    destroy() {\n        this.editors.forEach(editor => this.removeEditor(editor));\n    }\n    get isDirty() {\n        if (!this.saveTime) return this.isUndoable;\n        return this.saveTime !== this.eventQueue[this.$ - 1]?.timestamp;\n    }\n    get isUndoable() {\n        return this.$ !== 0;\n    }\n    get isRedoable() {\n        return this.$ !== this.eventQueue.length;\n    }\n    handleSaved = () => {\n        this.saveTime = this.eventQueue[this.$ - 1]?.timestamp;\n        this.emitDirty();\n    };\n    abstract undoOf(editor: Editor, eventName: keyof EventMap, eventData?: any): Promise<void>;\n    async undo() {\n        if (!this.editors.size) return;\n        if (!this.isUndoable) return;\n        this.capture = false;\n        const { eventName, eventData } = this.eventQueue[this.$ - 1];\n        await Promise.all(Array.from(this.editors).map(editor => this.undoOf(editor, eventName, eventData)));\n        this.$--;\n        this.capture = true;\n        this.emitChanged();\n    }\n    abstract redoOf(editor: Editor, eventName: keyof EventMap, eventData?: any): Promise<void>;\n    async redo() {\n        if (!this.editors.size) return;\n        if (!this.isRedoable) return;\n        this.capture = false;\n        const { eventName, eventData } = this.eventQueue[this.$];\n        await Promise.all(Array.from(this.editors).map(editor => this.redoOf(editor, eventName, eventData)));\n        this.$++;\n        this.capture = true;\n        this.emitChanged();\n    }\n    /** event at timestamp exclusive */\n    async undoUntil(timestamp: number) {\n        while (this.isUndoable && this.eventQueue[this.$ - 1].timestamp >= timestamp) {\n            await this.undo();\n        }\n    }\n    /** event at timestamp inclusive */\n    async redoUntil(timestamp: number) {\n        while (this.isRedoable && this.eventQueue[this.$].timestamp <= timestamp) {\n            await this.redo();\n        }\n    }\n    async setIndex($: number) {\n        if ($ < this.$) await this.undoUntil(this.eventQueue[$].timestamp);\n        else if ($ > this.$) await this.redoUntil(this.eventQueue[$ - 1].timestamp);\n    }\n    getSyncData(): IHistoryData<EventMap> {\n        const { $, saveTime, eventQueue } = this;\n        return { $, saveTime, eventQueue };\n    }\n    async syncData(data: IHistoryData<EventMap>) {\n        this.saveTime = data.saveTime;\n        for (let i = 0; i < this.eventQueue.length; i++) {\n            const { timestamp } = this.eventQueue[i];\n            if (timestamp !== data.eventQueue[i]?.timestamp) {\n                await this.undoUntil(timestamp);\n                break;\n            }\n        }\n        this.eventQueue = data.eventQueue;\n        await this.setIndex(data.$);\n    }\n}\n","import AbstractProjectFile from \"./AbstractProjectFile\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\nimport type { IFileEditor } from \"./FileEditor\";\nimport type { IFileInstance } from \"./FileInstance\";\nimport type { IProjectFolder } from \"./AbstractProjectFolder\";\nimport type { IPersistentProjectItemManager } from \"./PersistentProjectItemManager\";\n\nexport default class PersistentProjectFile extends AbstractProjectFile<ArrayBuffer, IPersistentProjectItemManager> {\n    private _sab: SharedArrayBuffer;\n    get sab() {\n        return this._sab;\n    }\n    get data() {\n        return this._data;\n    }\n    set data(dataIn: ArrayBuffer) {\n        this._data = dataIn;\n        if (dataIn instanceof SharedArrayBuffer) {\n            this._sab = dataIn;\n            return;\n        }\n        this._sab = new SharedArrayBuffer(dataIn.byteLength);\n        const ui8ab = new Uint8Array(dataIn);\n        const ui8sab = new Uint8Array(this._sab);\n        for (let i = 0; i < ui8ab.length; i++) {\n            ui8sab[i] = ui8ab[i];\n        }\n    }\n    lastModifiedId: string;\n    constructor(fileMgrIn: IPersistentProjectItemManager, parentIn: IProjectFolder, nameIn: string, dataIn?: ArrayBuffer) {\n        super(fileMgrIn, parentIn, nameIn);\n        this.lastModifiedId = this.id;\n        this._data = dataIn;\n    }\n    async init() {\n        this.id = this.fileMgr.generateItemId(this);\n        if (!this.data) this.data = await this.fileMgr.readFile(this.path);\n        await this.emit(\"ready\");\n        await this.fileMgr.emitChanged();\n    }\n    clone(parentIn = this.parent, nameIn = this._name, dataIn = this.data) {\n        const Ctor = this.constructor as typeof PersistentProjectFile;\n        return new Ctor(this._fileMgr, parentIn, nameIn, dataIn);\n    }\n    async save(newData: ArrayBuffer, by: any) {\n        this.data = newData;\n        this.lastModifiedId = this.fileMgr.generateItemId(this);\n        await this._fileMgr.putFile(this);\n        await this.emit(\"saved\", by);\n        await this.fileMgr.emitChanged();\n    }\n    async saveAsCopy(parent: IProjectFolder, name: string, newData: ArrayBuffer) {\n        const item = this.clone(parent, name, newData);\n        await this._fileMgr.putFile(item);\n        parent.items.add(item);\n        await this.emitTreeChanged();\n        await this.fileMgr.emitChanged();\n        return item;\n    }\n    async saveAs(to: IProjectFolder, newName: string, newData: ArrayBuffer, by: any) {\n        const { parent, name, data } = this;\n        const from = parent;\n        this.data = newData;\n        this.lastModifiedId = this.fileMgr.generateItemId(this);\n        await this.move(to, newName);\n        await this._fileMgr.putFile(this);\n        const item = this.clone(parent, name, data);\n        await this._fileMgr.putFile(item);\n        parent.items.add(item);\n        await parent.emitTreeChanged();\n        await this.emitTreeChanged();\n        await this.emit(\"pathChanged\", { from: from.path, to: to.path });\n        await this.emit(\"saved\", by);\n        await this.fileMgr.emitChanged();\n        return item;\n    }\n    async rename(newNameIn: string) {\n        const newName = newNameIn.trim();\n        const oldName = this._name;\n        if (newName === oldName) return;\n        if (this.parent.existItem(newNameIn)) throw new Error(`${newName} already exists.`);\n        await this.fileMgr.rename(this.path, `${this.parentPath}/${newNameIn}`);\n        this._name = newName;\n        await this.emitTreeChanged();\n        await this.emit(\"nameChanged\", { oldName, newName });\n        await this.fileMgr.emitChanged();\n    }\n    async move(to: IProjectFolder, newName = this.name) {\n        if (to === this as any) return;\n        if (to === this.parent && newName === this.name) return;\n        if (to.existItem(newName)) throw new Error(`${newName} already exists in ${to.name}`);\n        await this._fileMgr.rename(this.path, `${to.path}/${newName}`);\n        const from = this.parent;\n        from.items.delete(this as any);\n        this.parent = to;\n        const oldName = this._name;\n        this._name = newName;\n        this.parent.items.add(this as any);\n        await from.emitTreeChanged();\n        await this.emitTreeChanged();\n        await this.emit(\"pathChanged\", { from: from.path, to: to.path });\n        if (oldName !== newName) await this.emit(\"nameChanged\", { oldName, newName });\n        await this.fileMgr.emitChanged();\n    }\n    async destroy() {\n        await this._fileMgr.remove(this.path, this.isFolder);\n        this.parent.items.delete(this as any);\n        await this.emitTreeChanged();\n        await this.emit(\"destroyed\");\n        await this.fileMgr.emitChanged();\n    }\n    async instantiate({ env, project, instanceId }: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<IFileInstance> {\n        const { type } = this;\n        const Constructor = {\n            patcher: (await import(\"../patcher/Patcher\")).default,\n            audio: (await import(\"../audio/PatcherAudio\")).default,\n            image: (await import(\"../image/PatcherImage\")).default,\n            text: (await import(\"../text/PatcherText\")).default,\n            video: undefined,\n            unknown: (await import(\"../text/PatcherText\")).default\n        }[type];\n        if (Constructor) return Constructor.fromProjectItem({ file: this as any, env, project, instanceId }) as Promise<IFileInstance>;\n        throw new Error(\"Not implemented.\");\n    }\n    async instantiateEditor({ env, project, instanceId }: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<IFileEditor> {\n        const { type } = this;\n        const Constructor = {\n            patcher: (await import(\"../patcher/PatcherEditor\")).default,\n            audio: (await import(\"../audio/AudioEditor\")).default,\n            image: (await import(\"../image/ImageEditor\")).default,\n            text: (await import(\"../text/TextEditor\")).default,\n            video: undefined,\n            unknown: (await import(\"../text/TextEditor\")).default\n        }[type];\n        if (Constructor) return Constructor.fromProjectItem({ file: this as any, env, project, instanceId }) as Promise<IFileEditor>;\n        throw new Error(\"Not implemented.\");\n    }\n}\n","import PersistentProjectFile from \"./PersistentProjectFile\";\nimport AbstractProjectFolder, { IProjectFolder } from \"./AbstractProjectFolder\";\nimport type { IPersistentProjectItemManager } from \"./PersistentProjectItemManager\";\n\nexport default class PersistentProjectFolder extends AbstractProjectFolder<IPersistentProjectItemManager> {\n    async init() {\n        this.id = this.fileMgr.generateItemId(this);\n        const items = await this.fileMgr.readDir(this.path || \"/\");\n        for (const rawItem of items) {\n            const { name, isFolder } = rawItem;\n            const item = this.createProjectItem(name, isFolder);\n            this.items.add(item);\n            await this.emitTreeChanged();\n            await item.init();\n        }\n        await this.emit(\"ready\");\n        await this.fileMgr.emitChanged();\n    }\n    clone(parentIn = this.parent, nameIn = this._name) {\n        const Ctor = this.constructor as typeof PersistentProjectFolder;\n        return new Ctor(this._fileMgr, parentIn, nameIn);\n    }\n    createProjectItem(nameIn: string, isFolder: boolean, dataIn?: ArrayBuffer): PersistentProjectFolder | PersistentProjectFile {\n        if (isFolder) return new PersistentProjectFolder(this.fileMgr, this, nameIn);\n        return new PersistentProjectFile(this.fileMgr, this, nameIn, dataIn);\n    }\n    async addFile(nameIn: string, dataIn?: ArrayBuffer) {\n        if (this.existItem(nameIn)) throw new Error(`${nameIn} already exists.`);\n        const tempItem = new PersistentProjectFile(this.fileMgr, this, nameIn, dataIn);\n        await this.fileMgr.putFile(tempItem);\n        const fileDetail = await this.fileMgr.getFileDetails(this.path, nameIn);\n        const item = this.createProjectItem(nameIn, fileDetail.isFolder, dataIn);\n        this.items.add(item);\n        await this.emitTreeChanged();\n        item.init();\n        return item;\n    }\n    async addFolder(name: string) {\n        if (this.existItem(name)) throw new Error(`${name} already exists.`);\n        const folder = new PersistentProjectFolder(this.fileMgr, this, name);\n        await this.fileMgr.putFile(folder);\n        this.items.add(folder);\n        await folder.init();\n        await this.emitTreeChanged();\n        return folder;\n    }\n    async rename(newNameIn: string) {\n        const newName = newNameIn.trim();\n        const oldName = this._name;\n        if (newName === oldName) return;\n        if (this.parent.existItem(newNameIn)) throw new Error(`${newName} already exists.`);\n        await this.fileMgr.rename(this.path, `${this.parentPath}/${newNameIn}`);\n        this._name = newName;\n        await this.emitTreeChanged();\n        await this.emit(\"nameChanged\", { oldName, newName });\n    }\n    async move(to: IProjectFolder, newName = this.name) {\n        if (to === this) return;\n        if (to === this.parent && newName === this.name) return;\n        if (to.existItem(newName)) throw new Error(`${newName} already exists in ${to.name}`);\n        await this._fileMgr.rename(this.path, `${to.path}/${newName}`);\n        const from = this.parent;\n        from.items.delete(this);\n        this.parent = to;\n        const oldName = this._name;\n        this._name = newName;\n        this.parent.items.add(this);\n        await from.emitTreeChanged();\n        await this.emitTreeChanged();\n        await this.emit(\"pathChanged\", { from: from.path, to: to.path });\n        if (oldName !== newName) await this.emit(\"nameChanged\", { oldName, newName });\n    }\n    async destroy() {\n        await this._fileMgr.remove(this.path, this.isFolder);\n        this.parent.items.delete(this as any);\n        await this.emitTreeChanged();\n        await this.emit(\"destroyed\");\n    }\n}\n","import TemporaryProjectFile from \"./TemporaryProjectFile\";\n\nexport default class TempData extends TemporaryProjectFile {\n    get type() {\n        return \"unknown\" as const;\n    }\n    async instantiate(): Promise<any> {\n        return this.data;\n    }\n}\n","import AbstractProjectFile from \"./AbstractProjectFile\";\nimport PersistentProjectFile from \"./PersistentProjectFile\";\nimport type TemporaryProjectItemManager from \"./TemporaryProjectItemManager\";\nimport type PersistentProjectItemManager from \"./PersistentProjectItemManager\";\nimport type { IProjectFolder } from \"./AbstractProjectFolder\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\nimport type { IFileEditor } from \"./FileEditor\";\nimport type { IFileInstance } from \"./FileInstance\";\n\n/**\n * An item under TempMgr, this contains in-memory data/instance.\n */\nexport default class TemporaryProjectFile<Data = any> extends AbstractProjectFile<Data, TemporaryProjectItemManager> {\n    async removeObserver(observer: string) {\n        await super.removeObserver(observer);\n        await this.fileMgr.emitChanged();\n        if (this._observers.size === 0) await this.destroy();\n    }\n    /**\n     * Creating alias (do not copy the data, new item has the same ref)\n     */\n    clone(parentIn = this.parent, nameIn = this._name, dataIn = this.data) {\n        const Ctor = this.constructor as typeof TemporaryProjectFile;\n        return new Ctor(this._fileMgr, parentIn, nameIn, dataIn);\n    }\n    async rename(newNameIn: string) {\n        const newName = newNameIn.trim();\n        const oldName = this._name;\n        if (newName === oldName) return;\n        if (this.parent.existItem(newNameIn)) throw new Error(`${newName} already exists.`);\n        this._name = newName;\n        await this.emitTreeChanged();\n        await this.emit(\"nameChanged\", { oldName, newName });\n        await this.fileMgr.emitChanged();\n    }\n    async move(to: IProjectFolder, newName = this.name) {\n        if (to === this as any) return;\n        if (to === this.parent) return;\n        if (to.existItem(newName)) throw new Error(`${newName} already exists in ${to.name}`);\n        const from = this.parent;\n        from.items.delete(this);\n        this.parent = to;\n        const oldName = this._name;\n        this._name = newName;\n        this.parent.items.add(this);\n        await from.emitTreeChanged();\n        await this.emitTreeChanged();\n        await this.emit(\"pathChanged\", { from: from.path, to: to.path });\n        if (oldName !== newName) await this.emit(\"nameChanged\", { oldName, newName });\n        await this.fileMgr.emitChanged();\n    }\n    async destroy() {\n        this.parent.items.delete(this);\n        await this.emitTreeChanged();\n        await this.emit(\"destroyed\");\n        await this.fileMgr.emitChanged();\n    }\n    async save(newData: Data, by: any) {\n        this._data = newData;\n        this.emit(\"saved\", by);\n        await this.fileMgr.emitChanged();\n    }\n    async saveAsCopy(parent: IProjectFolder, name: string, newData: ArrayBuffer, persistentMgr?: PersistentProjectItemManager) {\n        const item = new PersistentProjectFile(persistentMgr, parent, name, newData);\n        await persistentMgr.putFile(item);\n        parent.items.add(item);\n        await this.emitTreeChanged();\n        await item.init();\n        return item;\n    }\n    async saveAs(to: IProjectFolder, name: string, newData: ArrayBuffer, by: any, persistentMgr: PersistentProjectItemManager) {\n        const item = new PersistentProjectFile(persistentMgr, to, name, newData);\n        await persistentMgr.putFile(item);\n        const from = this.parent;\n        this.parent = to;\n        this._name = name;\n        const _this: PersistentProjectFile = Object.setPrototypeOf(this, PersistentProjectFile.prototype);\n        this.parent.items.add(_this);\n        await this.emitTreeChanged();\n        await this.emit(\"pathChanged\", { from: from.path, to: to.path });\n        await this.emit(\"saved\", by);\n        await item.init();\n        return this;\n    }\n    async instantiate(options: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<IFileInstance> {\n        throw new Error(\"Not implemented.\");\n        // new instance Patcher / AudioBuffer etc\n    }\n    async instantiateEditor(options: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<IFileEditor> {\n        throw new Error(\"Not implemented.\");\n    }\n}\n","import TempAudioFile from \"../audio/TempAudioFile\";\nimport TempPatcherFile from \"../patcher/TempPatcherFile\";\nimport TempTextFile from \"../text/TempTextFile\";\nimport TempData from \"./TempData\";\nimport AbstractProjectFolder, { IProjectFolder } from \"./AbstractProjectFolder\";\nimport type TemporaryProjectFile from \"./TemporaryProjectFile\";\nimport type { TempItemType } from \"../types\";\nimport type TemporaryProjectItemManager from \"./TemporaryProjectItemManager\";\n\nexport default class TemporaryProjectFolder extends AbstractProjectFolder<TemporaryProjectItemManager> {\n    async init() {\n        this.id = this.fileMgr.generateItemId(this);\n        await this.emit(\"ready\");\n    }\n    clone(parentIn = this.parent, nameIn = this._name) {\n        const Ctor = this.constructor as typeof TemporaryProjectFolder;\n        return new Ctor(this._fileMgr, parentIn, nameIn);\n    }\n    createProjectItem(name: string, isFolder: boolean, data?: any, typeIn?: TempItemType): TemporaryProjectFile {\n        const type = typeIn || this.fileMgr.getTypeFromFileName(name);\n        if (type === \"patcher\") return new TempPatcherFile(this.fileMgr, this, name, data);\n        if (type === \"audio\") return new TempAudioFile(this.fileMgr, this, name, data);\n        if (type === \"text\") return new TempTextFile(this.fileMgr, this, name, data);\n        return new TempData(this.fileMgr, this, name, data);\n    }\n    async addFile(name: string, data?: any, typeIn?: TempItemType) {\n        if (this.existItem(name)) throw new Error(`${name} already exists.`);\n        const item = this.createProjectItem(name, false, data, typeIn);\n        this.items.add(item);\n        await this.emitTreeChanged();\n        await item.init();\n        return item;\n    }\n    async addFolder(name: string) {\n        if (this.existItem(name)) throw new Error(`${name} already exists.`);\n        const folder = new TemporaryProjectFolder(this.fileMgr, this, name);\n        this.items.add(folder);\n        await folder.init();\n        await this.emitTreeChanged();\n        await this.fileMgr.emitChanged();\n        return folder;\n    }\n    async rename(newNameIn: string) {\n        const newName = newNameIn.trim();\n        const oldName = this._name;\n        if (newName === oldName) return;\n        if (this.parent.existItem(newNameIn)) throw new Error(`${newName} already exists.`);\n        this._name = newName;\n        await this.emitTreeChanged();\n        await this.emit(\"nameChanged\", { oldName, newName });\n        await this.fileMgr.emitChanged();\n    }\n    async move(to: IProjectFolder, newName = this.name) {\n        if (to === this) return;\n        if (to === this.parent) return;\n        if (to.existItem(newName)) throw new Error(`${newName} already exists in ${to.name}`);\n        const from = this.parent;\n        from.items.delete(this);\n        this.parent = to;\n        const oldName = this._name;\n        this._name = newName;\n        this.parent.items.add(this);\n        await from.emitTreeChanged();\n        await this.emitTreeChanged();\n        await this.emit(\"pathChanged\", { from: from.path, to: to.path });\n        if (oldName !== newName) await this.emit(\"nameChanged\", { oldName, newName });\n        await this.fileMgr.emitChanged();\n    }\n    async destroy() {\n        this.parent.items.delete(this);\n        await this.emitTreeChanged();\n        await this.emit(\"destroyed\");\n        await this.fileMgr.emitChanged();\n    }\n}\n","import TemporaryProjectFolder from \"./TemporaryProjectFolder\";\nimport AbstractProjectItemManager from \"./AbstractProjectItemManager\";\nimport type { IProjectFileOrFolder } from \"./AbstractProjectItem\";\n\nexport default class TemporaryProjectItemManager extends AbstractProjectItemManager {\n    root: TemporaryProjectFolder;\n    async empty() {\n        return true;\n    }\n    async init(clean?: boolean) {\n        this.root = new TemporaryProjectFolder(this, null, null);\n        await this.root.init();\n        this.emit(\"ready\");\n        return this;\n    }\n    getProjectItemFromPath(path: string) {\n        const pathArray = path.split(\"/\");\n        const itemArray: IProjectFileOrFolder[] = [this.root];\n        for (let i = 0; i < pathArray.length; i++) {\n            const id = pathArray[i];\n            if (id.length === 0) continue;\n            if (id === \".\") continue;\n            if (id === \"..\") {\n                itemArray.pop();\n                continue;\n            }\n            const cur = itemArray[itemArray.length - 1];\n            if (cur.isFolder === false) throw new Error(`${cur.name} from path ${path} is not a folder`);\n            const next = cur.findItem(id);\n            if (!next) throw new Error(`Cannot find ${id} from path ${path}`);\n            itemArray.push(next);\n        }\n        return itemArray[itemArray.length - 1];\n    }\n}\n","import AbstractProjectItemManager, { IProjectItemManager } from \"./AbstractProjectItemManager\";\nimport PersistentProjectFolder from \"./PersistentProjectFolder\";\nimport type { TypedMessagePort } from \"../workers/Worker\";\nimport type WorkletEnvProcessor from \"../worklets/WorkletEnv.worklet\";\nimport type { IProjectFolder } from \"./AbstractProjectFolder\";\nimport type { IPersistentProjectItemManager, ProjectItemManagerDataForDiff } from \"./PersistentProjectItemManager\";\nimport type { IProjectItem } from \"./AbstractProjectItem\";\nimport type PersistentProjectFile from \"./PersistentProjectFile\";\n\nexport default class WorkletProjectItemManager extends AbstractProjectItemManager implements IPersistentProjectItemManager {\n    readonly port: TypedMessagePort;\n    readonly env: WorkletEnvProcessor;\n    cachedPathIdMap: Record<string, string> = {};\n    disabled = false;\n    constructor(envIn: WorkletEnvProcessor) {\n        super(envIn);\n        this.env = envIn;\n    }\n    empty(): Promise<any> {\n        throw new Error(\"Empty is not allowed from other threads.\");\n    }\n    async init() {\n        this.cachedPathIdMap = await this.env.fileMgrGetPathIdMap();\n        this.root = new PersistentProjectFolder(this, null, null);\n        await this.root.init();\n        if (!this.projectRoot) await this.root.addFolder(this.projectFolderName);\n        this.emit(\"ready\");\n        return this;\n    }\n    getDataForDiff() {\n        const map: ProjectItemManagerDataForDiff = {};\n        const { allItems } = this;\n        for (const id in allItems) {\n            const item = allItems[id] as PersistentProjectFile | PersistentProjectFolder;\n            if (item.isFolder === true) map[id] = { isFolder: item.isFolder, parent: item.parent?.id, name: item.name, path: item.path };\n            else map[id] = { isFolder: item.isFolder, data: item.sab, lastModifiedId: item.lastModifiedId, parent: item.parent?.id, name: item.name, path: item.path };\n        }\n        return map;\n    }\n    async processDiff(diff: ProjectItemManagerDataForDiff) {\n        this.disabled = true;\n        for (const id in diff) {\n            const process = async (id: string): Promise<void> => {\n                const $item = diff[id];\n                const $parentId = $item.parent;\n                if (!$parentId) return;\n                let parent = this.getProjectItemFromId($parentId);\n                if (!parent) await process($parentId);\n                parent = this.getProjectItemFromId($parentId) as PersistentProjectFolder;\n                const current = this.getProjectItemFromId(id) as PersistentProjectFile | PersistentProjectFolder;\n                if (!current) {\n                    if (parent.isFolder === true) {\n                        this.cachedPathIdMap[$item.path] = id;\n                        if ($item.isFolder === true) {\n                            await parent.addFolder($item.name);\n                        } else {\n                            const newFile = await parent.addFile($item.name, $item.data) as PersistentProjectFile;\n                            newFile.lastModifiedId = $item.lastModifiedId;\n                        }\n                    }\n                } else {\n                    if (current.isFolder === false && $item.isFolder === false) {\n                        if (current.lastModifiedId !== $item.lastModifiedId) await current.save($item.data, this);\n                        if (current.name !== $item.name) await current.rename($item.name);\n                        if (current.parent?.id !== $item.parent) await current.move(parent);\n                    }\n                }\n            };\n            await process(id);\n        }\n        this.disabled = false;\n    }\n    generateItemId(item: IProjectItem) {\n        const id = this.cachedPathIdMap[item.path];\n        if (!id) return this.env.generateId(item);\n        delete this.cachedPathIdMap[item.path];\n        return id;\n    }\n    readFile(path: string) {\n        return this.env.fileMgrReadFile(path);\n    }\n    readDir(path?: string): Promise<{ isFolder: boolean; name: string }[]> {\n        return this.env.fileMgrReadDir(path);\n    }\n    getFileDetails(path: string, name: string) {\n        return this.env.fileMgrGetFileDetails(path, name);\n    }\n    exists(path: string) {\n        return this.env.fileMgrExists(path);\n    }\n    putFile(item: { isFolder: boolean; path: string; data?: ArrayBuffer | SharedArrayBuffer }) {\n        if (this.disabled) return null;\n        return this.env.fileMgrPutFile(item);\n    }\n    async writeFile(path: string, data: ArrayBuffer | SharedArrayBuffer) {\n        if (this.disabled) return null;\n        return this.env.fileMgrWriteFile(path, data);\n    }\n    async remove(path: string, isFolder?: boolean) {\n        return true;\n    }\n    async rename(oldPath: string, newPath: string) {\n        return true;\n    }\n    importFileZip(data: ArrayBuffer, subfolder?: string, to?: IProjectFolder<IProjectItemManager<{}>>, taskHost?: any): Promise<void> {\n        throw new Error(\"Import is not allowed from other threads.\");\n    }\n    exportProjectZip(): Promise<ArrayBuffer> {\n        throw new Error(\"Import is not allowed from other threads.\");\n    }\n}\n","import type { SemanticICONS } from \"semantic-ui-react\";\nimport TypedEventEmitter from \"../../../utils/TypedEventEmitter\";\nimport { stringifyError } from \"../../../utils/utils\";\nimport Line from \"../../patcher/Line\";\nimport type Box from \"../../patcher/Box\";\nimport type Patcher from \"../../patcher/Patcher\";\nimport type { ProjectItemType, TempItemByType, SharedItemByType, TempItemType, TAudioNodeInletConnection, TAudioNodeOutletConnection } from \"../../types\";\nimport type AbstractUI from \"./AbstracttUI\";\nimport type { IJSPatcherEnv } from \"../../Env\";\n\nexport const isJSPatcherObjectConstructor = (x: any): x is typeof AbstractObject => typeof x === \"function\" && x?.isJSPatcherObjectConstructor;\n\nexport const isJSPatcherObject = (x: any): x is AbstractObject => typeof x === \"object\" && x?.isJSPatcherObject;\n\nexport type TMetaType = \"anything\" | \"signal\" | \"object\" | \"number\" | \"boolean\" | \"string\" | \"function\" | \"bang\" | \"color\" | \"enum\";\nexport interface IInletMeta {\n    isHot: boolean;\n    type: TMetaType;\n    enums?: string[];\n    varLength?: boolean;\n    description: string;\n}\nexport type IInletsMeta = IInletMeta[];\nexport interface IOutletMeta {\n    type: TMetaType;\n    enums?: string[];\n    varLength?: boolean;\n    description: string;\n}\nexport type IOutletsMeta = IOutletMeta[];\nexport interface IArgMeta {\n    type: TMetaType;\n    enums?: string[];\n    optional: boolean;\n    default?: any;\n    varLength?: boolean;\n    description: string;\n}\nexport type IArgsMeta = IArgMeta[];\nexport interface IPropMeta<T extends any = any> {\n    type: TMetaType;\n    enums?: T[];\n    default: T;\n    group?: string;\n    description: string;\n    isUIState?: boolean;\n}\nexport type IPropsMeta<T extends Record<string, any> = Record<string, any>> = { [K in keyof T]: IPropMeta<T[K]> };\nexport interface IJSPatcherObjectMeta<P extends Record<string, any> = Record<string, any>> {\n    package: string; // div will have class \"package-name\" \"package-name-objectname\"\n    name: string;\n    icon: SemanticICONS; // semantic icon to display in UI\n    author: string;\n    version: string;\n    description: string;\n    inlets: IInletsMeta;\n    outlets: IOutletsMeta;\n    args: IArgsMeta;\n    props: IPropsMeta<P>;\n    isPatcherInlet: \"data\" | \"audio\" | \"parameter\" | false;\n    isPatcherOutlet: \"data\" | \"audio\" | false;\n}\n\nexport interface ObjectUpdateOptions {\n    undoable?: boolean;\n}\n\nexport type Data<T> = T extends IJSPatcherObject<infer D, any, any, any, any, any, any, any> ? D : never;\nexport type State<T> = T extends IJSPatcherObject<any, infer S, any, any, any, any, any, any> ? S : never;\nexport type Inputs<T> = T extends IJSPatcherObject<any, any, infer I, any, any, any, any, any> ? I : never;\nexport type Outputs<T> = T extends IJSPatcherObject<any, any, any, infer O, any, any, any, any> ? O : never;\nexport type Args<T> = T extends IJSPatcherObject<any, any, any, any, infer A, any, any, any> ? A : never;\nexport type Props<T> = T extends IJSPatcherObject<any, any, any, any, any, infer P, any, any> ? P : never;\nexport type UIState<T> = T extends IJSPatcherObject<any, any, any, any, any, any, infer U, any> ? U : never;\nexport type EventMap<T> = T extends IJSPatcherObject<any, any, any, any, any, any, any, infer E> ? E : never;\nexport type TInletEvent<I extends any[] = any[], $ extends keyof Pick<I, number> = keyof Pick<I, number>> = { inlet: $; data: I[$] };\nexport type TOutletEvent<O extends any[] = any[], $ extends keyof Pick<O, number> = keyof Pick<O, number>> = { outlet: $; data: O[$] };\nexport type JSPatcherObjectEventMap<D, S, I extends any[], A extends any[], P, U, E> = {\n    /** Emitted before any connection */\n    \"preInit\": never;\n    /** Emitted after connections */\n    \"postInit\": never;\n    /** Emitted immediately when the editor request changes to the args */\n    \"updateArgs\": Partial<A>;\n    /** Emitted immediately when the editor request changes to the props */\n    \"updateProps\": Partial<P>;\n    /** Emitted immediately when the editor request changes to the state */\n    \"updateState\": Partial<S>;\n    /** The UI will listen to this event type */\n    \"updateUI\": Partial<U> | never;\n    /** Emitted if received any input */\n    \"inlet\": TInletEvent<I>;\n    /** Emitted when a new connection/disconnection is made on any I/O */\n    \"connectedInlet\": { inlet: number; srcBoxId: string; srcOutlet: number; lineId: string };\n    \"connectedOutlet\": { outlet: number; destBoxId: string; destInlet: number; lineId: string };\n    \"disconnectedInlet\": { inlet: number; srcBoxId: string; srcOutlet: number; lineId: string };\n    \"disconnectedOutlet\": { outlet: number; destBoxId: string; destInlet: number; lineId: string };\n    /** Emitted when the object will be destroyed, attach a callback to clean up */\n    \"destroy\": never;\n    /** Emitted when the object's metadata is changed (by itself) */\n    \"metaUpdated\": { oldMeta: IJSPatcherObjectMeta; meta: IJSPatcherObjectMeta };\n    /** Emitted when the object's args is changed */\n    \"argsUpdated\": { oldArgs: A; args: A };\n    /** Emitted when the object's data is changed */\n    \"propsUpdated\": { oldProps: Partial<P>; props: Partial<P> };\n    /** Emitted when the object's data is changed (by itself) */\n    \"dataUpdated\": { oldData: D; data: D };\n    /** Emitted when the object's state is changed */\n    \"stateUpdated\": { oldState: S; state: S };\n} & E;\n\n/**\n * All JSPatcher Object should extends this class\n *\n * @template D serializable, type of `data` property, use `setData` to update. Data will be stored with the box in the serialized patcher. Will mark the patcher `dirty`.\n * @template S serializable, type of `state` property, use `setState` to update. State is temporary to the object instance. Can be updated from the host.\n * @template I type of inlets as an array.\n * @template O type of outlets as an array.\n * @template A serializable, type of args as an array.\n * @template P serializable, type of props as a map.\n * @template U type of UI state as a map, the UI will listen to any update of this map. If the object can be running on another thread, this should be serializable.\n * @template E type of additional event map\n */\nexport interface IJSPatcherObject<\n    D extends {} = {},\n    S extends {} = {},\n    I extends any[] = any[],\n    O extends any[] = any[],\n    A extends any[] = any[],\n    P extends {} = {},\n    U extends {} = {},\n    E extends Partial<JSPatcherObjectEventMap<D, S, I, A, P, U, {}>> & Record<string, any> = {}\n> extends TypedEventEmitter<JSPatcherObjectEventMap<D, S, I, A, P, U, E>> {\n    /** Should be true */\n    readonly isJSPatcherObject: true;\n    /** Unique identifier of the object */\n    readonly id: string;\n    /** constructor (class) name */\n    readonly class: string;\n    /** the patcher that the object lives in */\n    readonly patcher: Patcher;\n    /** Patcher constructor */\n    readonly Patcher: typeof Patcher;\n    /** the box that the object lives in */\n    readonly box: Box<this>;\n    /** the env that the object lives in */\n    readonly env: IJSPatcherEnv;\n    readonly audioCtx?: AudioContext;\n    readonly meta: IJSPatcherObjectMeta<P>;\n    setMeta(metaIn: Partial<IJSPatcherObjectMeta>): void;\n    /** Serializable, use `setState` to update. State is temporary to the object instance. Can be updated from the host. */\n    state: S;\n    setState(stateIn: Partial<S>): void;\n    /** Serializable, type of `data` property, use `setData` to update. Data will be stored with the box in the serialized patcher. */\n    readonly data: D;\n    setData(dataIn: Partial<D>): void;\n    /** Get all props from box, if not defined, get from metadata default */\n    readonly props: Partial<P>;\n    /** Get prop value from box, if not defined, get from metadata default. */\n    getProp<K extends keyof P = keyof P>(key: K): P[K];\n    setProps(props: Partial<P>): void;\n    readonly args: Partial<A>;\n    setArgs(args: Partial<A>): void;\n    inlets: number;\n    outlets: number;\n    readonly inletLines: Set<Line>[];\n    readonly outletLines: Set<Line>[];\n    inletAudioConnections: TAudioNodeInletConnection<AudioNode | AudioParam>[];\n    outletAudioConnections: TAudioNodeOutletConnection[];\n\n    // for box\n    /** Will be called just after constructed */\n    init(): Promise<void>;\n    /** Will be called after the object attached to box */\n    postInit(): Promise<void>;\n    /** Will be called when need to change arguments */\n    updateArgs(args: A, options?: ObjectUpdateOptions): Promise<void>;\n    /** Will be called when need to change properties */\n    updateProps(props: Partial<P>, options?: ObjectUpdateOptions): Promise<void>;\n    /** Will be called when need to change state */\n    updateState(state: Partial<S>, options?: ObjectUpdateOptions): Promise<void>;\n    /** Main function when receive data from a inlet (base 0). */\n    fn<$ extends number = number>(inlet: $, data: I[$]): void;\n    /** Called when object will be destroyed. */\n    destroy(): Promise<void>;\n    // called when inlet or outlet are connected or disconnected\n    connectedInlet(inlet: number, srcBoxId: string, srcOutlet: number, lineId: string): void;\n    disconnectedInlet(inlet: number, srcBoxId: string, srcOutlet: number, lineId: string): void;\n    connectedOutlet(outlet: number, destBoxId: string, destInlet: number, lineId: string): void;\n    disconnectedOutlet(outlet: number, destBoxId: string, destInlet: number, lineId: string): void;\n    /** Highlight the UI box. */\n    highlight(): void;\n\n    // for developer\n    /** Update UI's React State. */\n    updateUI(state: Partial<U>): void;\n    /** Output data with ith outlet. */\n    outlet<$ extends number>(outlet: $, data: O[$]): void;\n    /**\n     * Outlet all values in an array with corresponding index,\n     * use sparse array to omit an outlet,\n     * `[, 1]` will outlet 1 on second outlet,\n     * but `[undefined, 1]` will also outlet undefined on first outlet\n     */\n    outletAll(outputs: Partial<O>): void;\n    /** Record an undoable operation to the patcher history */\n    undoable(e: { oldArgs?: A; args?: A; oldProps?: Partial<P>; props?: Partial<P>; oldState?: S; state?: S }): void;\n    /**\n     * Get a shared item from files or temp\n     * If no ID provided, this will create a new key in temp\n     * if no such ID found in files or in temp, will put the result of data() into it.\n     */\n    getSharedItem<T extends ProjectItemType>(id?: string, type?: T, data?: () => Promise<TempItemByType<T>[\"data\"]>, onceCreate?: (aitem: SharedItemByType<T>) => any): Promise<{ id: string; item: SharedItemByType<T>; newItem: boolean; off?: () => any }>;\n    // output to console\n    post(data: any): void;\n    error(data: any): void;\n    info(data: any): void;\n    warn(data: any): void;\n    connectAudio(): void;\n    connectAudioInlet(portIn?: number): void;\n    connectAudioOutlet(portIn?: number): void;\n    disconnectAudio(): void;\n    disconnectAudioInlet(portIn?: number): void;\n    disconnectAudioOutlet(portIn?: number): void;\n    applyBPF(param: AudioParam, bpf: number[][]): void;\n}\nexport declare const IJSPatcherObject: {\n    /** Should be true */\n    readonly isJSPatcherObjectConstructor: true;\n    /** div will have class \"packageName\" \"packageName-objectName\" */\n    package: string;\n    readonly _name: string;\n    icon: SemanticICONS;\n    author: string;\n    version: string;\n    description: string;\n    inlets: IInletsMeta;\n    outlets: IOutletsMeta;\n    args: IArgsMeta;\n    props: IPropsMeta;\n    isPatcherInlet: \"data\" | \"audio\" | false;\n    isPatcherOutlet: \"data\" | \"audio\" | false;\n    readonly meta: IJSPatcherObjectMeta;\n    /**\n     * The UI that the object uses to display in the patcher, not available in other threads.\n     * is `BaseUI` by default\n     */\n    UI?: typeof AbstractUI;\n    new (box: Box, patcher: Patcher): IJSPatcherObject;\n};\n\nexport interface AnyJSPatcherObject extends IJSPatcherObject<Record<string, any>, Record<string, any>, any[], any[], any[], Record<string, any>, Record<string, any>, Record<string, any>> {}\n\nexport default abstract class AbstractObject<\n    D extends {} = {},\n    S extends {} = {},\n    I extends any[] = any[],\n    O extends any[] = any[],\n    A extends any[] = any[],\n    P extends {} = {},\n    U extends {} = {},\n    E extends Partial<JSPatcherObjectEventMap<D, S, I, A, P, U, {}>> & Record<string, any> = {}\n> extends TypedEventEmitter<JSPatcherObjectEventMap<D, S, I, A, P, U, E>> implements IJSPatcherObject<D, S, I, O, A, P, U, E> {\n    static readonly isJSPatcherObjectConstructor = true as const;\n    static package = \"Base\";\n    static get _name() {\n        return this.name;\n    }\n    static icon = null as SemanticICONS;\n    static author = \"\";\n    static version = \"0.0.0\";\n    static description = \"\";\n    static inlets: IInletsMeta = [];\n    static outlets: IOutletsMeta = [];\n    static args: IArgsMeta = [];\n    static props: IPropsMeta = {};\n    static isPatcherInlet: \"data\" | \"audio\" | false = false;\n    static isPatcherOutlet: \"data\" | \"audio\" | false = false;\n    static get meta(): IJSPatcherObjectMeta {\n        return {\n            package: this.package, // div will have class \"package-name\" \"package-name-objectname\"\n            name: this._name,\n            icon: this.icon, // semantic icon to display in UI\n            author: this.author,\n            version: this.version,\n            description: this.description,\n            inlets: this.inlets,\n            outlets: this.outlets,\n            args: this.args,\n            props: this.props,\n            isPatcherInlet: this.isPatcherInlet,\n            isPatcherOutlet: this.isPatcherOutlet\n        };\n    }\n    static UI: typeof AbstractUI;\n\n    readonly isJSPatcherObject = true as const;\n    readonly id: string;\n    get class() {\n        return this.constructor.name;\n    }\n    protected readonly _patcher: Patcher;\n    get patcher() {\n        return this._patcher;\n    }\n    get Patcher() {\n        return this._patcher.constructor as typeof Patcher;\n    }\n    protected readonly _box: Box<this>;\n    get box() {\n        return this._box;\n    }\n    get env() {\n        return this.patcher.env;\n    }\n    get audioCtx() {\n        return this.patcher.audioCtx;\n    }\n    private _meta = (this.constructor as typeof AbstractObject).meta as IJSPatcherObjectMeta<P>;\n    get meta(): IJSPatcherObjectMeta<P> {\n        return this._meta;\n    }\n    setMeta(metaIn: Partial<IJSPatcherObjectMeta<P>>) {\n        const oldMeta = { ...this.meta };\n        this._meta = Object.assign(this.meta, metaIn);\n        this.emit(\"metaUpdated\", { oldMeta, meta: { ...this.meta } });\n    }\n    state: S;\n    setState = (stateIn: Partial<S>) => {\n        const oldState = { ...this.state };\n        this.state = Object.assign(this.state, stateIn);\n        this.emit(\"stateUpdated\", { oldState, state: { ...this.state } });\n    };\n    get data(): D {\n        return this._box.data;\n    }\n    setData(dataIn: Partial<D>) {\n        const oldData = { ...this._box.data };\n        this._box.data = Object.assign(this.data, dataIn) as any;\n        this.emit(\"dataUpdated\", { oldData, data: { ...this.data } });\n    }\n    get props(): Partial<P> {\n        const props: Partial<P> = {};\n        for (const key in this.meta.props) {\n            props[key as keyof P] = this.getProp(key as keyof P);\n        }\n        return props;\n    }\n    getProp<K extends keyof P = keyof P>(key: K): P[K] {\n        if (key === \"rect\") return this.box.rect as any;\n        if (key === \"presentationRect\") return this.box.presentationRect as any;\n        if (key === \"background\") return this.box.background as any;\n        if (key === \"presentation\") return this.box.presentation as any;\n        return typeof this.box.props[key] === \"undefined\" ? this.meta.props[key].default : this.box.props[key];\n    }\n    setProps = (propsIn: Partial<P>) => {\n        const keys = Object.keys(propsIn);\n        const oldProps = { ...this.props } as Partial<P>;\n        this.box.update({ props: propsIn });\n        const props = { ...this.props } as Partial<P>;\n        for (const key in oldProps) {\n            if (keys.indexOf(key) === -1) {\n                delete oldProps[key];\n                delete props[key];\n            }\n        }\n        this.emit(\"propsUpdated\", { oldProps, props });\n    };\n    get args(): Partial<A> {\n        return this.box.args as any;\n    }\n    setArgs = (args: Partial<A>) => {\n        const oldArgs = this.args.slice() as A;\n        this.box.update({ args });\n        this.emit(\"argsUpdated\", { oldArgs, args: this.args.slice() as A });\n    };\n    get inlets() {\n        return this._box.inlets;\n    }\n    set inlets(i: number) {\n        this._box.setInlets(i);\n    }\n    get outlets() {\n        return this._box.outlets;\n    }\n    set outlets(i: number) {\n        this._box.setOutlets(i);\n    }\n    get outletLines() {\n        return this._box.outletLines;\n    }\n    get inletLines() {\n        return this._box.inletLines;\n    }\n    inletAudioConnections: TAudioNodeInletConnection[] = [];\n    outletAudioConnections: TAudioNodeOutletConnection[] = [];\n    constructor(box: Box, patcher: Patcher) {\n        super();\n        // line connected = metaChange event subscribed\n        // patcher object outside, use _ for prevent recursive stringify\n        this._patcher = patcher;\n        // the box which create this instance, use _ for prevent recursive stringify\n        this._box = box as Box<this>;\n        this.id = this.env.generateId(this);\n    }\n    async init() {\n        // process args and props\n        this.subscribe();\n        await this.emit(\"preInit\");\n    }\n    async postInit() {\n        await this.emit(\"postInit\");\n    }\n    /** Do everything here */\n    subscribe(): void {}\n    updateUI(state: Partial<U>) {\n        this.emit(\"updateUI\", state);\n    }\n    async updateArgs(args: A, options?: ObjectUpdateOptions) {\n        if (args?.length) {\n            const oldArgs = this.args.slice() as A;\n            await this.emit(\"updateArgs\", args);\n            if (options?.undoable) this.undoable({ oldArgs, args: this.args.slice() as A });\n        }\n    }\n    async updateProps(propsIn: Partial<P>, options?: ObjectUpdateOptions) {\n        if (propsIn && Object.keys(propsIn).length) {\n            const keys = Object.keys(propsIn);\n            const oldProps = { ...this.props };\n            await this.emit(\"updateProps\", propsIn);\n            const props = { ...this.props };\n            for (const key in oldProps) {\n                if (keys.indexOf(key) === -1) {\n                    delete oldProps[key];\n                    delete props[key];\n                }\n            }\n            if (options?.undoable) this.undoable({ oldProps, props });\n        }\n    }\n    async updateState(state: Partial<S>, options?: ObjectUpdateOptions) {\n        if (state && Object.keys(state).length) {\n            const oldState = { ...this.state };\n            await this.emit(\"updateState\", state);\n            if (options?.undoable) this.undoable({ oldState, state: { ...this.state } });\n        }\n    }\n    fn<$ extends keyof Pick<I, number> = keyof Pick<I, number>>(inlet: $, data: I[$]) {\n        if (inlet === 0) { // allow change props via first inlet with an props object\n            if (data !== null && typeof data === \"object\") {\n                const propsInKeys = Object.keys(data);\n                const propsKeys = Object.keys(this.meta.props);\n                if (propsInKeys.length && propsInKeys.every(k => propsKeys.indexOf(k) !== -1)) {\n                    this.updateProps(data);\n                    return;\n                }\n            }\n        }\n        this.emit(\"inlet\", { data, inlet });\n    }\n    outlet<$ extends keyof Pick<O, number>>(outlet: $, data: O[$]) {\n        if (outlet >= this.outlets) return;\n        Array.from(this.outletLines[outlet]).sort(Line.compare).map(line => line.pass(data));\n    }\n    outletAll(outputs: Partial<O>) {\n        for (let i = outputs.length - 1; i >= 0; i--) {\n            if (i in outputs) this.outlet(i, outputs[i]);\n        }\n    }\n    undoable(e: { oldArgs?: A; args?: A; oldProps?: Partial<P>; props?: Partial<P>; oldState?: S; state?: S }) {\n        this.box.undoable(e as any);\n    }\n    async destroy() {\n        await this.emit(\"destroy\");\n    }\n    connectedOutlet(outlet: number, destBoxId: string, destInlet: number, lineId: string) {\n        this.emit(\"connectedOutlet\", { outlet, destBoxId, destInlet, lineId });\n    }\n    connectedInlet(inlet: number, srcBoxId: string, srcOutlet: number, lineId: string) {\n        this.emit(\"connectedInlet\", { inlet, srcBoxId, srcOutlet, lineId });\n    }\n    disconnectedOutlet(outlet: number, destBoxId: string, destInlet: number, lineId: string) {\n        this.emit(\"disconnectedOutlet\", { outlet, destBoxId, destInlet, lineId });\n    }\n    disconnectedInlet(inlet: number, srcBoxId: string, srcOutlet: number, lineId: string) {\n        this.emit(\"disconnectedInlet\", { inlet, srcBoxId, srcOutlet, lineId });\n    }\n    post(data: any) {\n        this._patcher.newLog(\"none\", this.meta.name, stringifyError(data), this._box);\n    }\n    error(data: any) {\n        const s = stringifyError(data);\n        this._patcher.newLog(\"error\", this.meta.name, s, this._box);\n        this._box.error(s);\n    }\n    info(data: any) {\n        this._patcher.newLog(\"info\", this.meta.name, stringifyError(data), this._box);\n    }\n    warn(data: any) {\n        this._patcher.newLog(\"warn\", this.meta.name, stringifyError(data), this._box);\n    }\n    highlight() {\n        this._box.highlight();\n    }\n\n    connectAudio() {\n        this.box.allLines.forEach(line => line.enable());\n    }\n    connectAudioInlet(portIn?: number) {\n        this.inletLines.forEach((lines, port) => {\n            if (typeof portIn === \"undefined\" || port === portIn) lines.forEach(line => line.enable());\n        });\n    }\n    connectAudioOutlet(portIn?: number) {\n        this.outletLines.forEach((lines, port) => {\n            if (typeof portIn === \"undefined\" || port === portIn) lines.forEach(line => line.enable());\n        });\n    }\n    disconnectAudio() {\n        this.box.allLines.forEach(line => line.disable());\n    }\n    disconnectAudioInlet(portIn?: number) {\n        this.inletLines.forEach((lines, port) => {\n            if (typeof portIn === \"undefined\" || port === portIn) lines.forEach(line => line.disable());\n        });\n    }\n    disconnectAudioOutlet(portIn?: number) {\n        this.outletLines.forEach((lines, port) => {\n            if (typeof portIn === \"undefined\" || port === portIn) lines.forEach(line => line.disable());\n        });\n    }\n    applyBPF(param: AudioParam, bpf: number[][]) {\n        const { audioCtx } = this;\n        const { currentTime } = audioCtx;\n        param.cancelScheduledValues(currentTime);\n        param.setValueAtTime(param.value, currentTime);\n        let t = 0;\n        bpf.forEach((a) => {\n            if (a.length === 1) {\n                param.setValueAtTime(a[0], currentTime + t);\n            } else if (a.length > 1) {\n                t += a[1];\n                param.linearRampToValueAtTime(a[0], currentTime + t);\n            }\n        });\n    }\n    async getSharedItem<T extends ProjectItemType>(id = this.box.id, type: T = \"unknown\" as T, data?: () => Promise<TempItemByType<T>[\"data\"]>, onceCreate?: (aitem: SharedItemByType<T>) => any): Promise<{ id: string; item: SharedItemByType<T>; newItem: boolean; off?: () => any }> {\n        let item: SharedItemByType<T>;\n        let newItem = false;\n        const { fileMgr, tempMgr } = this.patcher.env;\n        try {\n            item = fileMgr.getProjectItemFromPath(id) as SharedItemByType<T>;\n        } catch {\n            try {\n                item = tempMgr.getProjectItemFromPath(id) as SharedItemByType<T>;\n            } catch {\n                if (data) {\n                    const d = await data();\n                    try {\n                        item = await tempMgr.root.addFile(id, d, type as TempItemType) as SharedItemByType<T>;\n                        newItem = true;\n                    } catch {\n                        item = tempMgr.getProjectItemFromPath(id) as SharedItemByType<T>;\n                    }\n                } else {\n                    if (onceCreate) {\n                        const off = () => {\n                            fileMgr.off(\"treeChanged\", handleFileMgrTreeChanged);\n                            tempMgr.off(\"treeChanged\", handleTempMgrTreeChanged);\n                        };\n                        const handleFileMgrTreeChanged = () => {\n                            try {\n                                item = fileMgr.getProjectItemFromPath(id) as SharedItemByType<T>;\n                                off();\n                                onceCreate(item);\n                            } catch {}\n                        };\n                        const handleTempMgrTreeChanged = () => {\n                            try {\n                                item = tempMgr.getProjectItemFromPath(id) as SharedItemByType<T>;\n                                off();\n                                onceCreate(item);\n                            } catch {}\n                        };\n                        fileMgr.on(\"treeChanged\", handleFileMgrTreeChanged);\n                        tempMgr.on(\"treeChanged\", handleTempMgrTreeChanged);\n                        return { id, item: null, newItem, off };\n                    }\n                    return { id, item: null, newItem };\n                }\n            }\n        }\n        if (item.type !== type) throw new Error(`Getting shared item ${id}, but returned item is of type ${item.type}, not of type ${type}.`);\n        return { id, item, newItem };\n    }\n}\n","export default class Bang {\n    isBang = true;\n    toString() {\n        return \"bang\";\n    }\n}\n\nexport const isBang = (x: any): x is Bang => typeof x === \"object\" && x?.isBang;\n","import AbstractObject, { IJSPatcherObjectMeta, IPropsMeta } from \"./AbstractObject\";\nimport type { TRect } from \"../../types\";\nimport type { BaseUIState } from \"./BaseUI\";\n\nexport interface BaseObjectAdditionalProps {\n    background: boolean;\n    presentation: boolean;\n    rect: TRect;\n    presentationRect: TRect;\n}\nexport interface BaseObjectProps extends BaseObjectAdditionalProps, BaseUIState {}\nexport default class BaseObject<\n    D extends {} = {},\n    S extends {} = {},\n    I extends any[] = any[],\n    O extends any[] = any[],\n    A extends any[] = any[],\n    P extends Partial<BaseObjectProps> & Record<string, any> = {},\n    U extends Partial<BaseUIState> & Record<string, any> = {},\n    E extends {} = {}\n> extends AbstractObject<D, S, I, O, A, P & BaseObjectProps, U & BaseUIState, E> {\n    static props: IPropsMeta = {\n        hidden: {\n            type: \"boolean\",\n            default: false,\n            description: \"Hide on lock\",\n            isUIState: true\n        },\n        background: {\n            type: \"boolean\",\n            default: false,\n            description: \"Include in background\"\n        },\n        presentation: {\n            type: \"boolean\",\n            default: false,\n            description: \"Include in presentation\"\n        },\n        rect: {\n            type: \"object\",\n            default: [0, 0, 90, 20],\n            description: \"Position and dimensions in patch\"\n        },\n        presentationRect: {\n            type: \"object\",\n            default: [0, 0, 90, 20],\n            description: \"Position and dimensions in presentation\"\n        },\n        ignoreClick: {\n            type: \"boolean\",\n            default: false,\n            description: \"Ignore Click\",\n            isUIState: true\n        },\n        hint: {\n            type: \"string\",\n            default: \"\",\n            description: \"Hint on hover\",\n            isUIState: true\n        }\n    };\n    static get meta(): IJSPatcherObjectMeta {\n        const thisName = this._name;\n        const superMeta = Object.getPrototypeOf(this).meta;\n        const superProps = superMeta.props;\n        const thisProps = this.props;\n        for (const key in thisProps) {\n            thisProps[key as keyof IPropsMeta<BaseObjectProps>].group = key in superProps ? superProps[key].group : thisName;\n        }\n        return {\n            package: this.package,\n            name: this._name,\n            icon: this.icon,\n            author: this.author,\n            version: this.version,\n            description: this.description,\n            inlets: [...this.inlets],\n            outlets: [...this.outlets],\n            args: [...this.args],\n            props: {\n                ...superProps,\n                ...thisProps\n            },\n            isPatcherInlet: this.isPatcherInlet,\n            isPatcherOutlet: this.isPatcherOutlet\n        };\n    }\n    isUIStateKey = (x: any) => this.meta.props[x] && this.meta.props[x].isUIState;\n    updateUIFromProps = (props: Partial<P & BaseObjectProps>) => {\n        if (props) {\n            const uiState: Partial<U & BaseUIState> = {};\n            for (const key in props) {\n                if (this.isUIStateKey(key)) uiState[key as keyof (U & BaseUIState)] = props[key] as any;\n            }\n            this.updateUI(uiState);\n        }\n    };\n    subscribe() {\n        super.subscribe();\n        this.on(\"metaUpdated\", e => this.box.emit(\"metaUpdated\", e));\n        this.on(\"argsUpdated\", e => this.box.emit(\"argsUpdated\", e));\n        this.on(\"propsUpdated\", e => this.box.emit(\"propsUpdated\", e));\n        this.on(\"dataUpdated\", e => this.box.emit(\"dataUpdated\", e));\n        this.on(\"stateUpdated\", e => this.box.emit(\"stateUpdated\", e));\n        this.on(\"updateArgs\", this.setArgs);\n        this.on(\"updateProps\", this.setProps);\n        this.on(\"updateProps\", this.updateUIFromProps);\n    }\n}\n","import type BaseObject from \"./BaseObject\";\n\nexport interface RemotedObjectEventMap {\n    \"outlet\": { outlet: number; data: any };\n}\n\n/** Generate an object that can be used in the AudioWorklet as remoted. */\nexport default <\n    D extends {} = {},\n    S extends {} = {},\n    I extends any[] = any[],\n    O extends any[] = any[],\n    A extends any[] = any[],\n    P extends {} = {},\n    U extends {} = {},\n    E extends Partial<RemotedObjectEventMap> & Record<string, any> = {}\n>(O: typeof BaseObject) => class RemotedObject extends O<D, S, I, O, A, P, U, E & RemotedObjectEventMap> {\n    get proxy() {\n        return this.patcher.state.patcherProcessor;\n    }\n    subscribe() {\n        super.subscribe();\n        const handleBoxIoCountChanged = () => {\n            const { id, inlets, outlets } = this.box;\n            this.proxy?.objectEmitFromWorklet(id, \"boxIoCountChanged\", { inlets, outlets });\n        };\n        this.box.on(\"ioCountChanged\", handleBoxIoCountChanged);\n        this.on(\"outlet\", ({ outlet, data }) => this.outlet(outlet, data));\n        this.on(\"destroy\", () => this.box.off(\"ioCountChanged\", handleBoxIoCountChanged));\n    }\n};\n","import BaseObject from \"./BaseObject\";\nimport { Func, New } from \"../importer/RemotedImporter\";\nimport getIO from \"../jsaw/index.jsdsppkg.aw\";\n\nexport default async () => ({\n    BaseObject,\n    EmptyObject: BaseObject,\n    InvalidObject: BaseObject,\n    func: Func,\n    new: New,\n    ...await getIO()\n});\n","import RemotedImporter from \"../importer/RemotedImporter\";\n\nexport default async () => RemotedImporter.import(\"globalThis\", globalThis, true);\n","import StaticMethod from \"./StaticMethod\";\nimport Method from \"./Method\";\nimport BaseObject from \"../base/BaseObject\";\nimport Bang, { isBang } from \"../base/Bang\";\nimport type ImportedObject from \"./ImportedObject\";\nimport type { IJSPatcherObjectMeta } from \"../base/AbstractObject\";\n\ntype TAnyFunction = (...args: any[]) => any;\ntype TWrapper = typeof StaticMethod | typeof Method;\ntype S = { Wrapper: TWrapper };\nexport default class Func extends BaseObject<{}, S, [Bang], [TAnyFunction], any[], {}, { loading: boolean }> {\n    static description = \"Get the function itself\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"bang\",\n        description: \"Bang to get the function itself\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"function\",\n        description: \"function\"\n    }];\n    static args: IJSPatcherObjectMeta[\"args\"] = [{\n        type: \"string\",\n        optional: false,\n        varLength: false,\n        description: \"Function name\"\n    }];\n    state: S = { Wrapper: null };\n    subscribe() {\n        super.subscribe();\n        this.on(\"postInit\", () => {\n            this.inlets = 1;\n            this.outlets = 1;\n        });\n        this.on(\"updateArgs\", (args) => {\n            if (typeof args[0] !== \"undefined\") {\n                const Wrapper = this.patcher.activeLib[args[0]];\n                if (!Wrapper) this.error(`Function ${args[0]} not found.`);\n                else if (Wrapper.prototype instanceof StaticMethod || Wrapper.prototype instanceof Method) {\n                    this.state.Wrapper = Wrapper as TWrapper;\n                } else {\n                    this.error(\"Given identifier function is not a function\");\n                }\n            } else {\n                this.error(\"A function identifier is needed.\");\n            }\n        });\n        this.on(\"inlet\", ({ data, inlet }) => {\n            if (inlet === 0) {\n                if (isBang(data)) this.output();\n            }\n        });\n    }\n    callback = () => this.outlet(0, this.imported);\n    output() {\n        return this.callback();\n    }\n    set loading(loading: boolean) {\n        this.updateUI({ loading });\n    }\n    get name() {\n        const c = this.state.Wrapper;\n        return c.path[c.path.length - 1];\n    }\n    get imported(): TAnyFunction {\n        const c = this.state.Wrapper || this.patcher.activeLib.Object as TWrapper;\n        let r: TAnyFunction;\n        try {\n            r = c.path.reduce((acc, cur) => acc[cur], c.root);\n        } catch (e) {\n            this.error(e);\n        }\n        return r;\n    }\n    set imported(v: TAnyFunction) {\n        const c = (this.constructor as typeof ImportedObject);\n        let parent = c.root;\n        try {\n            if (!c.path.length) {\n                c.root = v;\n            } else {\n                c.path.slice(0, -1).forEach(key => parent = parent[key]);\n                parent[c.path[c.path.length - 1]] = v;\n            }\n        } catch (e) {\n            this.error(e);\n        }\n    }\n}\n","import ImportedObject from \"./ImportedObject\";\nimport Bang, { isBang } from \"../base/Bang\";\nimport type { IJSPatcherObjectMeta } from \"../base/AbstractObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\ntype S<Static extends boolean> = { instance: Static extends true ? undefined : any; result: any };\ntype I<Static extends boolean> = Static extends true ? [Bang] : [any | Bang];\ntype O<Static extends boolean> = Static extends true ? [any] : [any, any];\nexport default class Getter<Static extends boolean = false> extends ImportedObject<any, S<Static>, I<Static>, O<Static>, [], { sync: boolean }, { loading: boolean }> {\n    static importedObjectType: ImportedObjectType = \"Getter\";\n    static description = \"Auto-imported getter\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"anything\",\n        description: \"Instance to read\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"anything\",\n        description: \"Value\"\n    }, {\n        type: \"anything\",\n        description: \"Instance bypass\"\n    }];\n    static props: IJSPatcherObjectMeta[\"props\"] = {\n        sync: {\n            type: \"boolean\",\n            default: false,\n            description: \"If true and in case the result is a Promise, instead of waiting for result, will output the Promise object\"\n        }\n    };\n    state: S<Static> = { instance: undefined, result: null };\n    handlePreInit = () => {\n        this.inlets = 1;\n        this.outlets = 2;\n    };\n    handleInlet = ({ data, inlet }: { data: any; inlet: number }) => {\n        if (inlet === 0) {\n            if (!isBang(data)) this.state.instance = data;\n            if (this.execute()) this.output();\n        }\n    };\n    subscribe() {\n        super.subscribe();\n        this.on(\"preInit\", this.handlePreInit);\n        this.on(\"inlet\", this.handleInlet);\n    }\n    execute() {\n        try {\n            this.state.result = this.state.instance[this.name];\n            return true;\n        } catch (e) {\n            this.error(e);\n            return false;\n        }\n    }\n    callback = () => this.outletAll([this.state.result, this.state.instance] as O<Static>);\n    output() {\n        if (this.state.result instanceof Promise && !this.getProp(\"sync\")) {\n            this.loading = true;\n            this.state.result.then((r) => {\n                this.loading = false;\n                this.state.result = r;\n                this.callback();\n            }, (r) => {\n                this.loading = false;\n                this.error(r);\n            });\n            return this;\n        }\n        return this.callback();\n    }\n    set loading(loading: boolean) {\n        this.updateUI({ loading });\n    }\n}\n","import BaseObject from \"../base/BaseObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\n/**\n* ```JavaScript\n*   class A {\n*       static a = {} // A.a\n*       static b() {} // A.b\n*       static get c() {} // A.c (get)\n*       static set d(x) {} // A.d (set)\n*       e = {} // Nothing\n*       f() {} // A.prototype.f\n*       get g() {} // A.prototype.g (get)\n*       set h(x) {} // A.prototype.h (set)\n*       constructor() {} // A.prototype.constructor\n*   }\n*   const B = {\n*       a: {}, // B.a\n*       b() {} // B.b\n*   }\n*   const C = function() {\n*       this.a = null; // C.prototype.constructor\n*   }\n* ```\n*/\n\nexport default abstract class ImportedObject<T, S, I extends any[], O extends any[], A extends any[], P, U> extends BaseObject<{}, S, I, O, A, P, U> {\n    static importedObjectType: ImportedObjectType;\n    static root: Record<string, any>;\n    static path: string[];\n    static description = \"Auto-imported object\";\n    get name() {\n        const c = (this.constructor as typeof ImportedObject);\n        return c.path[c.path.length - 1];\n    }\n    get imported(): T {\n        const c = (this.constructor as typeof ImportedObject);\n        let r: T;\n        try {\n            r = c.path.reduce((acc, cur) => acc[cur], c.root);\n        } catch (e) {\n            this.error(e);\n        }\n        return r;\n    }\n    set imported(v: T) {\n        const c = (this.constructor as typeof ImportedObject);\n        let parent = c.root;\n        try {\n            if (!c.path.length) {\n                c.root = v;\n            } else {\n                c.path.slice(0, -1).forEach(key => parent = parent[key]);\n                parent[c.path[c.path.length - 1]] = v;\n            }\n        } catch (e) {\n            this.error(e);\n        }\n    }\n}\nexport class AnyImportedObject extends ImportedObject<any, any, any, any, any, any, any> {}\n","import { ImporterDirSelfObject } from \"../../../utils/symbols\";\nimport { getPropertyDescriptors } from \"../../../utils/utils\";\nimport { IJSPatcherObject, isJSPatcherObjectConstructor } from \"../base/AbstractObject\";\nimport type { TPackage } from \"../../types\";\n\nexport default abstract class Importer {\n    static $self = ImporterDirSelfObject;\n    static getObject(p: PropertyDescriptor, pkgName: string, root: Record<string, any>, path: string[]): typeof IJSPatcherObject {\n        throw new Error(\"getObject not implemented\");\n    }\n    /*\n    static async test() {\n        await Importer.importFrom(\"https://unpkg.com/@tensorflow/tfjs\", \"tf\").then(console.log);\n        await Importer.importFrom(\"https://unpkg.com/three\", \"THREE\").then(console.log);\n        await Importer.importFrom(\"https://unpkg.com/webmidi\", \"MIDI\").then(console.log);\n    }\n    */\n    static writeInPath(pkgIn: TPackage, pathIn: string[], object: typeof IJSPatcherObject) {\n        if (pathIn.length === 0) {\n            Object.assign(pkgIn, { [this.$self]: object });\n            return;\n        }\n        const path = pathIn.slice();\n        let pkg = pkgIn;\n        while (path.length > 1) {\n            const key = path.shift();\n            if (!pkg[key]) pkg[key] = {};\n            else if (isJSPatcherObjectConstructor(pkg[key])) pkg[key] = { [this.$self]: pkg[key] };\n            pkg = pkg[key] as TPackage;\n        }\n        pkg[path[0]] = object;\n    }\n    /**\n     * Recursive transform JavaScript object to JSPatcher Package\n     *\n     * @param {string} pkgName package identifier\n     * @param {Record<string, any>} root imported JavaScript object\n     * @param {boolean} [all] import non-iterables\n     * @param {TPackage} [outIn]\n     * @param {string[]} [pathIn]\n     * @param {any[]} [stackIn]\n     * @param {number} [depthIn]\n     */\n    static import(pkgName: string, root: Record<string, any>, all?: boolean, outIn?: TPackage, pathIn?: string[], stackIn?: any[], depthIn?: number) {\n        const depth = typeof depthIn === \"undefined\" ? 0 : depthIn;\n        const out = outIn || {};\n        const path = pathIn || [];\n        const stack = stackIn ? stackIn.slice() : [];\n        let o: any;\n        try {\n            o = path.reduce((acc, cur) => acc[cur], root);\n        } catch (e) {\n            return out;\n        }\n        if (typeof o === \"undefined\" || o === null || stack.indexOf(o) !== -1 || (depth && o === globalThis) || o === (globalThis as any).jspatcherEnv) return out; // cyclic object\n        stack[depth] = o;\n        let props: Record<string, TypedPropertyDescriptor<any> | PropertyDescriptor>;\n        try { // mitigate opener.location.href error\n            props = getPropertyDescriptors(o);\n        } catch (e) {\n            return out;\n        }\n        if (path.length === 0) {\n            const newObj = this.getObject({ value: root }, pkgName, root, []);\n            if (newObj) this.writeInPath(out, [], newObj);\n        }\n        for (const key in props) {\n            if (typeof o === \"function\" && [\"arguments\", \"caller\", \"length\", \"name\", \"__proto__\"].indexOf(key) >= 0) continue;\n            if (typeof o === \"object\" && [\"constructor\", \"__proto__\"].indexOf(key) >= 0) continue;\n            const prop = props[key];\n            const newPath = [...path, key];\n            if (!all && !prop.enumerable && key.startsWith(\"_\") && key !== \"prototype\") continue;\n            const newObj = this.getObject(prop, pkgName, root, newPath);\n            if (newObj) this.writeInPath(out, newPath.map((s, i) => (i !== newPath.length - 1 && s === \"prototype\" ? \"\" : s)), newObj);\n            const value = prop.value;\n            if ((typeof value === \"object\" || typeof value === \"function\") && value !== null && (value === Array.prototype || !Array.isArray(value))) {\n                this.import(pkgName, root, all, out, newPath, stack, depth + 1);\n            }\n        }\n        return out;\n    }\n}\n","import ImportedObject from \"./ImportedObject\";\nimport Bang, { isBang } from \"../base/Bang\";\nimport type { IJSPatcherObjectMeta, IPropsMeta } from \"../base/AbstractObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\ntype TAnyFunction = (...args: any[]) => any;\ntype S<Static extends boolean> = { instance: Static extends true ? undefined : any; inputs: any[]; result: any };\ntype I<Static extends boolean> = Static extends true ? [any | Bang, ...any[]] : [any | Bang, any, ...any[]];\ntype O<Static extends boolean> = Static extends true ? [any, ...any[]] : [any, any, ...any[]];\ninterface P {\n    args: number;\n    spreadArgs: boolean;\n    sync: boolean;\n}\n\nexport default class Method<Static extends boolean = false> extends ImportedObject<TAnyFunction, S<Static>, I<Static>, O<Static>, any[], P, { loading: boolean }> {\n    static importedObjectType: ImportedObjectType = \"Method\";\n    static description = \"Auto-imported method\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"anything\",\n        description: \"Instance to read\"\n    }, {\n        isHot: false,\n        type: \"anything\",\n        varLength: true,\n        description: \"Method argument\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"anything\",\n        description: \"Method return value\"\n    }, {\n        type: \"anything\",\n        description: \"Instance bypass\"\n    }, {\n        type: \"anything\",\n        varLength: true,\n        description: \"Argument after method called\"\n    }];\n    static args: IJSPatcherObjectMeta[\"args\"] = [{\n        type: \"anything\",\n        optional: true,\n        varLength: true,\n        description: \"Set arguments while loaded\"\n    }];\n    static props: IPropsMeta<P> = {\n        args: {\n            type: \"number\",\n            default: 0,\n            description: \"arguments count for method\"\n        },\n        spreadArgs: {\n            type: \"boolean\",\n            default: false,\n            description: \"arguments input will be spreaded if true\"\n        },\n        sync: {\n            type: \"boolean\",\n            default: false,\n            description: \"If true and in case the result is a Promise, instead of waiting for result, will output the Promise object\"\n        }\n    };\n    state: S<Static> = { instance: undefined, inputs: [], result: null };\n    initialInlets = 1;\n    initialOutlets = 2;\n    handleInlet = ({ data, inlet }: { data: any; inlet: number }) => {\n        if (inlet === 0) {\n            if (!isBang(data)) this.state.instance = data;\n            if (this.execute()) this.output();\n        } else {\n            this.state.inputs[inlet - 1] = data;\n        }\n    };\n    subscribe() {\n        super.subscribe();\n        this.on(\"postInit\", () => {\n            const fn = this.imported;\n            const argsCount = Math.max(fn.length, this.box.args.length, ~~+this.getProp(\"args\"));\n            this.inlets = Math.max(1, this.initialInlets + argsCount);\n            this.outlets = this.initialOutlets + argsCount;\n        });\n        this.on(\"updateArgs\", (args) => {\n            this.state.inputs = args.slice();\n            const fn = this.imported;\n            const argsCount = Math.max(fn.length, args.length, ~~+this.getProp(\"args\"));\n            this.inlets = Math.max(1, this.initialInlets + argsCount);\n            this.outlets = this.initialOutlets + argsCount;\n        });\n        this.on(\"updateProps\", (props) => {\n            if (props.args && typeof props.args === \"number\" && props.args >= 0) {\n                const fn = this.imported;\n                const argsCount = Math.max(fn.length, this.box.args.length, ~~props.args);\n                this.inlets = Math.max(1, this.initialInlets + argsCount);\n                this.outlets = this.initialOutlets + argsCount;\n            }\n        });\n        this.on(\"inlet\", this.handleInlet);\n    }\n    execute() {\n        const fn = this.imported;\n        try {\n            this.state.result = fn.call(this.state.instance, ...(this.getProp(\"spreadArgs\") ? this.state.inputs.reduce<any[]>((acc, cur) => [...acc, ...cur], []) : this.state.inputs));\n            return true;\n        } catch (e) {\n            this.error(e);\n            return false;\n        }\n    }\n    callback = () => this.outletAll([this.state.result, this.state.instance, ...this.state.inputs] as O<Static>);\n    output() {\n        if (this.state.result instanceof Promise && !this.getProp(\"sync\")) {\n            this.loading = true;\n            this.state.result.then((r) => {\n                this.loading = false;\n                this.state.result = r;\n                this.callback();\n            }, (r) => {\n                this.loading = false;\n                this.error(r);\n            });\n            return this;\n        }\n        return this.callback();\n    }\n    set loading(loading: boolean) {\n        this.updateUI({ loading });\n    }\n}\n","import StaticMethod from \"./StaticMethod\";\nimport BaseObject from \"../base/BaseObject\";\nimport Bang, { isBang } from \"../base/Bang\";\nimport type ImportedObject from \"./ImportedObject\";\nimport type { IJSPatcherObjectMeta, IPropsMeta } from \"../base/AbstractObject\";\n\ntype TAnyConstructor = new (...args: any[]) => any;\ninterface P {\n    args: number;\n    spreadArgs: boolean;\n}\ninterface S {\n    Wrapper: typeof StaticMethod;\n    inputs: any[];\n    result: any;\n}\n\nexport default class New extends BaseObject<{}, S, [any | Bang, ...any[]], [any, ...any[]], any[], P, { loading: boolean }> {\n    static description = \"Call function as a constructor\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"anything\",\n        description: \"Constructor argument, output instance constructed\"\n    }, {\n        isHot: false,\n        type: \"anything\",\n        varLength: true,\n        description: \"Constructor argument\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"anything\",\n        description: \"Instance constructed\"\n    }, {\n        type: \"anything\",\n        varLength: true,\n        description: \"Argument after constructor called\"\n    }];\n    static args: IJSPatcherObjectMeta[\"args\"] = [{\n        type: \"string\",\n        optional: false,\n        varLength: false,\n        description: \"Constructor name\"\n    }, {\n        type: \"anything\",\n        optional: true,\n        varLength: true,\n        description: \"Set arguments while loaded\"\n    }];\n    static props: IPropsMeta<P> = {\n        args: {\n            type: \"number\",\n            default: 0,\n            description: \"arguments count for method\"\n        },\n        spreadArgs: {\n            type: \"boolean\",\n            default: false,\n            description: \"arguments input will be spreaded if true\"\n        }\n    };\n    state: S = { Wrapper: null, inputs: [], result: null };\n    subscribe() {\n        super.subscribe();\n        this.on(\"postInit\", () => {\n            const Fn = this.imported;\n            const argsCount = Math.max(Fn.length, this.box.args.length - 1, ~~+this.getProp(\"args\"));\n            this.inlets = Math.max(1, argsCount);\n            this.outlets = 1 + this.inlets;\n        });\n        this.on(\"updateArgs\", (args) => {\n            if (typeof args[0] !== \"undefined\") {\n                const Wrapper = this.patcher.activeLib[args[0]];\n                if (!Wrapper) this.error(`Function ${args[0]} not found.`);\n                else if (Wrapper.prototype instanceof StaticMethod) {\n                    this.state.Wrapper = Wrapper as typeof StaticMethod;\n                    const Fn = this.imported;\n                    const argsCount = Math.max(Fn.length, args.length - 1, ~~+this.getProp(\"args\"));\n                    this.inlets = Math.max(1, argsCount);\n                    this.outlets = 1 + this.inlets;\n                } else {\n                    this.error(\"Given function is not constructable\");\n                }\n            } else {\n                this.error(\"A constructor is needed.\");\n            }\n            this.state.inputs = args.slice(1);\n        });\n        this.on(\"updateProps\", (props) => {\n            if (props.args && typeof props.args === \"number\" && props.args >= 0) {\n                const Fn = this.imported;\n                const argsCount = Math.max(Fn.length, this.box.args.length - 1, ~~+props.args);\n                this.inlets = Math.max(1, argsCount);\n                this.outlets = 1 + this.inlets;\n            }\n        });\n        this.on(\"inlet\", ({ data, inlet }) => {\n            if (inlet === 0) {\n                if (!isBang(data)) this.state.inputs[inlet] = data;\n                if (this.execute()) this.output();\n            } else {\n                this.state.inputs[inlet] = data;\n            }\n        });\n    }\n    execute() {\n        const Fn = this.imported;\n        try {\n            this.state.result = new Fn(...(this.getProp(\"spreadArgs\") ? this.state.inputs.reduce<any[]>((acc, cur) => [...acc, ...cur], []) : this.state.inputs));\n            return true;\n        } catch (e) {\n            this.error(e);\n            return false;\n        }\n    }\n    callback = () => this.outletAll([this.state.result, ...this.state.inputs]);\n    output() {\n        return this.callback();\n    }\n    set loading(loading: boolean) {\n        this.updateUI({ loading });\n    }\n    get name() {\n        const c = this.state.Wrapper;\n        return c.path[c.path.length - 1];\n    }\n    get imported(): TAnyConstructor {\n        const c = this.state.Wrapper || this.patcher.activeLib.Object as typeof StaticMethod;\n        let r: TAnyConstructor;\n        try {\n            r = c.path.reduce((acc, cur) => acc[cur], c.root);\n        } catch (e) {\n            this.error(e);\n        }\n        return r;\n    }\n    set imported(v: TAnyConstructor) {\n        const c = (this.constructor as typeof ImportedObject);\n        let parent = c.root;\n        try {\n            if (!c.path.length) {\n                c.root = v;\n            } else {\n                c.path.slice(0, -1).forEach(key => parent = parent[key]);\n                parent[c.path[c.path.length - 1]] = v;\n            }\n        } catch (e) {\n            this.error(e);\n        }\n    }\n}\n","import ImportedObject from \"./ImportedObject\";\nimport Bang, { isBang } from \"../base/Bang\";\nimport type { IJSPatcherObjectMeta } from \"../base/AbstractObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\ntype S<Static extends boolean> = { instance: Static extends true ? undefined : any };\ntype I<Static extends boolean> = Static extends true ? [Bang, any] : [any | Bang, any];\ntype O<Static extends boolean> = Static extends true ? [any] : [any, any];\ntype A<Static extends boolean> = Static extends true ? [any] : [];\n\nexport default class Property<Static extends boolean = false> extends ImportedObject<any, S<Static>, I<Static>, O<Static>, A<Static>, {}, {}> {\n    static importedObjectType: ImportedObjectType = \"Property\";\n    static description = \"Auto-imported property\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"anything\",\n        description: \"Constructor argument, output instance constructed\"\n    }, {\n        isHot: false,\n        type: \"anything\",\n        varLength: true,\n        description: \"Constructor argument\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"anything\",\n        description: \"Value\"\n    }, {\n        type: \"anything\",\n        description: \"Instance bypass\"\n    }];\n    state: S<Static> = { instance: undefined };\n    handlePreInit = () => {\n        this.inlets = 2;\n        this.outlets = 2;\n    };\n    handleInlet = ({ data, inlet }: { data: any; inlet: number }) => {\n        if (inlet === 0) {\n            if (!isBang(data)) this.state.instance = data;\n            let result;\n            try {\n                result = this.state.instance[this.name];\n            } catch (e) {\n                this.error(e);\n            }\n            this.outletAll([result, this.state.instance] as O<Static>);\n        } else if (inlet === 1) {\n            try {\n                this.state.instance[this.name] = data;\n            } catch (e) {\n                this.error(e);\n            }\n        }\n    };\n    subscribe() {\n        super.subscribe();\n        this.on(\"preInit\", this.handlePreInit);\n        this.on(\"inlet\", this.handleInlet);\n    }\n}\n","import NewBase from \"./New\";\nimport FuncBase from \"./Func\";\nimport PropertyBase from \"./Property\";\nimport GetterBase from \"./Getter\";\nimport SetterBase from \"./Setter\";\nimport SetterGetterBase from \"./SetterGetter\";\nimport MethodBase from \"./Method\";\nimport StaticPropertyBase from \"./StaticProperty\";\nimport StaticGetterBase from \"./StaticGetter\";\nimport StaticSetterBase from \"./StaticSetter\";\nimport StaticSetterGetterBase from \"./StaticSetterGetter\";\nimport StaticMethodBase from \"./StaticMethod\";\nimport generateRemotedObject from \"../base/generateRemotedObject\";\nimport Importer from \"./Importer\";\nimport type BaseObject from \"../base/BaseObject\";\nimport type { IJSPatcherObject } from \"../base/AbstractObject\";\n\nexport class New extends generateRemotedObject(NewBase as typeof BaseObject) {\n}\nexport class Func extends generateRemotedObject(FuncBase as typeof BaseObject) {\n}\nexport class Property extends generateRemotedObject(PropertyBase as typeof BaseObject) {\n}\nexport class Getter extends generateRemotedObject(GetterBase as typeof BaseObject) {\n}\nexport class Setter extends generateRemotedObject(SetterBase as typeof BaseObject) {\n}\nexport class SetterGetter extends generateRemotedObject(SetterGetterBase as typeof BaseObject) {\n}\nexport class Method extends generateRemotedObject(MethodBase as typeof BaseObject) {\n}\nexport class StaticProperty extends generateRemotedObject(StaticPropertyBase as typeof BaseObject) {\n}\nexport class StaticGetter extends generateRemotedObject(StaticGetterBase as typeof BaseObject) {\n}\nexport class StaticSetter extends generateRemotedObject(StaticSetterBase as typeof BaseObject) {\n}\nexport class StaticSetterGetter extends generateRemotedObject(StaticSetterGetterBase as typeof BaseObject) {\n}\nexport class StaticMethod extends generateRemotedObject(StaticMethodBase as typeof BaseObject) {\n}\n\nexport default class DefaultImporter extends Importer {\n    static getObject(p: PropertyDescriptor, pkgName: string, root: Record<string, any>, path: string[]): typeof IJSPatcherObject {\n        const isStatic = path[path.length - 2] !== \"prototype\";\n        let Super: typeof IJSPatcherObject;\n        const type = typeof p.value;\n        if (type === \"function\") {\n            if (isStatic) Super = StaticMethod;\n            else Super = Method;\n        } else if (type === \"undefined\") {\n            const setter = p.set;\n            const getter = p.get;\n            if (isStatic) {\n                if (setter && getter) Super = StaticSetterGetter;\n                else if (setter) Super = StaticSetter;\n                else if (getter) Super = StaticGetter;\n                else return null;\n            } else {\n                if (setter && getter) Super = SetterGetter;\n                else if (setter) Super = Setter;\n                else if (getter) Super = Getter;\n                else return null;\n            }\n        } else {\n            if (isStatic) Super = StaticProperty;\n            else Super = Property;\n        }\n        return class extends Super {\n            static package = pkgName;\n            static root = root;\n            static path = path;\n            static get _name() { return path[path.length - 1] || pkgName; }\n        };\n    }\n}\n","import ImportedObject from \"./ImportedObject\";\nimport Bang, { isBang } from \"../base/Bang\";\nimport type { IJSPatcherObjectMeta } from \"../base/AbstractObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\ntype S<Static extends boolean> = { instance: Static extends true ? undefined : any; input: any };\ntype I<Static extends boolean> = Static extends true ? [any] : [any | Bang, any];\ntype O<Static extends boolean> = Static extends true ? [] : [any];\n\nexport default class Setter<Static extends boolean = false> extends ImportedObject<any, S<Static>, I<Static>, O<Static>, [any], {}, {}> {\n    static importedObjectType: ImportedObjectType = \"Setter\";\n    static description = \"Auto-imported setter\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"anything\",\n        description: \"Instance to set property\"\n    }, {\n        isHot: false,\n        type: \"anything\",\n        description: \"Set the value\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"anything\",\n        description: \"Instance bypass\"\n    }];\n    static args: IJSPatcherObjectMeta[\"args\"] = [{\n        type: \"anything\",\n        optional: true,\n        varLength: false,\n        description: \"Initial value to set\"\n    }];\n    initialInlets = 2;\n    initialOutlets = 1;\n    state: S<Static> = { instance: undefined, input: null };\n    handleInlet = ({ data, inlet }: { data: any; inlet: number }) => {\n        if (inlet === 0) {\n            if (!isBang(data)) this.state.instance = data;\n            if (typeof this.state.instance === \"undefined\") return;\n            try {\n                this.state.instance[this.name] = this.state.input;\n            } catch (e) {\n                this.error(e);\n                return;\n            }\n            this.outlet(0, this.state.instance);\n        } else {\n            this.state.input = data;\n        }\n    };\n    handleUpdateArgs = (args: [any?]) => {\n        if (args.length) this.state.input = args[0];\n    };\n    subscribe() {\n        super.subscribe();\n        this.on(\"preInit\", () => {\n            this.inlets = this.initialInlets;\n            this.outlets = this.initialOutlets;\n        });\n        this.on(\"updateArgs\", this.handleUpdateArgs);\n        this.on(\"inlet\", this.handleInlet);\n    }\n}\n","import ImportedObject from \"./ImportedObject\";\nimport Bang, { isBang } from \"../base/Bang\";\nimport type { IJSPatcherObjectMeta } from \"../base/AbstractObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\ntype S<Static extends boolean> = { instance: Static extends true ? undefined : any; input: any; result: any };\ntype I<Static extends boolean> = Static extends true ? [any] : [any | Bang, any];\ntype O<Static extends boolean> = Static extends true ? [any] : [any, any];\n\nexport default class SetterGetter<Static extends boolean = false> extends ImportedObject<any, S<Static>, I<Static>, O<Static>, [any], { sync: boolean }, { loading: boolean }> {\n    static importedObjectType: ImportedObjectType = \"SetterGetter\";\n    static description = \"Auto-imported setter / getter\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"anything\",\n        description: \"Instance to manipulate\"\n    }, {\n        isHot: false,\n        type: \"anything\",\n        description: \"Set the value\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"anything\",\n        description: \"Value\"\n    }, {\n        type: \"anything\",\n        description: \"Instance bypass\"\n    }];\n    static args: IJSPatcherObjectMeta[\"args\"] = [{\n        type: \"anything\",\n        optional: true,\n        varLength: false,\n        description: \"Initial value to set\"\n    }];\n    static props: IJSPatcherObjectMeta[\"props\"] = {\n        sync: {\n            type: \"boolean\",\n            default: false,\n            description: \"If true and in case the result is a Promise, instead of waiting for result, will output the Promise object\"\n        }\n    };\n    initialInlets = 2;\n    initialOutlets = 2;\n    state: S<Static> = { instance: undefined, input: null, result: null };\n    handleInlet = ({ data, inlet }: { data: any; inlet: number }) => {\n        if (inlet === 0) {\n            if (!isBang(data)) this.state.instance = data;\n            if (typeof this.state.instance === \"undefined\") return;\n            if (typeof this.state.input !== \"undefined\") {\n                try {\n                    this.state.instance[this.name] = this.state.input;\n                } catch (e) {\n                    this.error(e);\n                    return;\n                }\n            }\n            if (this.execute()) this.output();\n        } else if (inlet === 1) {\n            this.state.input = data;\n        }\n    };\n    subscribe() {\n        super.subscribe();\n        this.on(\"preInit\", () => {\n            this.inlets = this.initialInlets;\n            this.outlets = this.initialOutlets;\n        });\n        this.on(\"updateArgs\", (args) => {\n            if (args.length) this.state.input = args[0];\n        });\n        this.on(\"inlet\", this.handleInlet);\n    }\n    execute() {\n        try {\n            this.state.result = this.state.instance[this.name];\n            return true;\n        } catch (e) {\n            this.error(e);\n            return false;\n        }\n    }\n    callback = () => this.outletAll([this.state.result, this.state.instance] as O<Static>);\n    output() {\n        if (this.state.result instanceof Promise && !this.getProp(\"sync\")) {\n            this.loading = true;\n            this.state.result.then((r) => {\n                this.loading = false;\n                this.state.result = r;\n                this.callback();\n            }, (r) => {\n                this.loading = false;\n                this.error(r);\n            });\n            return this;\n        }\n        return this.callback();\n    }\n    set loading(loading: boolean) {\n        this.updateUI({ loading });\n    }\n}\n","import Getter from \"./Getter\";\nimport { isBang } from \"../base/Bang\";\nimport type { IJSPatcherObjectMeta } from \"../base/AbstractObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\nexport default class StaticGetter extends Getter<true> {\n    static importedObjectType: ImportedObjectType = \"StaticGetter\";\n    static description = \"Auto-imported static getter\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"bang\",\n        description: \"Get the value\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"anything\",\n        description: \"Value\"\n    }];\n    handlePreInit = () => {\n        this.inlets = 1;\n        this.outlets = 1;\n    };\n    handleInlet = ({ data, inlet }: { data: any; inlet: number }) => {\n        if (inlet === 0 && isBang(data) && this.execute()) this.output();\n    };\n    execute() {\n        try {\n            this.state.result = this.imported;\n            return true;\n        } catch (e) {\n            this.error(e);\n            return false;\n        }\n    }\n    callback = () => this.outlet(0, this.state.result);\n}\n","import Method from \"./Method\";\nimport { ImportedStaticMethodObject } from \"../../../utils/symbols\";\nimport { isBang } from \"../base/Bang\";\nimport type { IJSPatcherObjectMeta } from \"../base/AbstractObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\nexport default class StaticMethod extends Method<true> {\n    static importedObjectType: ImportedObjectType = \"StaticMethod\";\n    static [ImportedStaticMethodObject] = true;\n    static description = \"Auto-imported static method\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"anything\",\n        varLength: true,\n        description: \"Method argument\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"anything\",\n        description: \"Method return value\"\n    }, {\n        type: \"anything\",\n        varLength: true,\n        description: \"Argument after method called\"\n    }];\n    initialInlets = 0;\n    initialOutlets = 1;\n    handleInlet = ({ data, inlet }: { data: any; inlet: number }) => {\n        if (inlet === 0) {\n            if (!isBang(data)) this.state.inputs[inlet] = data;\n            if (this.execute()) this.output();\n        } else {\n            this.state.inputs[inlet] = data;\n        }\n    };\n    execute() {\n        const fn = this.imported;\n        try {\n            this.state.result = fn(...(this.getProp(\"spreadArgs\") ? this.state.inputs.reduce<any[]>((acc, cur) => [...acc, ...cur], []) : this.state.inputs));\n            return true;\n        } catch (e) {\n            this.error(e);\n            return false;\n        }\n    }\n    callback = () => this.outletAll([this.state.result, ...this.state.inputs]);\n}\n","import Property from \"./Property\";\nimport { isBang } from \"../base/Bang\";\nimport type { IJSPatcherObjectMeta } from \"../base/AbstractObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\nexport default class StaticProperty extends Property<true> {\n    static importedObjectType: ImportedObjectType = \"StaticProperty\";\n    static description = \"Auto-imported static property\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"bang\",\n        description: \"Get the value\"\n    }, {\n        isHot: false,\n        type: \"anything\",\n        description: \"Set the value\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"anything\",\n        description: \"Value\"\n    }];\n    static args: IJSPatcherObjectMeta[\"args\"] = [{\n        type: \"anything\",\n        optional: true,\n        description: \"Set the value while loaded.\"\n    }];\n    handlePreInit = () => {\n        this.inlets = 2;\n        this.outlets = 1;\n    };\n    handleInlet = ({ data, inlet }: { data: any; inlet: number }) => {\n        if (inlet === 0) {\n            if (isBang(data)) this.outlet(0, this.imported);\n        } else if (inlet === 1) {\n            this.imported = data;\n        }\n    };\n    subscribe() {\n        super.subscribe();\n        this.on(\"updateArgs\", (args) => {\n            if (args.length) this.imported = args[0];\n        });\n        this.on(\"inlet\", this.handleInlet);\n    }\n}\n","import Setter from \"./Setter\";\nimport type { IJSPatcherObjectMeta } from \"../base/AbstractObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\nexport default class StaticSetter extends Setter<true> {\n    static importedObjectType: ImportedObjectType = \"StaticSetter\";\n    static description = \"Auto-imported static setter\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: false,\n        type: \"anything\",\n        description: \"Set the value\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [];\n    initialInlets = 1;\n    initialOutlets = 0;\n    handleInlet = ({ data, inlet }: { data: any; inlet: number }) => {\n        if (inlet === 0) this.imported = data;\n    };\n    handleUpdateArgs = (args: [any?]) => {\n        if (args.length) this.imported = args[0];\n    };\n}\n","import SetterGetter from \"./SetterGetter\";\nimport { isBang } from \"../base/Bang\";\nimport type { IJSPatcherObjectMeta } from \"../base/AbstractObject\";\nimport type { ImportedObjectType } from \"../../types\";\n\nexport default class StaticSetterGetter extends SetterGetter<true> {\n    static importedObjectType: ImportedObjectType = \"StaticSetterGetter\";\n    static description = \"Auto-imported static setter / getter\";\n    static inlets: IJSPatcherObjectMeta[\"inlets\"] = [{\n        isHot: true,\n        type: \"bang\",\n        description: \"Get the value\"\n    }, {\n        isHot: false,\n        type: \"anything\",\n        description: \"Set the value\"\n    }];\n    static outlets: IJSPatcherObjectMeta[\"outlets\"] = [{\n        type: \"anything\",\n        description: \"Value\"\n    }];\n    initialInlets = 2;\n    initialOutlets = 1;\n    handleInlet = ({ data, inlet }: { data: any; inlet: number }) => {\n        if (inlet === 0) {\n            if (!isBang(data)) return;\n            if (typeof this.state.input !== \"undefined\") {\n                try {\n                    this.imported = this.state.input;\n                } catch (e) {\n                    this.error(e);\n                    return;\n                }\n            }\n            if (this.execute()) this.output();\n        } else if (inlet === 1) {\n            this.state.input = data;\n        }\n    };\n    execute() {\n        try {\n            this.state.result = this.imported;\n            return true;\n        } catch (e) {\n            this.error(e);\n            return false;\n        }\n    }\n    callback = () => this.outlet(0, this.state.result);\n}\n","import BaseObject from \"../base/BaseObject\";\nimport type { IArgsMeta, IOutletsMeta, IPropsMeta } from \"../base/AbstractObject\";\nimport type { PatcherEventMap } from \"../../patcher/Patcher\";\n\ninterface P {\n    description: string;\n}\n\nexport default class AudioIn extends BaseObject<{}, {}, [], [number, number], [number], P> {\n    static isPatcherInlet = \"audio\" as const;\n    static description = \"Patcher inlet (audio)\";\n    static args: IArgsMeta = [{\n        type: \"number\",\n        optional: false,\n        default: 1,\n        description: \"Inlet index (1-based)\"\n    }];\n    static props: IPropsMeta<P> = {\n        description: {\n            type: \"string\",\n            default: \"\",\n            description: \"Description text\"\n        }\n    };\n    static outlets: IOutletsMeta = [{\n        type: \"number\",\n        description: \"Sample value\"\n    }, {\n        type: \"number\",\n        description: \"Sample index\"\n    }];\n    protected get index() {\n        return Math.max(1, ~~this.box.args[0] || 1);\n    }\n    protected _ = { index: this.index };\n    protected handlePatcherInput = ({ input, index, sample }: PatcherEventMap[\"audioInput\"]) => {\n        if (input === this.index - 1) this.outletAll([sample, index]);\n    };\n    protected emitPatcherChangeIO = () => this.patcher.changeIO();\n    subscribe() {\n        super.subscribe();\n        this.on(\"metaUpdated\", this.emitPatcherChangeIO);\n        this.on(\"preInit\", () => {\n            this.inlets = 0;\n            this.outlets = 2;\n        });\n        this.on(\"postInit\", this.emitPatcherChangeIO);\n        this.on(\"updateArgs\", () => {\n            const { index } = this;\n            if (index !== this._.index) {\n                this._.index = index;\n                this.patcher.changeIO();\n            }\n        });\n        this.on(\"updateProps\", (props) => {\n            const outlet0 = { ...this.meta.outlets[0] };\n            if (typeof props.description === \"string\") outlet0.description = props.description;\n            this.setMeta({ outlets: [outlet0] });\n            this.emitPatcherChangeIO();\n        });\n        if (this.env.thread === \"AudioWorklet\") this.patcher.on(\"audioInput\", this.handlePatcherInput);\n        this.on(\"destroy\", () => {\n            this.patcher.off(\"audioInput\", this.handlePatcherInput);\n            this.patcher.changeIO();\n        });\n    }\n}\n","import BaseObject from \"../base/BaseObject\";\nimport type { IArgsMeta, IInletsMeta, IPropsMeta } from \"../base/AbstractObject\";\n\ninterface P {\n    description: string;\n}\n\nexport default class AudioOut extends BaseObject<{}, {}, [], [number, number], [number, number], P> {\n    static isPatcherOutlet = \"audio\" as const;\n    static description = \"Patcher outlet (audio)\";\n    static args: IArgsMeta = [{\n        type: \"number\",\n        optional: false,\n        default: 1,\n        description: \"Inlet index (1-based)\"\n    }];\n    static props: IPropsMeta<P> = {\n        description: {\n            type: \"string\",\n            default: \"\",\n            description: \"Description text\"\n        }\n    };\n    static inlets: IInletsMeta = [{\n        isHot: true,\n        type: \"anything\",\n        description: \"\"\n    }];\n    protected get index() {\n        return Math.max(1, ~~this.box.args[0] || 1);\n    }\n    protected _ = { index: this.index, sampleIndex: 0 };\n    protected emitPatcherChangeIO = () => this.patcher.changeIO();\n    subscribe() {\n        super.subscribe();\n        this.on(\"metaUpdated\", this.emitPatcherChangeIO);\n        this.on(\"preInit\", () => {\n            this.inlets = 2;\n            this.outlets = 0;\n        });\n        this.on(\"postInit\", this.emitPatcherChangeIO);\n        this.on(\"updateArgs\", () => {\n            const { index } = this;\n            if (index !== this._.index) {\n                this._.index = index;\n                this.patcher.changeIO();\n            }\n        });\n        this.on(\"updateProps\", (props) => {\n            const inlet0 = { ...this.meta.inlets[0] };\n            if (typeof props.description === \"string\") inlet0.description = props.description;\n            this.setMeta({ inlets: [inlet0] });\n            this.emitPatcherChangeIO();\n        });\n        this.on(\"inlet\", ({ data, inlet }) => {\n            if (inlet === 1) this._.sampleIndex = +~~data;\n            else if (inlet === 0) this.patcher.outputAudio(this.index - 1, this._.sampleIndex, +data);\n        });\n        this.on(\"destroy\", this.emitPatcherChangeIO);\n    }\n}\n","import BaseObject from \"../base/BaseObject\";\nimport type { IArgsMeta, IOutletsMeta, IPropsMeta, TMetaType } from \"../base/AbstractObject\";\nimport type { PatcherEventMap } from \"../../patcher/Patcher\";\n\ninterface P {\n    description: string;\n    type: Exclude<TMetaType, \"signal\" | \"enum\">;\n}\n\nexport default class In extends BaseObject<{}, {}, [], [any], [number], P> {\n    static isPatcherInlet = \"data\" as const;\n    static description = \"Patcher inlet (data)\";\n    static args: IArgsMeta = [{\n        type: \"number\",\n        optional: false,\n        default: 1,\n        description: \"Inlet index (1-based)\"\n    }];\n    static props: IPropsMeta<P> = {\n        description: {\n            type: \"string\",\n            default: \"\",\n            description: \"Description text\"\n        },\n        type: {\n            type: \"enum\",\n            enums: [\"string\", \"number\", \"boolean\", \"object\", \"function\", \"anything\", \"bang\", \"color\"],\n            default: \"anything\",\n            description: \"Inlet data type\"\n        }\n    };\n    static outlets: IOutletsMeta = [{\n        type: \"anything\",\n        description: \"\"\n    }];\n    protected get index() {\n        return Math.max(1, ~~this.box.args[0] || 1);\n    }\n    protected _ = { index: this.index };\n    protected handlePatcherInput = ({ data, inlet }: PatcherEventMap[\"dataInput\"]) => {\n        if (inlet === this.index - 1) this.outlet(0, data);\n    };\n    protected emitPatcherChangeIO = () => this.patcher.changeIO();\n    subscribe() {\n        super.subscribe();\n        this.on(\"metaUpdated\", this.emitPatcherChangeIO);\n        this.on(\"preInit\", () => {\n            this.inlets = 0;\n            this.outlets = 1;\n        });\n        this.on(\"postInit\", this.emitPatcherChangeIO);\n        this.on(\"updateArgs\", () => {\n            const { index } = this;\n            if (index !== this._.index) {\n                this._.index = index;\n                this.patcher.changeIO();\n            }\n        });\n        this.on(\"updateProps\", (props) => {\n            const outlet0 = { ...this.meta.outlets[0] };\n            if (typeof props.description === \"string\") outlet0.description = props.description;\n            if (typeof props.type === \"string\") outlet0.type = props.type || \"anything\";\n            this.setMeta({ outlets: [outlet0] });\n            this.emitPatcherChangeIO();\n        });\n        if (this.env.thread === \"AudioWorklet\") this.patcher.on(\"dataInput\", this.handlePatcherInput);\n        this.on(\"destroy\", () => {\n            this.patcher.off(\"dataInput\", this.handlePatcherInput);\n            this.patcher.changeIO();\n        });\n    }\n}\n","import BaseObject from \"../base/BaseObject\";\nimport type { IArgsMeta, IInletsMeta, IPropsMeta, TMetaType } from \"../base/AbstractObject\";\n\ninterface P {\n    description: string;\n    type: Exclude<TMetaType, \"signal\" | \"enum\">;\n}\n\nexport default class Out extends BaseObject<{}, {}, [], [any], [number], P> {\n    static isPatcherOutlet = \"data\" as const;\n    static description = \"Patcher outlet (data)\";\n    static args: IArgsMeta = [{\n        type: \"number\",\n        optional: false,\n        default: 1,\n        description: \"Inlet index (1-based)\"\n    }];\n    static props: IPropsMeta<P> = {\n        description: {\n            type: \"string\",\n            default: \"\",\n            description: \"Description text\"\n        },\n        type: {\n            type: \"enum\",\n            enums: [\"string\", \"number\", \"boolean\", \"object\", \"function\", \"anything\", \"bang\", \"color\"],\n            default: \"anything\",\n            description: \"Inlet data type\"\n        }\n    };\n    static inlets: IInletsMeta = [{\n        isHot: true,\n        type: \"anything\",\n        description: \"\"\n    }];\n    protected get index() {\n        return Math.max(1, ~~this.box.args[0] || 1);\n    }\n    protected _ = { index: this.index };\n    protected emitPatcherChangeIO = () => this.patcher.changeIO();\n    subscribe() {\n        super.subscribe();\n        this.on(\"metaUpdated\", this.emitPatcherChangeIO);\n        this.on(\"preInit\", () => {\n            this.inlets = 1;\n            this.outlets = 0;\n        });\n        this.on(\"postInit\", this.emitPatcherChangeIO);\n        this.on(\"updateArgs\", () => {\n            const { index } = this;\n            if (index !== this._.index) {\n                this._.index = index;\n                this.patcher.changeIO();\n            }\n        });\n        this.on(\"updateProps\", (props) => {\n            const inlet0 = { ...this.meta.inlets[0] };\n            if (typeof props.description === \"string\") inlet0.description = props.description;\n            if (typeof props.type === \"string\") inlet0.type = props.type || \"anything\";\n            this.setMeta({ inlets: [inlet0] });\n            this.emitPatcherChangeIO();\n        });\n        this.on(\"inlet\", ({ data, inlet }) => {\n            if (inlet === 0) this.patcher.outlet(this.index - 1, data);\n        });\n        this.on(\"destroy\", this.emitPatcherChangeIO);\n    }\n}\n","import BaseObject from \"../base/BaseObject\";\nimport type { IArgsMeta, IOutletsMeta, IPropsMeta } from \"../base/AbstractObject\";\nimport type { PatcherEventMap } from \"../../patcher/Patcher\";\n\ninterface P {\n    description: string;\n}\n\nexport default class Param extends BaseObject<{}, {}, [], [number, number], [string], P> {\n    static description = \"Patcher outlet (data)\";\n    static args: IArgsMeta = [{\n        type: \"string\",\n        optional: false,\n        default: \"\",\n        description: \"Parameter name\"\n    }];\n    static props: IPropsMeta<P> = {\n        description: {\n            type: \"string\",\n            default: \"\",\n            description: \"Description text\"\n        }\n    };\n    static outlets: IOutletsMeta = [{\n        type: \"anything\",\n        description: \"\"\n    }];\n    protected handlePatcherInput = ({ param, index, sample }: PatcherEventMap[\"paramInput\"]) => {\n        if (this.args[0] === param) this.outletAll([sample, index]);\n    };\n    protected emitPatcherChangeIO = () => this.patcher.changeIO();\n    subscribe() {\n        super.subscribe();\n        this.on(\"metaUpdated\", this.emitPatcherChangeIO);\n        this.on(\"preInit\", () => {\n            this.inlets = 0;\n            this.outlets = 1;\n        });\n        this.on(\"postInit\", this.emitPatcherChangeIO);\n        this.on(\"updateArgs\", this.emitPatcherChangeIO);\n        this.on(\"updateProps\", (props) => {\n            const outlet0 = { ...this.meta.outlets[0] };\n            if (typeof props.description === \"string\") outlet0.description = props.description;\n            this.setMeta({ outlets: [outlet0] });\n            this.emitPatcherChangeIO();\n        });\n        if (this.env.thread === \"AudioWorklet\") this.patcher.on(\"paramInput\", this.handlePatcherInput);\n        this.on(\"destroy\", () => {\n            this.patcher.off(\"paramInput\", this.handlePatcherInput);\n            this.patcher.changeIO();\n        });\n    }\n}\n","import generateRemotedObject from \"../base/generateRemotedObject\";\nimport In from \"./In\";\nimport Out from \"./Out\";\nimport Param from \"./Param\";\nimport AudioIn from \"./AudioIn\";\nimport AudioOut from \"./AudioOut\";\nimport type BaseObject from \"../base/BaseObject\";\n\nexport default async () => ({\n    in: generateRemotedObject(In as typeof BaseObject),\n    out: generateRemotedObject(Out as typeof BaseObject),\n    \"param~\": generateRemotedObject(Param as typeof BaseObject),\n    \"in~\": generateRemotedObject(AudioIn as typeof BaseObject),\n    \"out~\": generateRemotedObject(AudioOut as typeof BaseObject)\n});\n","import TypedEventEmitter from \"../../utils/TypedEventEmitter\";\nimport { isTRect, parseToPrimitive, isTPresentationRect, isRectMovable, isRectResizable } from \"../../utils/utils\";\nimport type Patcher from \"./Patcher\";\nimport type Line from \"./Line\";\nimport type { TBox, TMaxBox, TRect, TPresentationRect } from \"../types\";\nimport type { Args, Data, IJSPatcherObject, JSPatcherObjectEventMap, Props, State } from \"../objects/base/AbstractObject\";\n\nexport interface BoxEventMap extends Pick<JSPatcherObjectEventMap<any, any, any, any, any, any, any>, \"metaUpdated\" | \"argsUpdated\" | \"propsUpdated\" | \"dataUpdated\" | \"stateUpdated\"> {\n    \"rectChanged\": Box;\n    \"presentationRectChanged\": Box;\n    \"backgroundChanged\": Box;\n    \"presentationChanged\": Box;\n    \"textChanged\": Box;\n    \"highlight\": Box;\n    \"error\": string;\n    \"highlightPort\": { isSrc: boolean; i: number; highlight: boolean };\n    \"connectedPort\": { isSrc: boolean; i: number; last?: false };\n    \"disconnectedPort\": { isSrc: boolean; i: number; last: boolean };\n    \"ioCountChanged\": Box;\n}\n\nexport default class Box<T extends IJSPatcherObject = IJSPatcherObject> extends TypedEventEmitter<BoxEventMap> {\n    readonly id: string;\n    text = \"\";\n    inlets = 0;\n    outlets = 0;\n    rect: TRect;\n    background: boolean;\n    presentation: boolean;\n    presentationRect: TPresentationRect;\n    data: Data<T>;\n    args: Args<T>;\n    props: Props<T>;\n    _editing: boolean;\n    private _parsed: { class: string; args: Args<T>; props: Props<T> };\n    private _object: T;\n    private _Object: typeof IJSPatcherObject;\n    private readonly _patcher: Patcher;\n    private readonly _inletLines: Set<Line>[];\n    private readonly _outletLines: Set<Line>[];\n    constructor(patcherIn: Patcher, boxIn: TBox) {\n        super();\n        this.id = boxIn.id;\n        this.text = boxIn.text;\n        this.args = (boxIn.args || []) as Args<T>;\n        this.props = (boxIn.props || {}) as Props<T>;\n        this.inlets = boxIn.inlets;\n        this.outlets = boxIn.outlets;\n        this._inletLines = new Array(this.inlets).fill(null).map(() => new Set<Line>());\n        this._outletLines = new Array(this.outlets).fill(null).map(() => new Set<Line>());\n        const maxBoxIn = boxIn as unknown as TMaxBox[\"box\"];\n        this.rect = boxIn.rect || maxBoxIn.patching_rect;\n        this.background = boxIn.background || !!maxBoxIn.background;\n        this.presentation = boxIn.presentation || !!maxBoxIn.presentation;\n        this.presentationRect = boxIn.presentationRect || maxBoxIn.presentation_rect;\n        if (!this.presentationRect) this.presentationRect = this.rect.slice() as TRect;\n        this.data = boxIn.data || (boxIn as any).prevData?.storage || {};\n        this._editing = !!boxIn._editing;\n        this._patcher = patcherIn;\n        this.on(\"dataUpdated\", () => this._patcher.emitChanged());\n        this.on(\"argsUpdated\", () => this._patcher.emitChanged());\n        this.on(\"propsUpdated\", () => this._patcher.emitChanged());\n    }\n    async init() {\n        this._parsed = Box.parseObjText(this.text) as { class: string; args: Args<T>; props: Props<T> };\n        const newMeta = this._patcher.getObjectMeta(this._parsed);\n        for (const key in this.props) {\n            if (!newMeta.props[key]) delete this.props[key];\n        }\n        if (this._parsed.args.length) this.args = this._parsed.args;\n        Object.assign(this.props, this._parsed.props);\n        const Constructor = this._patcher.getObjectConstructor(this._parsed);\n        this._Object = Constructor;\n        if (!this.size.every(v => v > 0)) this.size = this.defaultSize;\n        if (!isTPresentationRect(this.presentationRect) || (this.presentationSize.every(v => typeof v === \"number\") && !this.presentationSize.every(v => v > 0))) this.presentationSize = this.defaultSize;\n        this._object = new Constructor(this, this._patcher) as T;\n        await this._object.init();\n        return this;\n    }\n    async postInit() {\n        await this._object.postInit();\n        return this;\n    }\n    /**\n     * Main function when receive data from a inlet (base 0)\n     */\n    fn(inlet: number, data: any) {\n        this._object.fn(inlet, data);\n        return this;\n    }\n    get UI() {\n        return this._Object.UI;\n    }\n    get defaultSize() {\n        return this.UI?.defaultSize || [90, 20];\n    }\n    get meta() {\n        return this._object.meta;\n    }\n    get outletLines() {\n        return this._outletLines;\n    }\n    get inletLines() {\n        return this._inletLines;\n    }\n    get object() {\n        return this._object;\n    }\n    set object(oIn: T) {\n        this._object = oIn;\n    }\n    get Object() {\n        return this._Object;\n    }\n    get parsed() {\n        return this._parsed;\n    }\n    addInletLine(line: Line) {\n        const index = line.destInlet;\n        if (!this._inletLines[index]) this._inletLines[index] = new Set<Line>();\n        this._inletLines[index].add(line);\n    }\n    removeInletLine(line: Line) {\n        const index = line.destInlet;\n        if (this._inletLines[index]) this._inletLines[index].delete(line);\n    }\n    addOutletLine(line: Line) {\n        const index = line.srcOutlet;\n        if (!this._outletLines[index]) this._outletLines[index] = new Set<Line>();\n        this._outletLines[index].add(line);\n    }\n    removeOutletLine(line: Line) {\n        const index = line.srcOutlet;\n        if (this._outletLines[index]) this._outletLines[index].delete(line);\n    }\n    setInlets(count: number) {\n        const lines = this.allLines;\n        lines.forEach(line => line.disable());\n        this.inlets = count;\n        // Lines that should be removed will destroy themselves when enable()\n        lines.forEach(line => line.enable());\n        const linesSetLength = this._inletLines.length;\n        if (count > linesSetLength) this._inletLines.push(...new Array(count - linesSetLength).fill(null).map(() => new Set<Line>()));\n        else if (count < linesSetLength) this._inletLines.splice(count);\n        this._inletLines.forEach(set => set.forEach(line => line.uiUpdateDest()));\n        this.emit(\"ioCountChanged\", this);\n    }\n    setOutlets(count: number) {\n        const lines = this.allLines;\n        lines.forEach(line => line.disable());\n        this.outlets = count;\n        // Lines that should be removed will destroy themselves when enable()\n        lines.forEach(line => line.enable());\n        const linesSetLength = this._outletLines.length;\n        if (count > linesSetLength) this._outletLines.push(...new Array(count - linesSetLength).fill(null).map(() => new Set<Line>()));\n        else if (count < linesSetLength) this._outletLines.splice(count);\n        this._outletLines.forEach(set => set.forEach(line => line.uiUpdateSrc()));\n        this.emit(\"ioCountChanged\", this);\n    }\n    getInletPos(port: number) {\n        const { rect, inlets } = this;\n        const [left, top, width] = rect;\n        return { top, left: ((left + 10) + (width - 20) * port / (inlets > 1 ? inlets - 1 : 1)) };\n    }\n    getOutletPos(port: number) {\n        const { rect, outlets } = this;\n        const [left, top, width, height] = rect;\n        return { top: top + height, left: ((left + 10) + (width - 20) * port / (outlets > 1 ? outlets - 1 : 1)) };\n    }\n    get inletsPositions() {\n        const positions = [];\n        for (let i = 0; i < this.inlets; i++) {\n            positions[i] = this.getInletPos(i);\n        }\n        return positions;\n    }\n    get outletsPositions() {\n        const positions = [];\n        for (let i = 0; i < this.outlets; i++) {\n            positions[i] = this.getOutletPos(i);\n        }\n        return positions;\n    }\n    get allLines() {\n        const lines = new Set<Line>();\n        this._inletLines.forEach(set => set.forEach(line => lines.add(line)));\n        this._outletLines.forEach(set => set.forEach(line => lines.add(line)));\n        return lines;\n    }\n    // called when inlet or outlet are connected or disconnected\n    connectedOutlet(outlet: number, destBoxId: string, destInlet: number, lineId: string) {\n        if (this._object) this._object.connectedOutlet(outlet, destBoxId, destInlet, lineId);\n        this.emit(\"connectedPort\", { isSrc: true, i: outlet });\n        return this;\n    }\n    connectedInlet(inlet: number, srcBoxId: string, srcOutlet: number, lineId: string) {\n        if (this._object) this._object.connectedInlet(inlet, srcBoxId, srcOutlet, lineId);\n        this.emit(\"connectedPort\", { isSrc: false, i: inlet });\n        return this;\n    }\n    disconnectedOutlet(outlet: number, destBoxId: string, destInlet: number, lineId: string) {\n        if (this._object) this._object.disconnectedOutlet(outlet, destBoxId, destInlet, lineId);\n        const last = this._patcher.getLinesBySrcID(this.id)[outlet].length === 1;\n        this.emit(\"disconnectedPort\", { isSrc: true, i: outlet, last });\n        return this;\n    }\n    disconnectedInlet(inlet: number, srcBoxId: string, srcOutlet: number, lineId: string) {\n        if (this._object) this._object.disconnectedInlet(inlet, srcBoxId, srcOutlet, lineId);\n        const last = this._patcher.getLinesByDestID(this.id)[inlet].length === 1;\n        this.emit(\"disconnectedPort\", { isSrc: false, i: inlet, last });\n        return this;\n    }\n    isOutletTo(outlet: number, box: Box, inlet: number) {\n        const iterator = this._outletLines[outlet].values();\n        let r: IteratorResult<Line, Line>;\n        while (!(r = iterator.next()).done) {\n            const line = r.value;\n            if (line.destBox === box && line.destInlet === inlet) return true;\n        }\n        return false;\n    }\n    isInletFrom(inlet: number, box: Box, outlet: number) {\n        const iterator = this._inletLines[inlet].values();\n        let r: IteratorResult<Line, Line>;\n        while (!(r = iterator.next()).done) {\n            const line = r.value;\n            if (line.srcBox === box && line.srcOutlet === outlet) return true;\n        }\n        return false;\n    }\n    async changeText(textIn: string, force?: boolean) {\n        if (!force && textIn === this.text) return this;\n        const { defaultSize: oldDefaultSize } = this;\n        this.allLines.forEach(line => line.disable());\n        await this._object.destroy();\n        this.text = textIn;\n        this.args = [] as Args<T>;\n        await this.init();\n        this.allLines.forEach(line => line.enable());\n        const { defaultSize } = this;\n        if (!defaultSize.every((v, i) => v === oldDefaultSize[i])) {\n            this.size = defaultSize;\n            this.presentationSize = defaultSize;\n        }\n        this.emit(\"textChanged\", this);\n        this._object.setMeta(this._object.meta);\n        await this.postInit();\n        return this;\n    }\n    update(e: { args?: any[]; props?: Record<string, any> }) {\n        const { args, props } = e;\n        if (args) this.args = args as Args<T>;\n        if (props) {\n            if (isTRect(props.rect)) {\n                this.setRect(props.rect);\n                delete props.rect;\n            }\n            if (isTPresentationRect(props.presentationRect)) {\n                this.setPresentationRect(props.presentationRect);\n                delete props.presentationRect;\n            }\n            if (typeof props.presentation === \"boolean\") {\n                this.setPresentation(props.presentation);\n                delete props.presentation;\n            }\n            if (typeof props.background === \"boolean\") {\n                this.setBackground(props.background);\n                delete props.background;\n            }\n            this.props = Object.assign(this.props, props);\n        }\n        return this;\n    }\n    get position() {\n        return this.rect.slice(0, 2) as [number, number];\n    }\n    set position([leftIn, topIn]: [number, number]) {\n        const [left, top, width, height] = this.rect;\n        this.setRect([typeof leftIn === \"number\" ? leftIn : left, typeof topIn === \"number\" ? topIn : top, width, height] as TRect);\n    }\n    get presentationPosition() {\n        return this.presentationRect.slice(0, 2) as [number | string, number | string];\n    }\n    set presentationPosition([leftIn, topIn]: [number | string, number | string]) {\n        const [left, top, width, height] = this.presentationRect;\n        this.setPresentationRect([typeof leftIn === \"number\" || typeof leftIn === \"string\" ? leftIn : left, typeof topIn === \"number\" || typeof topIn === \"string\" ? topIn : top, width, height] as TPresentationRect);\n    }\n    get size() {\n        return this.rect.slice(2) as [number, number];\n    }\n    set size([widthIn, heightIn]: [number, number]) {\n        const [left, top, width, height] = this.rect;\n        this.setRect([left, top, widthIn || width, heightIn || height] as TRect);\n    }\n    get presentationSize() {\n        return this.presentationRect.slice(2) as [number | string, number | string];\n    }\n    set presentationSize([widthIn, heightIn]: [number | string, number | string]) {\n        const [left, top, width, height] = this.presentationRect;\n        this.setPresentationRect([left, top, widthIn || width, heightIn || height] as TPresentationRect);\n    }\n    getLeft(inPresentation = false) {\n        const rectKey = inPresentation ? \"presentationRect\" : \"rect\";\n        return this[rectKey][0];\n    }\n    setLeft(leftIn: number | string, inPresentation = false) {\n        const positionKey = inPresentation ? \"presentationPosition\" : \"position\";\n        this[positionKey] = [leftIn as any, undefined];\n    }\n    getTop(inPresentation = false) {\n        const rectKey = inPresentation ? \"presentationRect\" : \"rect\";\n        return this[rectKey][1];\n    }\n    setTop(topIn: number | string, inPresentation = false) {\n        const positionKey = inPresentation ? \"presentationPosition\" : \"position\";\n        this[positionKey] = [undefined, topIn as any];\n    }\n    getWidth(inPresentation = false) {\n        const rectKey = inPresentation ? \"presentationRect\" : \"rect\";\n        return this[rectKey][2];\n    }\n    setWidth(widthIn: number | string, inPresentation = false) {\n        const sizeKey = inPresentation ? \"presentationSize\" : \"size\";\n        this[sizeKey] = [widthIn as any, undefined];\n    }\n    getHeight(inPresentation = false) {\n        const rectKey = inPresentation ? \"presentationRect\" : \"rect\";\n        return this[rectKey][3];\n    }\n    setHeight(heightIn: number | string, inPresentation = false) {\n        const sizeKey = inPresentation ? \"presentationSize\" : \"size\";\n        this[sizeKey] = [undefined, heightIn as any];\n    }\n    setBackground(bool: boolean) {\n        if (!!this.background === !!bool) return this;\n        this.background = bool;\n        this.emit(\"backgroundChanged\", this);\n        return this;\n    }\n    setPresentation(bool: boolean) {\n        if (!!this.presentation === !!bool) return this;\n        this.presentation = bool;\n        if (bool) this.presentationRect = this.rect.slice() as TRect;\n        this.emit(\"presentationChanged\", this);\n        return this;\n    }\n    setRect(rect: TRect) {\n        if (!isTRect(rect)) return this;\n        rect[0] = Math.max(0, rect[0]);\n        rect[1] = Math.max(0, rect[1]);\n        rect[2] = Math.max(15, rect[2]);\n        rect[3] = Math.max(15, rect[3]);\n        this.rect = rect;\n        this.inletLines.forEach(set => set.forEach(line => line.uiUpdateDest()));\n        this.outletLines.forEach(set => set.forEach(line => line.uiUpdateSrc()));\n        this.emit(\"rectChanged\", this);\n        return this;\n    }\n    setPresentationRect(rect: TPresentationRect) {\n        if (!isTPresentationRect(rect)) return this;\n        if (typeof rect[0] === \"number\") rect[0] = Math.max(0, rect[0]);\n        if (typeof rect[1] === \"number\") rect[1] = Math.max(0, rect[1]);\n        if (typeof rect[2] === \"number\") rect[2] = Math.max(15, rect[2]);\n        if (typeof rect[3] === \"number\") rect[3] = Math.max(15, rect[3]);\n        this.presentationRect = rect;\n        this.emit(\"presentationRectChanged\", this);\n        return this;\n    }\n    getIsMovable(inPresentation = false) {\n        if (!inPresentation) return true;\n        return isRectMovable(this.presentationRect);\n    }\n    getIsResizable(inPresentation = false) {\n        if (!inPresentation) return true;\n        return isRectResizable(this.presentationRect);\n    }\n    error(text: string) {\n        this.emit(\"error\", text);\n    }\n    highlight() {\n        this.emit(\"highlight\", this);\n    }\n    highlightPort(isSrc: boolean, i: number, highlight: boolean) {\n        this.emit(\"highlightPort\", { isSrc, i, highlight });\n    }\n    undoable(e: { oldArgs?: Args<T>; args?: Args<T>; oldProps?: Props<T>; props?: Props<T>; oldState?: State<T>; state?: State<T> }) {\n        this._patcher.boxChanged(this.id, e);\n    }\n    async changeObject({ args, props, state }: { args?: Args<T>; props?: Props<T>; state?: State<T> }, options?: { undoable?: boolean }) {\n        if (args) await this._object.updateArgs(args, options);\n        if (props) await this._object.updateProps(props, options);\n        if (state) await this._object.updateState(state, options);\n    }\n    async destroy() {\n        this.allLines.forEach(line => this._patcher.deleteLine(line.id));\n        await this._object.destroy();\n        delete this._patcher.boxes[this.id];\n        return this;\n    }\n    static parseObjText(strIn: string) {\n        const REGEX = /`([^`]*)`|[^\\s]+/gi;\n        const strArray = [];\n        let match = REGEX.exec(strIn);\n        while (match != null) {\n            // Index 1 in the array is the captured group if it exists\n            // Index 0 is the matched text, which we use if no captured group exists\n            strArray.push(match[1] ? match[1] : match[0]);\n            // Each call to exec returns the next regex match as an array\n            match = REGEX.exec(strIn);\n        }\n        const objOut: { class: string; args: any[]; props: Record<string, any> } = { class: \"\", args: [], props: {} };\n        let lastProp;\n        if (strArray.length) objOut.class = strArray.shift();\n        while (strArray.length) {\n            const el = strArray.shift();\n            if (typeof lastProp === \"undefined\" && el.charAt(0) !== \"@\") { // is arg, to push\n                try {\n                    objOut.args.push(JSON.parse(el));\n                } catch (e) {\n                    objOut.args.push(el);\n                }\n                continue;\n            }\n            if (el.length > 1 && el.charAt(0) === \"@\") { // is prop key\n                lastProp = el.substr(1);\n                objOut.props[lastProp] = [];\n                continue;\n            }\n            try { // is prop value\n                objOut.props[lastProp].push(JSON.parse(el));\n            } catch (e) {\n                objOut.props[lastProp].push(el);\n            }\n        }\n        for (const key in objOut.props) { // no value = true, one value need to parse, else array\n            if (objOut.props[key].length === 0) objOut.props[key] = true;\n            else if (objOut.props[key].length === 1) objOut.props[key] = parseToPrimitive(objOut.props[key][0]);\n            else objOut.props[key] = parseToPrimitive(objOut.props[key].join(\" \"));\n        }\n        return objOut;\n    }\n    toString() {\n        const { id, text, inlets, outlets, rect, background, presentation, presentationRect, args, props, data } = this;\n        return JSON.stringify({ id, text, inlets, outlets, rect, background, presentation, presentationRect, args, props, data });\n    }\n    toSerializable(): TBox {\n        return JSON.parse(this.toString());\n    }\n}\n","import type { Rec, Receive, Import, Iterator, FaustOp, Effect, In, Out, TLineMap } from \"../objects/Faust\";\nimport type Box from \"./Box\";\nimport type Line from \"./Line\";\nimport type Patcher from \"./Patcher\";\n\nconst mapLines = (box: Box, patcher: Patcher, visitedBoxes: Box[], ins: In[], recs: Rec[], lineMap: Map<Line, string>) => {\n    if (visitedBoxes.indexOf(box) >= 0) return;\n    visitedBoxes.push(box);\n    if (box.object.class === \"Iterator\" && box !== visitedBoxes[0]) return;\n    const inletLines = Array.from(box.inletLines);\n    if (box.object.class === \"Receive\") {\n        const { sendID, state: { sendMap } } = box.object as Receive;\n        if (sendMap[sendID]) {\n            sendMap[sendID].forEach(s => inletLines.push(...s.inletLines));\n        }\n    }\n    inletLines.forEach(lines => lines.forEach((line) => {\n        const { srcBox } = line;\n        if (srcBox.object.class === \"In\" && ins.indexOf(srcBox.object as In) === -1) ins.push(srcBox.object as In);\n        else if (srcBox.object.class === \"Rec\" && recs.indexOf(srcBox.object as Rec) === -1) recs.push(srcBox.object as Rec);\n        if (srcBox.object.class === \"Effect\") lineMap.set(line, \"_\");\n        else lineMap.set(line, `${(srcBox.object as FaustOp).resultID}_${line.srcOutlet}`);\n        mapLines(srcBox, patcher, visitedBoxes, ins, recs, lineMap);\n    }));\n};\nexport const toFaustLambda = (patcher: Patcher, outs: FaustOp[], lambdaName: string) => {\n    const exprs: string[] = [];\n    const onces: string[] = [];\n    const mainIns: string[] = [];\n    const mainOuts: string[] = [];\n    const recIns: string[] = [];\n    const recOuts: string[] = [];\n    const visitedBoxes: Box[] = [];\n    let ins: In[] = [];\n    const recs: Rec[] = [];\n    const lineMap: TLineMap = new Map<Line, string>();\n    // Build graph\n    outs.forEach(out => mapLines(out.box, patcher, visitedBoxes, ins, recs, lineMap));\n    visitedBoxes.forEach((box) => {\n        if (box.object.class === \"In\") return;\n        if (box.object.class === \"Out\") return;\n        if (box.object.class === \"Rec\") return;\n        if (outs.indexOf(box.object as FaustOp) !== -1) return;\n        const { onces: o, exprs: e } = (box.object as FaustOp).toExpr(lineMap);\n        if (o) onces.push(...o.filter(v => onces.indexOf(v) === -1));\n        if (e) exprs.push(...e);\n    });\n    // Reverse order for readibility\n    exprs.reverse();\n    // Build rec in/outs\n    recs.forEach((rec) => {\n        exprs.push(...rec.toExpr(lineMap).exprs || []);\n        const recIn = rec.resultID;\n        const recOut = `${recIn}_0`;\n        recIns.push(recIn);\n        recOuts.push(recOut);\n    });\n    // Build main in/outs\n    ins = ins.sort((a, b) => a.index - b.index);\n    ins.forEach((in_) => {\n        const id = `${in_.resultID}_0`;\n        if (mainIns.indexOf(id) === -1) mainIns.push(id);\n    });\n    outs.forEach((out) => {\n        if (out.class === \"Iterator\") exprs.push(...(out as Iterator).toNormalExpr(lineMap).exprs || []);\n        else exprs.push(...out.toExpr(lineMap).exprs || []);\n        const id = out.resultID;\n        if (mainIns.indexOf(id) === -1) mainOuts.push(id);\n    });\n    // Generate Final expressions\n    exprs.forEach((s, i) => exprs[i] = `    ${s.replace(/\\n/g, \"\\n    \")}`); // indent\n    if (recIns.length) {\n        exprs.unshift(`Main(${[...recOuts, ...mainIns].join(\", \")}) = ${[...recIns, ...mainOuts].join(\", \")} with {`);\n        exprs.push(\n            \"};\",\n            `Rec = ${recIns.map(() => \"_\").join(\", \")} : ${recOuts.map(() => \"_\").join(\", \")};`,\n            `${lambdaName} = Main ~ Rec : ${[...recIns.map(() => \"!\"), ...mainOuts.map(() => \"_\")].join(\", \")};`\n        );\n    } else if (mainIns.length) {\n        exprs.unshift(`${lambdaName}(${mainIns.join(\", \")}) = ${mainOuts.join(\", \")} with {`);\n        exprs.push(\"};\");\n    } else if (exprs.length) {\n        exprs.unshift(`${lambdaName} = ${mainOuts.join(\", \")} with {`);\n        exprs.push(\"};\");\n    } else {\n        exprs.push(`${lambdaName} = 0;`);\n    }\n    return { onces, exprs, ins, outs };\n};\nexport const toFaustDspCode = (patcher: Patcher) => inspectFaustPatcher(patcher).code;\nexport const inspectFaustPatcher = (patcher: Patcher) => {\n    const imports: Import[] = [];\n    let outs: Out[] = [];\n    const effects: Effect[] = [];\n    // Find outs and imports\n    for (const boxId in patcher.boxes) {\n        const box = patcher.boxes[boxId];\n        if (box.object.class === \"Effect\") effects.push(box.object as Effect);\n        else if (box.object.class === \"Out\") outs.push(box.object as Out);\n        else if (box.object.class === \"Import\") imports.push(box.object as Import);\n    }\n    outs = outs.sort((a, b) => a.index - b.index);\n    const { onces, exprs, ins } = toFaustLambda(patcher, outs, \"process\");\n    if (effects.length) {\n        const { onces: fxOnces, exprs: fxExprs, ins: fxIns } = toFaustLambda(patcher, [effects[0]], \"effect\");\n        onces.push(...fxOnces.filter(v => onces.indexOf(v) === -1));\n        exprs.push(...fxExprs);\n        ins.push(...fxIns);\n    }\n    imports.map(i => i.toOnceExpr()).forEach(o => onces.push(...o.filter(v => onces.indexOf(v) === -1)));\n    const code = `${onces.join(\"\\n\")}${onces.length ? \"\\n\" : \"\"}${exprs.join(\"\\n\")}\\n`;\n    return { code, onces, exprs, ins, outs };\n};\n","import type { WamNode } from \"wamsdk\";\nimport TypedEventEmitter from \"../../utils/TypedEventEmitter\";\nimport type Patcher from \"./Patcher\";\nimport type { TLine, TLineType } from \"../types\";\nimport type { IJSPatcherObject, TMetaType } from \"../objects/base/AbstractObject\";\n\nexport interface LineEventMap {\n    \"passData\": any;\n    \"destPosChanged\": { top: number; left: number };\n    \"srcPosChanged\": { top: number; left: number };\n    \"posChanged\": Line;\n    \"typeChanged\": TLineType;\n}\n\nexport default class Line extends TypedEventEmitter<LineEventMap> {\n    static isConnectableByAudio(from: IJSPatcherObject, outlet: number, to: IJSPatcherObject, inlet: number) {\n        const fromConnection = from.outletAudioConnections[outlet];\n        const toConnection = to.inletAudioConnections[inlet];\n        if (!fromConnection) return false;\n        if (!toConnection) return false;\n        if (!fromConnection.node) return false;\n        if (!toConnection.node) return false;\n        return true;\n    }\n    static isWamNode(x: any): x is WamNode {\n        return typeof x === \"object\" && x !== null && x?.module?.isWebAudioModule;\n    }\n    static compare(line1: Line, line2: Line) {\n        return line2.positionHash - line1.positionHash;\n    }\n    readonly id: string;\n    src: [string, number];\n    dest: [string, number];\n    disabled = true;\n    private _type: TLineType;\n    private readonly _patcher: Patcher;\n    constructor(patcherIn: Patcher, lineIn: TLine) {\n        super();\n        this.id = lineIn.id;\n        this.src = lineIn.src;\n        this.dest = lineIn.dest;\n        this.disabled = true;\n        this._patcher = patcherIn;\n        const { srcBox, destBox } = this;\n        this._type = this.calcType();\n        if (srcBox) {\n            srcBox.on(\"metaUpdated\", this.updateType);\n            srcBox.addOutletLine(this);\n        }\n        if (destBox) {\n            destBox.on(\"metaUpdated\", this.updateType);\n            destBox.addInletLine(this);\n        }\n    }\n    get isConnectableByAudio() {\n        if (this._patcher.props.mode !== \"js\") return false;\n        return Line.isConnectableByAudio(this.srcBox.object, this.srcOutlet, this.destBox.object, this.destInlet);\n    }\n    get presentation() {\n        return this.srcBox && this.srcBox.presentation && this.destBox && this.destBox.presentation;\n    }\n    setSrc(src: [string, number]) {\n        const srcId = src[0];\n        const srcOutlet = src[1];\n        if (srcId === this.src[0] && srcOutlet === this.src[1]) return this;\n        this.srcBox.off(\"metaUpdated\", this.updateType);\n        this.disable();\n        this.srcBox.removeOutletLine(this);\n        this.src = [srcId, srcOutlet];\n        this.srcBox.addOutletLine(this);\n        this.enable();\n        this.srcBox.on(\"metaUpdated\", this.updateType);\n        this.updateType();\n        return this.uiUpdateSrc();\n    }\n    getSrc() {\n        return this.src;\n    }\n    uiUpdateSrc() {\n        this.emit(\"srcPosChanged\", this.srcPos);\n        return this;\n    }\n    setDest(dest: [string, number]) {\n        const destId = dest[0];\n        const destInlet = dest[1];\n        if (destId === this.dest[0] && destInlet === this.dest[1]) return this;\n        this.destBox.off(\"metaUpdated\", this.updateType);\n        this.disable();\n        this.destBox.removeInletLine(this);\n        this.dest = [destId, destInlet];\n        this.destBox.addInletLine(this);\n        this.enable();\n        this.destBox.on(\"metaUpdated\", this.updateType);\n        this.updateType();\n        return this.uiUpdateDest();\n    }\n    getDest() {\n        return this.dest;\n    }\n    uiUpdateDest() {\n        this.emit(\"destPosChanged\", this.destPos);\n        return this;\n    }\n    disable(bool?: boolean): Line {\n        if (bool === false) return this.enable();\n        if (this.disabled) return this;\n        this.disabled = true;\n        const { srcBox, destBox } = this;\n        if (this._patcher.getLinesByBox(this.srcId, this.destId, this.srcOutlet, this.destInlet).length > 1) return this; // not last cable\n        if (this.isConnectableByAudio) {\n            const from = this.srcBox.object.outletAudioConnections[this.srcOutlet];\n            const to = this.destBox.object.inletAudioConnections[this.destInlet];\n            if (from && to && from.node && to.node) {\n                const isAudioParam = to.node instanceof AudioParam;\n                try {\n                    if (isAudioParam) from.node.disconnect(to.node as AudioParam, from.index);\n                    else from.node.disconnect(to.node as AudioNode, from.index, to.index);\n                    if (Line.isWamNode(from.node) && Line.isWamNode(to.node)) from.node.disconnectEvents(to.node);\n                } catch (e) {\n                    this._patcher.error((e as Error).message);\n                }\n            }\n        }\n        srcBox.disconnectedOutlet(this.srcOutlet, destBox.id, this.destInlet, this.id);\n        destBox.disconnectedInlet(this.destInlet, srcBox.id, this.srcOutlet, this.id);\n        return this;\n    }\n    enable(bool?: boolean): Line {\n        if (bool === false) return this.disable();\n        if (!this.disabled) return this;\n        const { srcBox, destBox } = this;\n        if (this.srcOutlet >= srcBox.outlets || this.destInlet >= destBox.inlets) return this._patcher.deleteLine(this.id);\n        if (this._patcher.getLinesByBox(this.srcId, this.destId, this.srcOutlet, this.destInlet).length > 1) return this; // not last cable\n        if (this.isConnectableByAudio) {\n            const from = this.srcBox.object.outletAudioConnections[this.srcOutlet];\n            const to = this.destBox.object.inletAudioConnections[this.destInlet];\n            if (from && to && from.node && to.node) {\n                const isAudioParam = to.node instanceof AudioParam;\n                try {\n                    if (isAudioParam) from.node.connect(to.node as AudioParam, from.index);\n                    else from.node.connect(to.node as AudioNode, from.index, to.index);\n                    if (Line.isWamNode(from.node) && Line.isWamNode(to.node)) from.node.connectEvents(to.node);\n                } catch (e) {\n                    this._patcher.error((e as Error).message);\n                }\n            }\n        }\n        srcBox.connectedOutlet(this.srcOutlet, destBox.id, this.destInlet, this.id);\n        destBox.connectedInlet(this.destInlet, srcBox.id, this.srcOutlet, this.id);\n        this.disabled = false;\n        return this;\n    }\n    destroy() {\n        this.destBox.off(\"metaUpdated\", this.updateType);\n        this.srcBox.off(\"metaUpdated\", this.updateType);\n        this.disable();\n        this.srcBox.removeOutletLine(this);\n        this.destBox.removeInletLine(this);\n        delete this._patcher.lines[this.id];\n        return this;\n    }\n    pass(data: any) {\n        this.emit(\"passData\", data);\n        return this.disabled ? this : this.destBox.fn(this.destInlet, data);\n    }\n    get positionHash() {\n        const { top, left } = this._patcher.boxes[this.dest[0]].getInletPos(this.dest[1]);\n        return left * 65536 + top;\n    }\n    get srcPos() {\n        return this._patcher.boxes[this.src[0]].getOutletPos(this.src[1]);\n    }\n    get destPos() {\n        return this._patcher.boxes[this.dest[0]].getInletPos(this.dest[1]);\n    }\n    get srcId() {\n        return this.src[0];\n    }\n    get srcOutlet() {\n        return this.src[1];\n    }\n    get destId() {\n        return this.dest[0];\n    }\n    get destInlet() {\n        return this.dest[1];\n    }\n    get srcBox() {\n        return this._patcher.boxes[this.src[0]];\n    }\n    get destBox() {\n        return this._patcher.boxes[this.dest[0]];\n    }\n    private calcType() {\n        const srcMeta = this.srcBox.object.meta.outlets;\n        const destMeta = this.destBox.object.meta.inlets;\n        let srcType: TMetaType = \"anything\";\n        let destType: TMetaType = \"anything\";\n        if (srcMeta[this.srcOutlet]) srcType = srcMeta[this.srcOutlet].type;\n        else if (srcMeta[srcMeta.length - 1] && srcMeta[srcMeta.length - 1].varLength) srcType = srcMeta[srcMeta.length - 1].type;\n        if (destMeta[this.destInlet]) destType = destMeta[this.destInlet].type;\n        else if (destMeta[destMeta.length - 1] && destMeta[destMeta.length - 1].varLength) destType = destMeta[destMeta.length - 1].type;\n        return srcType === \"signal\" && destType === \"signal\" ? \"audio\" : \"normal\";\n    }\n    updateType = () => {\n        const type = this.calcType();\n        if (type !== this._type) {\n            this._type = type;\n            this.emit(\"typeChanged\", type);\n        }\n    };\n    get type(): TLineType {\n        return this._type;\n    }\n    toString() {\n        return JSON.stringify(this.toSerializable());\n    }\n    toSerializable(): TLine {\n        const { id, src, dest, disabled } = this;\n        return { id, src: [...src], dest: [...dest], disabled };\n    }\n}\n","import FileInstance from \"../file/FileInstance\";\nimport PatcherEditor from \"./PatcherEditor\";\nimport Line from \"./Line\";\nimport Box from \"./Box\";\nimport PatcherHistory from \"./PatcherHistory\";\nimport PackageManager, { IPackageManager } from \"../PackageManager\";\nimport { max2js, js2max } from \"../../utils/utils\";\nimport { toFaustDspCode } from \"./FaustPatcherAnalyser\";\nimport type Env from \"../Env\";\nimport type Project from \"../Project\";\nimport type TempPatcherFile from \"./TempPatcherFile\";\nimport type PersistentProjectFile from \"../file/PersistentProjectFile\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\nimport type { TInletEvent, TOutletEvent, IJSPatcherObjectMeta, IPropsMeta, IJSPatcherObject, TMetaType } from \"../objects/base/AbstractObject\";\nimport type { TLine, TBox, PatcherMode, RawPatcher, TMaxPatcher, TErrorLevel, TPatcherAudioConnection, TFlatPackage, TPackage, TPatcherLog, TDependencies } from \"../types\";\nimport type PatcherNode from \"../worklets/PatcherNode\";\nimport type PatcherProcessor from \"../worklets/Patcher.worklet\";\n\nexport interface TPatcherProps {\n    mode: PatcherMode;\n    dependencies: TDependencies;\n    bgColor: string;\n    editingBgColor: string;\n    grid: [number, number];\n    boxIndexCount: number;\n    lineIndexCount: number;\n    package?: string;\n    name?: string;\n    author?: string;\n    version?: string;\n    description?: string;\n    openInPresentation: boolean;\n}\nexport type TPublicPatcherProps = Pick<TPatcherProps, \"dependencies\" | \"bgColor\" | \"editingBgColor\" | \"grid\" | \"openInPresentation\">;\n\nexport interface TPatcherState {\n    name: string;\n    isReady: boolean;\n    log: TPatcherLog[];\n    selected: string[];\n    pkgMgr: IPackageManager;\n    preventEmitChanged: boolean;\n    patcherNode?: PatcherNode;\n    patcherProcessor?: PatcherProcessor;\n}\n\nexport interface PatcherEventMap extends TPublicPatcherProps {\n    \"postInited\": never;\n    \"ready\": never;\n    \"unload\": never;\n    \"changeBoxText\": { boxId: string; oldText: string; text: string };\n    \"boxChanged\": { boxId: string; oldArgs?: any[]; args?: any[]; oldProps?: Record<string, any>; props?: Record<string, any>; oldState?: Record<string, any>; state?: Record<string, any> };\n    \"passiveDeleteLine\": Line;\n    \"graphChanged\": never;\n    \"changed\": never;\n    \"ioChanged\": IJSPatcherObjectMeta;\n    \"dataInput\": TInletEvent<any[]>;\n    \"dataOutput\": TOutletEvent<any[]>;\n    \"audioInput\": { input: number; index: number; sample: number };\n    \"paramInput\": { param: string; index: number; sample: number };\n    \"audioOutput\": { output: number; index: number; sample: number };\n    \"disconnectAudioInlet\": number;\n    \"disconnectAudioOutlet\": number;\n    \"connectAudioInlet\": number;\n    \"connectAudioOutlet\": number;\n    \"propsChanged\": Partial<TPublicPatcherProps>;\n    \"libChanged\": { pkg: TPackage; lib: TFlatPackage };\n}\n\nexport default class Patcher extends FileInstance<PatcherEventMap, PersistentProjectFile | TempPatcherFile> {\n    static props: IPropsMeta<TPublicPatcherProps> = {\n        dependencies: {\n            type: \"object\",\n            description: \"Patcher dependencies\",\n            default: []\n        },\n        bgColor: {\n            type: \"color\",\n            description: \"Background color\",\n            default: \"rgba(61, 65, 70, 1)\"\n        },\n        editingBgColor: {\n            type: \"color\",\n            description: \"Background color while unlocked\",\n            default: \"rgba(82, 87, 94, 1)\"\n        },\n        grid: {\n            type: \"object\",\n            description: \"Grid size\",\n            default: [15, 15]\n        },\n        openInPresentation: {\n            type: \"boolean\",\n            description: \"Open patcher in presentation\",\n            default: false\n        }\n    };\n    static async fromProjectItem(options: { file: PersistentProjectFile | TempPatcherFile; env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<Patcher> {\n        return new this(options).init();\n    }\n    async getEditor() {\n        const editor = new PatcherEditor(this);\n        return editor.init();\n    }\n    lines: Record<string, Line> = {};\n    boxes: Record<string, Box> = {};\n    props: TPatcherProps;\n    _state: TPatcherState;\n    _inletAudioConnections: TPatcherAudioConnection[] = [];\n    _outletAudioConnections: TPatcherAudioConnection[] = [];\n    _history = new PatcherHistory();\n    constructor(options: { env: IJSPatcherEnv; project?: IProject; file?: PersistentProjectFile | TempPatcherFile; instanceId?: string }) {\n        super(options);\n        this._state = {\n            name: \"patcher\",\n            isReady: false,\n            log: [],\n            selected: [],\n            pkgMgr: undefined,\n            preventEmitChanged: false\n        };\n        this.lines = {};\n        this.boxes = {};\n        this.props = {\n            mode: \"js\",\n            dependencies: Patcher.props.dependencies.default,\n            bgColor: Patcher.props.bgColor.default,\n            editingBgColor: Patcher.props.editingBgColor.default,\n            grid: Patcher.props.grid.default,\n            openInPresentation: Patcher.props.openInPresentation.default,\n            boxIndexCount: 0,\n            lineIndexCount: 0\n        };\n    }\n    get state() {\n        return this._state;\n    }\n    get activePkg() {\n        return this._state.pkgMgr.pkg;\n    }\n    get activeLib() {\n        return this._state.pkgMgr.lib;\n    }\n    get isReady() {\n        return true;\n    }\n    get audioCtx() {\n        return (this.project as Project)?.audioCtx || (this.env as Env).audioCtx;\n    }\n    get fileExtension() {\n        return {\n            js: \"jspat\",\n            max: \"maxpat\",\n            gen: \"gendsp\",\n            faust: \"dsppat\",\n            jsaw: \"jsdsp\"\n        }[this.props.mode];\n    }\n    get fileName() {\n        return this.file?.name || `${this._state.name}.${this.fileExtension}`;\n    }\n    emitGraphChanged() {\n        if (this._state.preventEmitChanged) return;\n        this.emit(\"graphChanged\");\n        this.emitChanged();\n    }\n    emitChanged() {\n        if (this._state.preventEmitChanged) return;\n        this.emit(\"changed\");\n    }\n    boxChanged(boxId: string, changed: { oldArgs?: any[]; args?: any[]; oldProps?: Record<string, any>; props?: Record<string, any>; oldState?: Record<string, any>; state?: Record<string, any> }) {\n        this.emit(\"boxChanged\", { boxId, ...changed });\n    }\n    async init(data = this.file?.data, fileName = this.fileName) {\n        if (data instanceof ArrayBuffer) {\n            if (!data.byteLength) return this.load({});\n            const patcherIn = await new Response(data).json();\n            const splitName = fileName.split(\".\");\n            const ext = splitName.pop();\n            const extMap: Record<string, PatcherMode> = { json: \"js\", jspat: \"js\", maxpat: \"max\", gendsp: \"gen\", dsppat: \"faust\" };\n            return this.load(patcherIn, extMap[ext] || \"js\");\n        }\n        return this.load(data || {});\n    }\n    async load(patcherIn: RawPatcher | TMaxPatcher | any, modeIn?: PatcherMode) {\n        this._state.isReady = false;\n        this._state.preventEmitChanged = true;\n        await this.unload();\n        if (typeof patcherIn !== \"object\") {\n            this._state.isReady = true;\n            this._state.preventEmitChanged = false;\n            this.emit(\"ready\");\n            return this;\n        }\n        this.props.mode = patcherIn.props?.mode || modeIn || \"js\";\n        this.state.pkgMgr = new PackageManager(this);\n        const { mode } = this.props;\n        const $init: Promise<Box>[] = [];\n        let patcher;\n        if (mode === \"max\" || mode === \"gen\") {\n            if (!(patcherIn as TMaxPatcher).patcher) {\n                patcher = patcherIn;\n            } else {\n                patcher = max2js(patcherIn as TMaxPatcher);\n            }\n        } else if (mode === \"js\" || mode === \"faust\" || mode === \"jsaw\") {\n            if (\"data\" in patcherIn && \"patcher\" in patcherIn) {\n                patcher = patcherIn.patcher;\n            } else {\n                patcher = patcherIn;\n            }\n        }\n        if (patcher.props) this.props = { ...this.props, ...patcher.props, mode };\n        if (Array.isArray(this.props.bgColor)) this.props.bgColor = `rgba(${this.props.bgColor.join(\", \")})`;\n        if (Array.isArray(this.props.editingBgColor)) this.props.editingBgColor = `rgba(${this.props.editingBgColor.join(\", \")})`;\n        if (mode === \"js\" && this.props.dependencies) {\n            const { dependencies } = this.props;\n            if (!Array.isArray(dependencies)) {\n                this.props.dependencies = [];\n                for (const key in dependencies as Record<string, string>) {\n                    this.props.dependencies.push([key, dependencies[key]]);\n                }\n            }\n            let depNames = this.props.dependencies.map(t => t[0]);\n            try {\n                await this.env.taskMgr.newTask(this, `${this.file?.name || \"\"} Loading dependencies`, async (onUpdate: (newMsg: string) => any) => {\n                    for (let i = 0; i < this.props.dependencies.length; i++) {\n                        const [name, url] = this.props.dependencies[i];\n                        onUpdate(`${name} from ${url}`);\n                        try {\n                            await this._state.pkgMgr.importFromURL(url, name);\n                        } catch (e) {\n                            throw new Error(`Loading dependency: ${name} from ${url} failed`);\n                        }\n                        depNames = depNames.splice(i, 1);\n                    }\n                });\n            } catch (error) {\n                this.error((error as Error).message);\n            }\n        }\n        if (patcher.boxes) { // Boxes & data\n            for (const id in patcher.boxes) {\n                const $ = this.createBox(patcher.boxes[id]);\n                $init.push($);\n                const numID = parseInt(id.match(/\\d+/)[0]);\n                if (numID > this.props.boxIndexCount) this.props.boxIndexCount = numID;\n            }\n        }\n        await Promise.all($init);\n        if (patcher.lines) { // Lines\n            for (const id in patcher.lines) {\n                this.createLine(patcher.lines[id]);\n                const numID = parseInt(id.match(/\\d+/)[0]);\n                if (numID > this.props.lineIndexCount) this.props.lineIndexCount = numID;\n            }\n        }\n        this._state.isReady = true;\n        this._state.preventEmitChanged = false;\n        this.emitGraphChanged();\n        this.emit(\"ready\");\n        await Promise.all(Object.keys(this.boxes).map(id => this.boxes[id].postInit()));\n        this.emit(\"postInited\");\n        return this;\n    }\n    async getPatcherNode() {\n        if (this.props.mode === \"jsaw\" && this.env.thread === \"main\") {\n            const PatcherNode = (await import(\"../worklets/PatcherNode\")).default;\n            await PatcherNode.register(this.audioCtx.audioWorklet);\n            this.state.patcherNode = new PatcherNode(this.audioCtx, { env: this.env, instanceId: this.id, fileId: this.file?.id, data: this.file ? undefined : this.toSerializable() });\n            await this.state.patcherNode.init();\n            return this.state.patcherNode;\n        }\n        return null;\n    }\n    async loadFromURL(url: string) {\n        try {\n            const file = await fetch(url);\n            const parsed = await file.json() as RawPatcher | TMaxPatcher;\n            return this.load(parsed);\n        } catch (e) {\n            this.error(`Fetch file ${url} failed.`);\n        }\n        return this;\n    }\n    async loadFromString(sIn: string) {\n        try {\n            const parsed = JSON.parse(sIn) as RawPatcher | TMaxPatcher;\n            return this.load(parsed);\n        } catch (e) {\n            this.error(`Load from string: ${sIn.slice(20)}... failed.`);\n        }\n        return this;\n    }\n    async loadFromFile(file: File) {\n        const splitName = file.name.split(\".\");\n        const ext = splitName.pop();\n        const name = splitName.join(\".\");\n        const extMap: Record<string, PatcherMode> = { json: \"js\", jspat: \"js\", maxpat: \"max\", gendsp: \"gen\", dsppat: \"faust\" };\n        if (!extMap[ext]) return this;\n        const reader = new FileReader();\n        reader.onload = () => {\n            let parsed: RawPatcher | TMaxPatcher;\n            try {\n                parsed = JSON.parse(reader.result.toString());\n            } catch (e) {\n                this.error((e as Error).message);\n            }\n            if (parsed) {\n                this.load(parsed, extMap[ext]);\n                this._state.name = name;\n            }\n        };\n        reader.onerror = () => this.error(reader.error.message);\n        reader.readAsText(file, \"UTF-8\");\n        return this;\n    }\n    async unload() {\n        await this.emit(\"unload\");\n        if (Object.keys(this.boxes).length) {\n            this._state.preventEmitChanged = true;\n            await Promise.all(Object.keys(this.boxes).map(id => this.boxes[id].destroy()));\n            this._state.preventEmitChanged = false;\n            this.emitGraphChanged();\n        }\n        this.lines = {};\n        this.boxes = {};\n        this.props = {\n            mode: \"js\",\n            dependencies: Patcher.props.dependencies.default,\n            bgColor: Patcher.props.bgColor.default,\n            editingBgColor: Patcher.props.editingBgColor.default,\n            grid: Patcher.props.grid.default,\n            openInPresentation: Patcher.props.openInPresentation.default,\n            boxIndexCount: 0,\n            lineIndexCount: 0\n        };\n        this._state.selected = [];\n    }\n    async destroy() {\n        await this.unload();\n        await super.destroy();\n    }\n    async addPackage(namespace: string, url: string) {\n        const { dependencies } = this.props;\n        await this.state.pkgMgr.importFromURL(url, namespace);\n        dependencies.push([namespace, url]);\n        this.setProps({ dependencies: dependencies.slice() });\n    }\n    removePackage(id: string) {\n        const { dependencies } = this.props;\n        const i = dependencies.findIndex(t => t[0] === id);\n        if (i === -1) return;\n        dependencies.splice(i, 1);\n        this.state.pkgMgr.remove(id);\n        this.setProps({ dependencies: dependencies.slice() });\n    }\n    async createBox(boxIn: TBox) {\n        if (!boxIn.id || (boxIn.id in this.boxes)) boxIn.id = \"box-\" + ++this.props.boxIndexCount;\n        const box = new Box(this, boxIn);\n        this.boxes[box.id] = box;\n        await box.init();\n        this.emitGraphChanged();\n        return box;\n    }\n    getObjectConstructor(parsed: { class: string; args: any[]; props: Record<string, any> }) {\n        const className = parsed.class;\n        if (typeof className !== \"string\" || className.length === 0) return this.activeLib.EmptyObject;\n        if (this.activeLib[className]) return this.activeLib[className];\n        this.error(`Object ${className} not found.`);\n        return this.activeLib.InvalidObject;\n    }\n    getObjectMeta(parsed: { class: string; args: any[]; props: Record<string, any> }) {\n        return this.getObjectConstructor(parsed).meta;\n    }\n    async changeBoxText(boxId: string, text: string) {\n        const oldText = this.boxes[boxId].text;\n        if (oldText === text) return this.boxes[boxId];\n        await this.boxes[boxId].changeText(text);\n        this.emit(\"changeBoxText\", { oldText, text, boxId });\n        return this.boxes[boxId];\n    }\n    async deleteBox(boxId: string) {\n        const box = this.boxes[boxId];\n        if (!box) return null;\n        await box.destroy();\n        this.emitGraphChanged();\n        return box;\n    }\n    createLine(lineIn: TLine) {\n        if (!this.canCreateLine(lineIn)) return null;\n        if (!lineIn.id || (lineIn.id in this.lines)) lineIn.id = \"line-\" + ++this.props.lineIndexCount;\n        const line = new Line(this, lineIn);\n        this.lines[line.id] = line;\n        line.enable();\n        this.emitGraphChanged();\n        return line;\n    }\n    canCreateLine(lineIn: TLine) {\n        if (lineIn.src[1] >= this.boxes[lineIn.src[0]].outlets) return false;\n        if (lineIn.dest[1] >= this.boxes[lineIn.dest[0]].inlets) return false;\n        if (this.getLinesByBox(lineIn.src[0], lineIn.dest[0], lineIn.src[1], lineIn.dest[1]).length > 0) return false;\n        return true;\n    }\n    deleteLine(lineId: string) {\n        const line = this.lines[lineId];\n        if (!line) return null;\n        line.destroy();\n        if (!this._state.preventEmitChanged) this.emit(\"passiveDeleteLine\", line);\n        this.emitGraphChanged();\n        return line;\n    }\n    changeLineSrc(lineId: string, srcId: string, srcOutlet: number) {\n        const line = this.lines[lineId];\n        // if (this.instance.getLinesByBox(srcId, line.destId, srcOutlet, line.destInlet).length > 0) return line;\n        const oldSrc: [string, number] = [line.srcId, line.srcOutlet];\n        const src: [string, number] = [srcId, srcOutlet];\n        line.setSrc(src);\n        this.emitGraphChanged();\n        return { lineId, oldSrc, src };\n    }\n    changeLineDest(lineId: string, destId: string, destOutlet: number) {\n        const line = this.lines[lineId];\n        // if (this.getLinesByBox(line.srcId, destId, line.destInlet, destOutlet).length > 0) return line;\n        const oldDest: [string, number] = [line.destId, line.destInlet];\n        const dest: [string, number] = [destId, destOutlet];\n        line.setDest(dest);\n        this.emitGraphChanged();\n        return { lineId, oldDest, dest };\n    }\n    getLinesBySrcID(srcId: string) {\n        const result = [];\n        for (let i = 0; i < this.boxes[srcId].outlets; i++) { // Array.fill fills the array with same instance\n            result[i] = [];\n        }\n        for (const id in this.lines) {\n            const line = this.lines[id];\n            if (line && line.srcId === srcId) {\n                const srcOutlet = line.srcOutlet;\n                if (!result[srcOutlet]) result[srcOutlet] = [id];\n                else result[srcOutlet].push(id);\n            }\n        }\n        return result;\n    }\n    getLinesByDestID(destId: string) {\n        const result = [];\n        for (let i = 0; i < this.boxes[destId].inlets; i++) {\n            result[i] = [];\n        }\n        for (const id in this.lines) {\n            const line = this.lines[id];\n            if (line && line.destId === destId) {\n                const destInlet = line.destInlet;\n                if (!result[destInlet]) result[destInlet] = [id];\n                else result[destInlet].push(id);\n            }\n        }\n        return result;\n    }\n    getLinesByBox(srcId: string, destId: string, srcOutlet?: number, destInlet?: number) {\n        const result: string[] = [];\n        let srcOuts: string[] = [];\n        let destIns: string[] = [];\n        const srcOutsWraped = this.getLinesBySrcID(srcId);\n        if (srcOutlet !== undefined) srcOuts = srcOutsWraped[srcOutlet];\n        else srcOutsWraped.forEach(el => srcOuts = srcOuts.concat(el));\n        const destInsWraped = this.getLinesByDestID(destId);\n        if (destInlet !== undefined) destIns = destInsWraped[destInlet];\n        else destInsWraped.forEach(el => destIns = destIns.concat(el));\n        if (!srcOuts || !destIns) return result;\n        srcOuts.forEach(idOut => destIns.forEach(idIn => (idIn === idOut ? result.push(idIn) : undefined)));\n        return result;\n    }\n    fn(data: any, inlet: number) {\n        this.emit(\"dataInput\", { data, inlet });\n    }\n    inputAudio(input: number, index: number, sample: number) {\n        this.emit(\"audioInput\", { input, index, sample });\n    }\n    inputParam(param: string, index: number, sample: number) {\n        this.emit(\"paramInput\", { param, index, sample });\n    }\n    outputAudio(output: number, index: number, sample: number) {\n        this.emit(\"audioOutput\", { output, index, sample });\n    }\n    outlet(outlet: number, data: any) {\n        this.emit(\"dataOutput\", { data, outlet });\n    }\n    get inletAudioConnections() {\n        return this._inletAudioConnections;\n    }\n    get outletAudioConnections() {\n        return this._outletAudioConnections;\n    }\n    connectAudioInlet(index: number) {\n        this.emit(\"connectAudioInlet\", index);\n    }\n    connectAudioOutlet(index: number) {\n        this.emit(\"connectAudioOutlet\", index);\n    }\n    disconnectAudioInlet(index: number) {\n        this.emit(\"disconnectAudioInlet\", index);\n    }\n    disconnectAudioOutlet(index: number) {\n        this.emit(\"disconnectAudioOutlet\", index);\n    }\n    changeIO() {\n        this.emit(\"ioChanged\", this.meta);\n    }\n    inspectAudioIO() {\n        const inputBoxes: Box[] = [];\n        const outputBoxes: Box[] = [];\n        const parametersBoxes: [string, Box][] = [];\n        for (const boxId in this.boxes) {\n            const box = this.boxes[boxId];\n            const arg0 = box.args[0];\n            const port = Math.max(1, ~~arg0) - 1;\n            if (box.meta.isPatcherInlet === \"audio\") inputBoxes[port] = box;\n            else if (box.meta.isPatcherInlet === \"parameter\") parametersBoxes.push([arg0, box]);\n            else if (box.meta.isPatcherOutlet === \"audio\") outputBoxes[port] = box;\n        }\n        for (let i = 0; i < this._inletAudioConnections.length; i++) {\n            if (!inputBoxes[i]) delete this._inletAudioConnections[i];\n        }\n        for (let i = 0; i < this._outletAudioConnections.length; i++) {\n            if (!outputBoxes[i]) delete this._outletAudioConnections[i];\n        }\n        return { inputBoxes, outputBoxes, parametersBoxes };\n    }\n    get meta(): IJSPatcherObjectMeta {\n        const { metaFromPatcher } = this;\n        return {\n            package: this.props.package || \"\",\n            name: this.props.name || \"\",\n            icon: null,\n            author: this.props.author || \"\",\n            version: this.props.version || \"\",\n            description: this.props.description || \"\",\n            isPatcherInlet: false,\n            isPatcherOutlet: false,\n            ...metaFromPatcher\n        };\n    }\n    get metaFromPatcher(): Pick<IJSPatcherObjectMeta, \"inlets\" | \"outlets\" | \"args\" | \"props\"> {\n        const inlets: IJSPatcherObjectMeta[\"inlets\"] = [];\n        const outlets: IJSPatcherObjectMeta[\"outlets\"] = [];\n        for (const boxId in this.boxes) {\n            const box = this.boxes[boxId] as Box<IJSPatcherObject<any, any, any[], any[], any[], { description: string; type: TMetaType }>>;\n            const port = Math.max(1, ~~box.args[0]) - 1;\n            const description = box.props.description || \"\";\n            if (box.meta.isPatcherInlet === \"data\" && !inlets[port]) {\n                inlets[port] = {\n                    isHot: true,\n                    type: box.props.type || \"anything\",\n                    description\n                };\n            } else if (box.meta.isPatcherInlet === \"audio\") {\n                inlets[port] = {\n                    isHot: true,\n                    type: \"signal\",\n                    description\n                };\n            } else if (box.meta.isPatcherOutlet === \"data\" && !outlets[port]) {\n                outlets[port] = {\n                    type: box.props.type || \"anything\",\n                    description\n                };\n            } else if (box.meta.isPatcherOutlet === \"audio\") {\n                outlets[port] = {\n                    type: \"signal\",\n                    description\n                };\n            }\n        }\n        return { inlets, outlets, args: [], props: {} };\n    }\n    log(message: string) {\n        this.newLog(\"none\", \"Patcher\", message, this);\n    }\n    error(message: string) {\n        this.newLog(\"error\", \"Patcher\", message, this);\n    }\n    newLog(errorLevel: TErrorLevel, title: string, message: string, emitter?: any) {\n        this.env.newLog(errorLevel, title, message, emitter);\n    }\n    setProps(props: Partial<TPublicPatcherProps>) {\n        let changed = false;\n        for (const keyIn in props) {\n            const key = keyIn as keyof TPublicPatcherProps;\n            if (this.props[key] === props[key]) continue;\n            changed = true;\n            (this.props as any)[key] = props[key];\n            this.emit(key, props[key]);\n        }\n        if (changed) {\n            this.emit(\"propsChanged\", props);\n            this.emitChanged();\n        }\n    }\n    get publicProps() {\n        const { dependencies, bgColor, editingBgColor, grid, openInPresentation } = this.props;\n        return { dependencies, bgColor, editingBgColor, grid, openInPresentation } as TPublicPatcherProps;\n    }\n    toFaustDspCode() {\n        const code = toFaustDspCode(this);\n        return code;\n    }\n    toString(spacing?: number) {\n        if (this.props.mode === \"max\" || this.props.mode === \"gen\") {\n            return JSON.stringify(js2max(this), undefined, spacing);\n        }\n        const { props } = this;\n        const boxes: RawPatcher[\"boxes\"] = {};\n        const lines: RawPatcher[\"lines\"] = {};\n        for (const id in this.boxes) {\n            boxes[id] = this.boxes[id].toSerializable();\n        }\n        for (const id in this.lines) {\n            lines[id] = this.lines[id].toSerializable();\n        }\n        return JSON.stringify({ boxes, lines, props }, undefined, spacing);\n    }\n    toSerializable(): RawPatcher {\n        return JSON.parse(this.toString());\n    }\n    serialize() {\n        return new Blob([this.toString()]).arrayBuffer();\n    }\n}\n","import type { SemanticICONS } from \"semantic-ui-react\";\nimport { isRectMovable, isRectResizable, isTRect } from \"../../utils/utils\";\nimport FileEditor from \"../file/FileEditor\";\nimport Box from \"./Box\";\nimport Line from \"./Line\";\nimport type { RawPatcher, TBox, TLine, TMaxClipboard, TRect, TResizeHandlerType } from \"../types\";\nimport type Patcher from \"./Patcher\";\nimport type PersistentProjectFile from \"../file/PersistentProjectFile\";\nimport type TempPatcherFile from \"./TempPatcherFile\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\nimport type { PatcherEventMap } from \"./Patcher\";\n\nexport interface PatcherEditorEventMap extends PatcherEditorState {\n    \"create\": RawPatcher;\n    \"delete\": RawPatcher;\n    \"changeBoxText\": { boxId: string; oldText: string; text: string };\n    \"boxChanged\": { boxId: string; oldArgs?: any[]; args?: any[]; oldProps?: Record<string, any>; props?: Record<string, any>; oldState?: Record<string, any>; state?: Record<string, any> };\n    \"changeLineSrc\": { lineId: string; oldSrc: [string, number]; src: [string, number] };\n    \"changeLineDest\": { lineId: string; oldDest: [string, number]; dest: [string, number] };\n    \"selected\": string[];\n    \"moving\": { selected: string[]; delta: { x: number; y: number }; presentation: boolean };\n    \"moved\": { selected: string[]; delta: { x: number; y: number }; presentation: boolean };\n    \"resized\": { selected: string[]; delta: { x: number; y: number }; type: TResizeHandlerType; presentation: boolean };\n    \"tempLine\": { findSrc: boolean; from: [string, number] };\n    \"inspector\": never;\n    \"dockUI\": string;\n}\n\nexport interface PatcherHistoryEventMap extends Pick<PatcherEditorEventMap, \"create\" | \"delete\" | \"changeBoxText\" | \"changeLineSrc\" | \"changeLineDest\" | \"moved\" | \"resized\" | \"boxChanged\"> {}\n\nexport interface PatcherEditorState {\n    locked: boolean;\n    presentation: boolean;\n    showGrid: boolean;\n    snapToGrid: boolean;\n    selected: string[];\n}\n\nexport default class PatcherEditor extends FileEditor<Patcher, PatcherEditorEventMap> {\n    static async fromProjectItem({ file, env, project, instanceId }: { file: PersistentProjectFile | TempPatcherFile; env: IJSPatcherEnv; project?: IProject; instanceId?: string }): Promise<PatcherEditor> {\n        const patcher = await file.instantiate({ env, project, instanceId }) as Patcher;\n        const editor = new this(patcher);\n        return editor.init();\n    }\n    state: PatcherEditorState = {\n        locked: true,\n        presentation: false,\n        showGrid: true,\n        snapToGrid: true,\n        selected: []\n    };\n    get isLocked() {\n        return this.state.locked;\n    }\n    get boxes() {\n        return this.instance.boxes;\n    }\n    get lines() {\n        return this.instance.lines;\n    }\n    get props() {\n        return this.instance.props;\n    }\n    get publicProps() {\n        return this.instance.publicProps;\n    }\n    get fileExtension() {\n        return this.instance.fileExtension;\n    }\n    get fileName() {\n        return this.instance.fileName;\n    }\n    get fileIcon(): SemanticICONS {\n        return \"sitemap\";\n    }\n    handleChangeBoxText = (e: PatcherEventMap[\"changeBoxText\"]) => this.emit(\"changeBoxText\", e);\n    handlePassiveDeleteLine = (e: PatcherEventMap[\"passiveDeleteLine\"]) => this.emit(\"delete\", { boxes: {}, lines: { [e.id]: e } });\n    handleBoxChanged = (e: PatcherEventMap[\"boxChanged\"]) => this.emit(\"boxChanged\", e);\n    handleChanged = () => this.instance.emitChanged();\n    constructor(instance: Patcher) {\n        super(instance);\n        const { openInPresentation } = this.props;\n        this.setState({\n            locked: true,\n            presentation: !!openInPresentation,\n            showGrid: true,\n            snapToGrid: true,\n            selected: []\n        });\n    }\n    async init() {\n        if (!this.instance.isReady) {\n            await new Promise<void>((resolve, reject) => {\n                const handleReady = () => {\n                    resolve();\n                    this.instance.off(\"ready\", handleReady);\n                };\n                this.instance.on(\"ready\", handleReady);\n            });\n        }\n        this.on(\"changed\", this.handleChanged);\n        this.instance.on(\"changeBoxText\", this.handleChangeBoxText);\n        this.instance.on(\"passiveDeleteLine\", this.handlePassiveDeleteLine);\n        this.instance.on(\"boxChanged\", this.handleBoxChanged);\n        const { openInPresentation } = this.props;\n        this.setState({\n            locked: true,\n            presentation: !!openInPresentation,\n            showGrid: true,\n            snapToGrid: true,\n            selected: []\n        });\n        this._isReady = true;\n        this.emit(\"ready\");\n        return this;\n    }\n    setState(state: Partial<PatcherEditorState>) {\n        let changed = false;\n        for (const keyIn in state) {\n            const key = keyIn as keyof PatcherEditorState;\n            if (this.state[key] === state[key]) continue;\n            changed = true;\n            if (key === \"locked\" || key === \"presentation\") this.deselectAll();\n            this.state[key] = state[key] as any;\n            this.emit(key, state[key]);\n        }\n        // if (changed) this.emit(\"stateChanged\", this.state);\n        return changed;\n    }\n    async createBox(boxIn: TBox) {\n        const box = await this.instance.createBox(boxIn);\n        this.emit(\"create\", { boxes: { [box.id]: box.toSerializable() }, lines: {} });\n        await box.postInit();\n        return box;\n    }\n    async createBoxFromFile(file: PersistentProjectFile, boxIn: Omit<TBox, \"text\">) {\n        const path = file.projectPath;\n        const type = file.type;\n        const ext = file.fileExtension;\n        if (type === \"patcher\") {\n            const extMap: Record<string, string> = this.props.mode === \"js\"\n                ? { json: \"p\", jspat: \"p\", maxpat: \"max\", gendsp: \"gen\", dsppat: \"pfaust\" }\n                : this.props.mode === \"faust\"\n                    ? { gendsp: \"gen\", dsppat: \"p\" }\n                    : this.props.mode === \"gen\"\n                        ? { gendsp: \"gen\" }\n                        : {};\n            const obj = extMap[ext];\n            if (obj) await this.createBox({ text: `${obj} ${path}`, ...boxIn });\n        } else if (type === \"audio\") {\n            await this.createBox({ text: `buffer~ ${path}`, ...boxIn });\n        } else if (type === \"image\") {\n            await this.createBox({ text: `img ${path}`, ...boxIn });\n        }\n    }\n    async deleteBox(boxId: string) {\n        this.deselect(boxId);\n        const box = await this.instance.deleteBox(boxId);\n        if (!box) return null;\n        this.emit(\"delete\", { boxes: { [box.id]: box.toSerializable() }, lines: {} });\n        return box;\n    }\n    createLine(lineIn: TLine) {\n        const line = this.instance.createLine(lineIn);\n        if (!line) return null;\n        this.emit(\"create\", { boxes: {}, lines: { [line.id]: line.toSerializable() } });\n        return line;\n    }\n    deleteLine(lineId: string) {\n        this.deselect(lineId);\n        const line = this.instance.deleteLine(lineId);\n        if (!line) return null;\n        this.emit(\"delete\", { boxes: {}, lines: { [line.id]: line.toSerializable() } });\n        return line;\n    }\n    changeLineSrc(lineId: string, srcId: string, srcOutlet: number) {\n        const e = this.instance.changeLineSrc(lineId, srcId, srcOutlet);\n        this.emit(\"changeLineSrc\", e);\n    }\n    changeLineDest(lineId: string, destId: string, destOutlet: number) {\n        const e = this.instance.changeLineDest(lineId, destId, destOutlet);\n        this.emit(\"changeLineDest\", e);\n    }\n    async changeBox(boxId: string, change: { args?: any[]; props?: Record<string, any>; state?: Record<string, any> }) {\n        await this.instance.boxes[boxId]?.changeObject(change);\n    }\n\n    select(...ids: string[]) {\n        ids.forEach((id) => {\n            if (this.state.selected.indexOf(id) >= 0) return;\n            if (this.boxes[id] || this.lines[id]) this.state.selected.push(id);\n        });\n        this.emit(\"selected\", this.state.selected.slice());\n    }\n    selectAllBoxes() {\n        let ids = Object.keys(this.boxes);\n        if (this.state.presentation) ids = ids.filter(id => this.boxes[id].presentation);\n        this.state.selected = ids;\n        this.emit(\"selected\", ids);\n    }\n    selectOnly(...ids: string[]) {\n        this.state.selected = [];\n        this.select(...ids);\n    }\n    deselect(...ids: string[]) {\n        ids.forEach((id) => {\n            const i = this.state.selected.indexOf(id);\n            if (i === -1) return;\n            this.state.selected.splice(i, 1);\n        });\n        this.emit(\"selected\", this.state.selected.slice());\n    }\n    deselectAll() {\n        this.state.selected = [];\n        this.emit(\"selected\", []);\n    }\n    selectedToString() {\n        const lineSet = new Set<Line>();\n        const patcher: RawPatcher = { lines: {}, boxes: {} };\n        this.state.selected\n            .filter(id => id.startsWith(\"box\") && this.boxes[id])\n            .map(id => this.boxes[id])\n            .forEach((box) => {\n                box.allLines.forEach(line => lineSet.add(line));\n                patcher.boxes[box.id] = box.toSerializable();\n            });\n        lineSet.forEach((line) => {\n            if (patcher.boxes[line.srcId] && patcher.boxes[line.destId]) patcher.lines[line.id] = line.toSerializable();\n        });\n        if (!Object.keys(patcher.boxes)) return undefined;\n        return JSON.stringify(patcher, undefined, 4);\n    }\n    async pasteToPatcher(clipboard: RawPatcher | TMaxClipboard) {\n        const idMap: Record<string, string> = {};\n        const pasted: RawPatcher = { boxes: {}, lines: {} };\n        if (!clipboard || !clipboard.boxes) return pasted;\n        const $init: Promise<Box>[] = [];\n        const $postInit: Promise<Box>[] = [];\n        if (Array.isArray(clipboard.boxes)) { // Max Patcher\n            this.instance.state.preventEmitChanged = true;\n            const maxBoxes = clipboard.boxes;\n            for (let i = 0; i < maxBoxes.length; i++) {\n                const maxBox = maxBoxes[i].box;\n                const numID = parseInt(maxBox.id.match(/\\d+/)[0]);\n                let id = \"box-\" + numID;\n                if (this.boxes[id]) {\n                    idMap[id] = \"box-\" + ++this.props.boxIndexCount;\n                    id = idMap[id];\n                } else {\n                    idMap[id] = id;\n                    if (numID > this.props.boxIndexCount) this.props.boxIndexCount = numID;\n                }\n                const box: TBox = {\n                    id,\n                    inlets: maxBox.numinlets,\n                    outlets: maxBox.numoutlets,\n                    rect: maxBox.patching_rect,\n                    text: (maxBox.maxclass === \"newobj\" ? \"\" : maxBox.maxclass + \" \") + (maxBox.text ? maxBox.text : \"\")\n                };\n                $init.push(this.instance.createBox(box));\n            }\n            const createdBoxes = (await Promise.all($init)).filter(box => !!box);\n            createdBoxes.forEach((box) => {\n                pasted.boxes[box.id] = box.toSerializable();\n                $postInit.push(box.postInit());\n            });\n            if (Array.isArray(clipboard.lines)) {\n                const maxLines = clipboard.lines;\n                for (let i = 0; i < maxLines.length; i++) {\n                    const lineArgs = maxLines[i].patchline;\n                    const id = \"line-\" + ++this.props.lineIndexCount;\n                    const line: TLine = {\n                        id,\n                        src: [idMap[lineArgs.source[0].replace(/obj/, \"box\")], lineArgs.source[1]],\n                        dest: [idMap[lineArgs.destination[0].replace(/obj/, \"box\")], lineArgs.destination[1]]\n                    };\n                    const createdLine = this.instance.createLine(line);\n                    if (createdLine) pasted.lines[createdLine.id] = createdLine.toSerializable();\n                }\n            }\n            this.instance.state.preventEmitChanged = false;\n            if (Object.keys(pasted.boxes).length) {\n                this.deselectAll();\n                this.select(...Object.keys(pasted.boxes));\n                this.emit(\"create\", pasted);\n                this.instance.emitGraphChanged();\n                await Promise.all($postInit);\n            }\n            return pasted;\n        }\n        if (Array.isArray(clipboard.boxes) || Array.isArray(clipboard.lines)) return pasted;\n        this.instance.state.preventEmitChanged = true;\n        for (const boxId in clipboard.boxes) {\n            const box = clipboard.boxes[boxId];\n            if (this.boxes[box.id]) {\n                idMap[box.id] = \"box-\" + ++this.props.boxIndexCount;\n                box.id = idMap[box.id];\n            } else {\n                idMap[box.id] = box.id;\n                const numID = parseInt(box.id.match(/\\d+/)[0]);\n                if (numID > this.props.boxIndexCount) this.props.boxIndexCount = numID;\n            }\n            box.rect = [box.rect[0] + 30, box.rect[1] + 30, box.rect[2], box.rect[3]];\n            $init.push(this.instance.createBox(box));\n        }\n        const createdBoxes = (await Promise.all($init)).filter(box => !!box);\n        createdBoxes.forEach((box) => {\n            pasted.boxes[box.id] = box.toSerializable();\n            $postInit.push(box.postInit());\n        });\n        await Promise.all($postInit);\n        for (const lineId in clipboard.lines) {\n            const line = clipboard.lines[lineId];\n            line.id = \"line-\" + ++this.props.lineIndexCount;\n            line.src[0] = idMap[line.src[0]];\n            line.dest[0] = idMap[line.dest[0]];\n            const createdLine = this.instance.createLine(line);\n            if (createdLine) pasted.lines[createdLine.id] = createdLine.toSerializable();\n        }\n        this.instance.state.preventEmitChanged = false;\n        if (Object.keys(pasted.boxes).length) {\n            this.deselectAll();\n            this.select(...Object.keys(pasted.boxes));\n            this.emit(\"create\", pasted);\n            this.instance.emitGraphChanged();\n        }\n        return pasted;\n    }\n    async create(objects: RawPatcher) {\n        const $init: Promise<Box>[] = [];\n        const $postInit: Promise<Box>[] = [];\n        const created: RawPatcher = { boxes: {}, lines: {} };\n        for (const boxId in objects.boxes) {\n            const boxIn = objects.boxes[boxId];\n            const box = new Box(this.instance, boxIn);\n            this.boxes[box.id] = box;\n            created.boxes[box.id] = box.toSerializable();\n            $init.push(box.init());\n            $postInit.push(box.postInit());\n        }\n        await Promise.all($init);\n        await Promise.all($postInit);\n        for (const lineId in objects.lines) {\n            const lineIn = objects.lines[lineId];\n            if (!this.instance.canCreateLine(lineIn)) continue;\n            const line = new Line(this.instance, lineIn);\n            this.lines[line.id] = line;\n            created.lines[line.id] = line.toSerializable();\n            line.enable();\n        }\n        this.deselectAll();\n        this.select(...Object.keys(objects.boxes));\n        this.emit(\"create\", created);\n        this.instance.emitGraphChanged();\n    }\n    async deleteSelected() {\n        const boxSet = new Set<Box>();\n        const lineSet = new Set<Line>();\n        this.state.selected.filter(id => id.startsWith(\"line\")).forEach(id => lineSet.add(this.lines[id]));\n        this.state.selected.filter(id => id.startsWith(\"box\")).forEach((id) => {\n            boxSet.add(this.boxes[id]);\n            this.boxes[id].allLines.forEach(line => lineSet.add(line));\n        });\n        if (!boxSet.size && !lineSet.size) return undefined;\n        this.state.selected = [];\n        const deleted: RawPatcher = { boxes: {}, lines: {} };\n        const promises: Promise<Box>[] = [];\n        lineSet.forEach((line) => {\n            deleted.lines[line.id] = line.toSerializable();\n            line.destroy();\n        });\n        boxSet.forEach((box) => {\n            deleted.boxes[box.id] = box.toSerializable();\n            promises.push(box.destroy());\n        });\n        await Promise.all(promises);\n        this.emit(\"selected\", this.state.selected.slice());\n        this.emit(\"delete\", deleted);\n        this.instance.emitGraphChanged();\n        return deleted;\n    }\n    async delete(objects: RawPatcher) {\n        const deleted: RawPatcher = { boxes: {}, lines: {} };\n        for (const id in objects.lines) {\n            deleted.lines[id] = this.lines[id].destroy().toSerializable();\n        }\n        const promises: Promise<Box>[] = [];\n        for (const id in objects.boxes) {\n            deleted.boxes[id] = this.boxes[id].toSerializable();\n            promises.push(this.boxes[id].destroy());\n        }\n        await Promise.all(promises);\n        this.emit(\"selected\", this.state.selected.slice());\n        this.emit(\"delete\", deleted);\n        this.instance.emitGraphChanged();\n    }\n    async cut() {\n        if (this.state.locked) return;\n        await this.copy();\n        this.deleteSelected();\n    }\n    async copy() {\n        if (this.state.locked) return;\n        const s = this.selectedToString();\n        if (!s) return;\n        await navigator.clipboard.writeText(s);\n    }\n    async paste() {\n        if (this.state.locked) return;\n        const s = await navigator.clipboard.readText();\n        if (!s) return;\n        let parsed: RawPatcher | TMaxClipboard;\n        try {\n            parsed = JSON.parse(s);\n        } catch (e) {} // eslint-disable-line no-empty\n        await this.pasteToPatcher(parsed);\n    }\n    async duplicate() {\n        if (this.state.locked) return;\n        const s = this.selectedToString();\n        if (!s) return;\n        let parsed: RawPatcher | TMaxClipboard;\n        try {\n            parsed = JSON.parse(s);\n        } catch (e) {} // eslint-disable-line no-empty\n        await this.pasteToPatcher(parsed);\n    }\n    async selectAll() {\n        this.selectAllBoxes();\n    }\n    selectRegion(selectionRect: number[], selectedBefore: string[]) {\n        let [left, top, right, bottom] = selectionRect;\n        if (left > right) [left, right] = [right, left];\n        if (top > bottom) [top, bottom] = [bottom, top];\n        const { presentation } = this.state;\n        const rectKey = presentation ? \"presentationRect\" : \"rect\";\n        const select = selectedBefore.slice();\n        for (const boxId in this.boxes) {\n            const box = this.boxes[boxId];\n            if (presentation && !box.presentation) continue;\n            const rect = box[rectKey];\n            if (!isTRect(rect)) continue;\n            const [boxLeft, boxTop, boxWidth, boxHeight] = rect;\n            const [boxRight, boxBottom] = [boxLeft + boxWidth, boxTop + boxHeight];\n            if (boxLeft < right && boxTop < bottom && boxRight > left && boxBottom > top) {\n                const i = select.indexOf(boxId);\n                if (i === -1) select.push(boxId);\n                else select.splice(i, 1);\n            }\n        }\n        const deselect = this.state.selected.filter(id => select.indexOf(id) === -1);\n        this.select(...select);\n        this.deselect(...deselect);\n    }\n    moveSelectedBox(dragOffset: { x: number; y: number }, refBoxID?: string) {\n        const { presentation, snapToGrid, selected } = this.state;\n        const rectKey = presentation ? \"presentationRect\" : \"rect\";\n        const delta = { ...dragOffset };\n        if (refBoxID) {\n            const rect = this.boxes[refBoxID][rectKey];\n            if (!isRectMovable(rect)) return { x: 0, y: 0 };\n            delta.x = snapToGrid ? Math.round((rect[0] + dragOffset.x) / this.props.grid[0]) * this.props.grid[0] - rect[0] : dragOffset.x;\n            delta.y = snapToGrid ? Math.round((rect[1] + dragOffset.y) / this.props.grid[1]) * this.props.grid[1] - rect[1] : dragOffset.y;\n        }\n        if (!delta.x && !delta.y) return dragOffset;\n        this.move(selected, delta, presentation);\n        return { x: dragOffset.x - delta.x, y: dragOffset.y - delta.y };\n    }\n    moveEnd(delta: { x: number; y: number }) {\n        const { presentation, selected } = this.state;\n        const rectKey = presentation ? \"presentationRect\" : \"rect\";\n        let ids = selected.filter(id => id.startsWith(\"box\") && this.boxes[id]);\n        if (presentation) ids = ids.filter(id => isRectMovable(this.boxes[id][rectKey]));\n        const boxes = ids.map(id => this.boxes[id]);\n        boxes.forEach(box => box.emit(presentation ? \"presentationRectChanged\" : \"rectChanged\", box));\n        this.emit(\"moved\", { delta, selected: ids, presentation: this.state.presentation });\n    }\n    move(selected: string[], delta: { x: number; y: number }, presentation: boolean) {\n        this.select(...selected);\n        const rectKey = presentation ? \"presentationRect\" : \"rect\";\n        let ids = selected.filter(id => id.startsWith(\"box\") && this.boxes[id]);\n        if (presentation) ids = ids.filter(id => isRectMovable(this.boxes[id][rectKey]));\n        const boxes = ids.map(id => this.boxes[id]);\n        if (boxes.length === 0) return;\n        let [left, top] = boxes[0][rectKey] as TRect;\n        for (let i = 1; i < boxes.length; i++) {\n            const box = boxes[i];\n            const [$left, $top] = box[rectKey] as TRect;\n            if ($left < left) left = $left;\n            if ($top < top) top = $top;\n        }\n        // Not allowing resize out of bound\n        delta.x = Math.max(delta.x, -left);\n        delta.y = Math.max(delta.y, -top);\n        if (delta.x) boxes.forEach(box => (box[rectKey] as TRect)[0] += delta.x);\n        if (delta.y) boxes.forEach(box => (box[rectKey] as TRect)[1] += delta.y);\n        // Emit events\n        if (!delta.x && !delta.y) return;\n        if (presentation !== this.state.presentation) return;\n        // boxes.forEach(box => box.emit(presentation ? \"presentationRectChanged\" : \"rectChanged\", box));\n        this.emit(\"moving\", { selected: ids, delta, presentation });\n        if (presentation) return;\n        const lineSet = new Set<Line>();\n        boxes.forEach((box) => {\n            box.inletLines.forEach(set => set.forEach(line => lineSet.add(line)));\n            box.outletLines.forEach(set => set.forEach(line => lineSet.add(line)));\n        });\n        lineSet.forEach(line => line.emit(\"posChanged\", line));\n    }\n    resizeSelectedBox(boxId: string, dragOffset: { x: number; y: number }, type: TResizeHandlerType) {\n        const { presentation, snapToGrid, selected } = this.state;\n        const rectKey = presentation ? \"presentationRect\" : \"rect\";\n        const rect = this.boxes[boxId][rectKey];\n        if (!isRectResizable(rect)) return { x: 0, y: 0 };\n        const delta = { x: 0, y: 0 };\n        // Round delta to grid\n        if (type === \"e\" || type === \"se\" || type === \"ne\") {\n            delta.x = snapToGrid ? Math.round((rect[0] + rect[2] + dragOffset.x) / this.props.grid[0]) * this.props.grid[0] - rect[0] - rect[2] : dragOffset.x;\n        }\n        if (type === \"s\" || type === \"se\" || type === \"sw\") {\n            delta.y = snapToGrid ? Math.round((rect[1] + rect[3] + dragOffset.y) / this.props.grid[1]) * this.props.grid[1] - rect[1] - rect[3] : dragOffset.y;\n        }\n        if (type === \"w\" || type === \"nw\" || type === \"sw\") {\n            delta.x = snapToGrid ? Math.round((rect[0] + dragOffset.x) / this.props.grid[0]) * this.props.grid[0] - rect[0] : dragOffset.x;\n        }\n        if (type === \"n\" || type === \"nw\" || type === \"ne\") {\n            delta.y = snapToGrid ? Math.round((rect[1] + dragOffset.y) / this.props.grid[1]) * this.props.grid[1] - rect[1] : dragOffset.y;\n        }\n        if (!delta.x && !delta.y) return dragOffset;\n        this.resize(selected, delta, type, presentation);\n        return { x: dragOffset.x - delta.x, y: dragOffset.y - delta.y };\n    }\n    resizeEnd(delta: { x: number; y: number }, type: TResizeHandlerType) {\n        const { selected, presentation } = this.state;\n        this.emit(\"resized\", { delta, type, selected, presentation });\n    }\n    resize(selected: string[], delta: { x: number; y: number }, type: TResizeHandlerType, presentation: boolean) {\n        this.select(...selected);\n        const rectKey = presentation ? \"presentationRect\" : \"rect\";\n        let ids = selected.filter(id => id.startsWith(\"box\") && this.boxes[id]);\n        if (presentation) ids = ids.filter(id => isRectResizable(this.boxes[id][rectKey]));\n        const boxes = ids.map(id => this.boxes[id]);\n        if (boxes.length === 0) return;\n        let [left, top, width, height] = boxes[0][rectKey] as TRect;\n        for (let i = 1; i < boxes.length; i++) {\n            const box = boxes[i];\n            const [$left, $top, $width, $height] = box[rectKey] as TRect;\n            if ($left < left) left = $left;\n            if ($top < top) top = $top;\n            if ($width < width) width = $width;\n            if ($height < height) height = $height;\n        }\n        // Not allowing resize out of bound\n        if (type === \"sw\" || type === \"w\" || type === \"nw\") delta.x = Math.max(delta.x, -left);\n        if (type === \"nw\" || type === \"n\" || type === \"ne\") delta.y = Math.max(delta.y, -top);\n        // Not allowing resize below 15px width or height\n        if (type === \"ne\" || type === \"e\" || type === \"se\") delta.x = Math.max(delta.x, 15 - width);\n        if (type === \"sw\" || type === \"w\" || type === \"nw\") delta.x = Math.min(delta.x, width - 15);\n        if (type === \"se\" || type === \"s\" || type === \"sw\") delta.y = Math.max(delta.y, 15 - height);\n        if (type === \"nw\" || type === \"n\" || type === \"ne\") delta.y = Math.min(delta.y, height - 15);\n        boxes.forEach((box) => {\n            const sizingX = box.UI ? box.UI?.sizing === \"horizontal\" || box.UI?.sizing === \"both\" : true;\n            const sizingY = box.UI ? box.UI?.sizing === \"vertical\" || box.UI?.sizing === \"both\" : true;\n            if (delta.x && sizingX) {\n                if (type === \"ne\" || type === \"e\" || type === \"se\") (box[rectKey] as TRect)[2] += delta.x;\n                if (type === \"sw\" || type === \"w\" || type === \"nw\") {\n                    (box[rectKey] as TRect)[2] -= delta.x;\n                    (box[rectKey] as TRect)[0] += delta.x;\n                }\n            }\n            if (delta.y && sizingY) {\n                if (type === \"se\" || type === \"s\" || type === \"sw\") (box[rectKey] as TRect)[3] += delta.y;\n                if (type === \"nw\" || type === \"n\" || type === \"ne\") {\n                    (box[rectKey] as TRect)[3] -= delta.y;\n                    (box[rectKey] as TRect)[1] += delta.y;\n                }\n            }\n        });\n        // Emit events\n        if (!delta.x && !delta.y) return;\n        if (presentation !== this.state.presentation) return;\n        boxes.forEach(box => box.emit(presentation ? \"presentationRectChanged\" : \"rectChanged\", box));\n        if (presentation) return;\n        const lineSet = new Set<Line>();\n        boxes.forEach((box) => {\n            box.inletLines.forEach(set => set.forEach(line => lineSet.add(line)));\n            box.outletLines.forEach(set => set.forEach(line => lineSet.add(line)));\n        });\n        lineSet.forEach(line => line.emit(\"posChanged\", line));\n    }\n    findNearestPort(findSrc: boolean, left: number, top: number, from: [string, number], to?: [string, number]) {\n        let nearest: [string, number] = [null, null];\n        let minDistance = 100;\n        if (to) {\n            const currentPos = this.boxes[to[0]][findSrc ? \"getOutletPos\" : \"getInletPos\"](to[1]);\n            const currentDistance = ((currentPos.left - left) ** 2 + (currentPos.top - top) ** 2) ** 0.5;\n            if (currentDistance < 100) {\n                nearest = to;\n                minDistance = currentDistance;\n            }\n        }\n        for (const id in this.boxes) {\n            const box = this.boxes[id];\n            box[findSrc ? \"outletsPositions\" : \"inletsPositions\"].forEach((pos, i) => {\n                const distance = ((pos.left - left) ** 2 + (pos.top - top) ** 2) ** 0.5;\n                if (distance < minDistance) {\n                    const canCreate = this.instance.canCreateLine({ src: findSrc ? [id, i] : from, dest: findSrc ? from : [id, i] });\n                    if (!canCreate) return;\n                    nearest = [id, i];\n                    minDistance = distance;\n                }\n            });\n        }\n        return nearest;\n    }\n    highlightNearestPort(findSrc: boolean, dragOffset: { x: number; y: number }, from: [string, number], to?: [string, number]) { // to = the port need to be reconnect\n        const origPos = to ? this.boxes[to[0]][findSrc ? \"getOutletPos\" : \"getInletPos\"](to[1]) : this.boxes[from[0]][findSrc ? \"getInletPos\" : \"getOutletPos\"](from[1]);\n        const left = origPos.left + dragOffset.x;\n        const top = origPos.top + dragOffset.y;\n        const nearest = this.findNearestPort(findSrc, left, top, from, to);\n        for (const id in this.boxes) {\n            const box = this.boxes[id];\n            for (let i = 0; i < box[findSrc ? \"outlets\" : \"inlets\"]; i++) {\n                box.highlightPort(findSrc, i, nearest[0] === id && nearest[1] === i);\n            }\n        }\n        return nearest;\n    }\n    tempLine(findSrc: boolean, from: [string, number]) {\n        this.emit(\"tempLine\", { findSrc, from });\n        return this;\n    }\n    inspector(box?: Box) {\n        if (box) this.emit(\"inspector\");\n        else if (this.state.selected.length) {\n            const found = this.state.selected.find(id => id.startsWith(\"box\"));\n            if (found && this.boxes[found]) this.emit(\"inspector\");\n        }\n    }\n    dockUI(box?: Box) {\n        if (box && box.UI.dockable) this.emit(\"dockUI\", box.id);\n        else if (this.state.selected.length) {\n            const found = this.state.selected.find(id => id.startsWith(\"box\"));\n            if (found && this.boxes[found] && this.boxes[found].UI.dockable) this.emit(\"dockUI\", found);\n        }\n    }\n    onUiResized() {}\n    async toTempData() {\n        return this.instance.toSerializable();\n    }\n}\n","import History from \"../file/History\";\nimport PatcherEditor, { PatcherHistoryEventMap } from \"./PatcherEditor\";\n\nexport default class PatcherHistory extends History<PatcherHistoryEventMap, PatcherEditor> {\n    get eventListening(): (keyof PatcherHistoryEventMap)[] {\n        return [\n            \"create\", \"delete\", \"changeBoxText\", \"boxChanged\",\n            \"changeLineSrc\", \"changeLineDest\", \"moved\", \"resized\"\n        ];\n    }\n    async undoOf(editor: PatcherEditor, eventName: keyof PatcherHistoryEventMap, eventData?: any) {\n        if (eventName === \"delete\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            await editor.create(e);\n        } else if (eventName === \"changeBoxText\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { boxId, oldText } = e;\n            await editor.instance.changeBoxText(boxId, oldText);\n        } else if (eventName === \"boxChanged\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { boxId, oldArgs, oldProps, oldState } = e;\n            await editor.changeBox(boxId, { args: oldArgs, props: oldProps, state: oldState });\n        } else if (eventName === \"moved\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { selected, delta, presentation } = e;\n            const d = { x: -1 * delta.x, y: -1 * delta.y };\n            editor.move(selected, d, presentation);\n            editor.moveEnd(d);\n        } else if (eventName === \"changeLineSrc\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { lineId, oldSrc } = e;\n            editor.changeLineSrc(lineId, oldSrc[0], oldSrc[1]);\n        } else if (eventName === \"changeLineDest\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { lineId, oldDest } = e;\n            editor.changeLineDest(lineId, oldDest[0], oldDest[1]);\n        } else if (eventName === \"create\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            await editor.delete(e);\n        } else if (eventName === \"resized\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { selected, delta, type: t, presentation } = e;\n            const d = { x: -1 * delta.x, y: -1 * delta.y };\n            editor.resize(selected, d, t, presentation);\n            editor.resizeEnd(d, t);\n        }\n    }\n    async redoOf(editor: PatcherEditor, eventName: keyof PatcherHistoryEventMap, eventData?: any) {\n        if (eventName === \"create\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            await editor.create(e);\n        } else if (eventName === \"changeBoxText\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { boxId, text } = e;\n            await editor.instance.changeBoxText(boxId, text);\n        } else if (eventName === \"boxChanged\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { boxId, args, props, state } = e;\n            await editor.changeBox(boxId, { args, props, state });\n        } else if (eventName === \"moved\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { selected, delta, presentation } = e;\n            editor.move(selected, delta, presentation);\n            editor.moveEnd(delta);\n        } else if (eventName === \"changeLineSrc\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { lineId, src } = e;\n            editor.changeLineSrc(lineId, src[0], src[1]);\n        } else if (eventName === \"changeLineDest\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { lineId, dest } = e;\n            editor.changeLineDest(lineId, dest[0], dest[1]);\n        } else if (eventName === \"delete\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            await editor.delete(e);\n        } else if (eventName === \"resized\") {\n            const e: PatcherHistoryEventMap[typeof eventName] = eventData;\n            const { selected, delta, type: t, presentation } = e;\n            editor.resize(selected, delta, t, presentation);\n            editor.resizeEnd(delta, t);\n        }\n    }\n}\n","import TemporaryProjectFile from \"../file/TemporaryProjectFile\";\nimport type { RawPatcher } from \"../types\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\n\nexport default class TempPatcherFile extends TemporaryProjectFile<RawPatcher> {\n    get type() {\n        return \"patcher\" as const;\n    }\n    async instantiate({ env, project, instanceId }: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }) {\n        const Patcher = (await import(\"./Patcher\")).default;\n        const patcher = new Patcher({ file: this, env, project, instanceId });\n        await patcher.load(this.data);\n        return patcher;\n    }\n    async instantiateEditor({ env, project, instanceId }: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }) {\n        const PatcherEditor = (await import(\"./PatcherEditor\")).default;\n        return PatcherEditor.fromProjectItem({ file: this, env, project, instanceId });\n    }\n}\n","import TemporaryProjectFile from \"../file/TemporaryProjectFile\";\nimport type PatcherText from \"./PatcherText\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\n\nexport default class TempTextFile extends TemporaryProjectFile<PatcherText> {\n    get type() {\n        return \"text\" as const;\n    }\n    async instantiate() {\n        return this.data;\n    }\n    async instantiateEditor({ env, project, instanceId }: { env: IJSPatcherEnv; project?: IProject; instanceId?: string }) {\n        const TextEditor = (await import(\"./TextEditor\")).default;\n        return TextEditor.fromProjectItem({ file: this, env, project, instanceId });\n    }\n}\n","import { AudioWorkletGlobalScope, MessagePortRequest, MessagePortResponse, TypedMessageEvent } from \"./TypedAudioWorklet\";\nimport { AudioWorkletProxyProcessor } from \"./AudioWorkletProxyProcessor.types\";\n\ndeclare const globalThis: AudioWorkletGlobalScope;\nconst { AudioWorkletProcessor } = globalThis;\n\nconst Processor = class extends AudioWorkletProcessor {\n    static get fnNames(): string[] {\n        return [];\n    }\n    _disposed = false;\n    constructor(options: AudioWorkletNodeOptions) {\n        super(options);\n        const resolves: Record<number, ((...args: any[]) => any)> = {};\n        const rejects: Record<number, ((...args: any[]) => any)> = {};\n        let messagePortRequestId = -1;\n        const handleDisposed = () => {\n            this.port.removeEventListener(\"message\", handleMessage);\n            this.port.close();\n        };\n        const handleMessage = async (e: TypedMessageEvent<MessagePortResponse & MessagePortRequest>) => {\n            const { id, call, args, value, error } = e.data;\n            if (call) {\n                const r: MessagePortResponse = { id };\n                try {\n                    r.value = await (this as any)[call](...args);\n                } catch (e) {\n                    r.error = e;\n                }\n                this.port.postMessage(r as any);\n                if (this._disposed) handleDisposed();\n            } else {\n                if (error) {\n                    if (rejects[id]) rejects[id](error);\n                    delete rejects[id];\n                    return;\n                }\n                if (resolves[id]) {\n                    resolves[id](value);\n                    delete resolves[id];\n                }\n            }\n        };\n        const call = (call: string, ...args: any[]) => new Promise<any>((resolve, reject) => {\n            const id = messagePortRequestId--;\n            resolves[id] = resolve;\n            rejects[id] = reject;\n            this.port.postMessage({ id, call, args });\n        });\n        const Ctor = (this.constructor as typeof AudioWorkletProxyProcessor);\n        Ctor.fnNames.forEach(name => (this as any)[name] = (...args: any[]) => call(name, ...args));\n        this.port.start();\n        this.port.addEventListener(\"message\", handleMessage);\n    }\n} as typeof AudioWorkletProxyProcessor;\n\nexport default Processor;\n","export const $AnyEventType = Symbol(\"__TypedEventListener_AnyEventType\");\nexport interface ITypedEventEmitter<M> extends Omit<TypedEventEmitter<M>, \"_listeners\" | \"getListeners\"> {\n}\nexport interface IEmitOptions {\n    /** if true, the emission will not trigger `onAny` listeners */\n    excludeAny?: boolean;\n    /** Exclude listeners with emit */\n    exclude?: ((...args: any[]) => any)[];\n}\nexport class TypedEventEmitter<M> {\n    private _listeners: { [eventName: string]: ((e?: any, emitter?: any) => any | Promise<any>)[]; [$AnyEventType]: ((eventName: string, eventData?: any, emitter?: any) => any | Promise<any>)[] } = { [$AnyEventType]: [] };\n    get listeners() {\n        return this._listeners;\n    }\n    private getListeners<K extends keyof M & string>(eventName: K) {\n        if (!(eventName in this._listeners)) this._listeners[eventName] = [];\n        return this._listeners[eventName];\n    }\n    on<K extends keyof M & string>(eventName: K, listener: (e: M[K], emitter?: this) => any) {\n        if (this.getListeners(eventName).indexOf(listener) === -1) this.getListeners(eventName).push(listener);\n    }\n    once<K extends keyof M & string>(eventName: K, listener: (e: M[K], emitter?: this) => any) {\n        const listenerWithOff = (arg: M[K], emitter?: this) => {\n            const returnValue = listener(arg, emitter);\n            this.off(eventName, listenerWithOff);\n            return returnValue;\n        };\n        this.on(eventName, listenerWithOff);\n    }\n    onAny<K extends keyof M & string>(listener: <KK extends K>(eventName: KK, eventData?: M[KK], emitter?: this) => any) {\n        this._listeners[$AnyEventType].push(listener);\n    }\n    off<K extends keyof M & string>(eventName: K, listener: (e: M[K], emitter?: this) => any) {\n        const i = this.getListeners(eventName).indexOf(listener);\n        if (i !== -1) this.getListeners(eventName).splice(i, 1);\n    }\n    offAny<K extends keyof M & string>(listener: <KK extends K>(eventName: KK, eventData?: M[KK], emitter?: this) => any) {\n        const i = this._listeners[$AnyEventType].indexOf(listener);\n        if (i !== -1) this._listeners[$AnyEventType].splice(i, 1);\n    }\n    async emit<K extends keyof M & string>(eventName: K, eventData?: M[K], options?: IEmitOptions) {\n        let listeners = this.getListeners(eventName);\n        let anyListeners = options?.excludeAny ? [] : this._listeners[$AnyEventType];\n        if (!listeners.length && !anyListeners.length) return [];\n        if (options?.exclude?.length) {\n            const { exclude } = options;\n            listeners = listeners.filter(l => exclude.indexOf(l) === -1);\n            anyListeners = anyListeners.filter(l => exclude.indexOf(l) === -1);\n        }\n        return Promise.all([...listeners.map(f => f(eventData, this)), ...anyListeners.map(f => f(eventName, eventData, this))]);\n    }\n    async emitSerial<K extends keyof M & string>(eventName: K, eventData?: M[K], options?: IEmitOptions) {\n        let listeners = this.getListeners(eventName);\n        let anyListeners = options?.excludeAny ? [] : this._listeners[$AnyEventType];\n        if (!listeners.length && !anyListeners.length) return [];\n        if (options?.exclude?.length) {\n            const { exclude } = options;\n            listeners = listeners.filter(l => exclude.indexOf(l) === -1);\n            anyListeners = anyListeners.filter(l => exclude.indexOf(l) === -1);\n        }\n        const returnValues = [];\n        for (let i = 0; i < listeners.length; i++) {\n            const listener = listeners[i];\n            returnValues[i] = await listener(eventData, this);\n        }\n        for (let i = 0; i < anyListeners.length; i++) {\n            const listener = anyListeners[i];\n            returnValues[listeners.length + i] = await listener(eventName, eventData, this);\n        }\n        return returnValues;\n    }\n    emitSync<K extends keyof M & string>(eventName: K, eventData?: M[K], options?: IEmitOptions) {\n        let listeners = this.getListeners(eventName);\n        let anyListeners = options?.excludeAny ? [] : this._listeners[$AnyEventType];\n        if (!listeners.length && !anyListeners.length) return [];\n        if (options?.exclude?.length) {\n            const { exclude } = options;\n            listeners = listeners.filter(l => exclude.indexOf(l) === -1);\n            anyListeners = anyListeners.filter(l => exclude.indexOf(l) === -1);\n        }\n        return [...listeners.map(f => f(eventData, this)), ...anyListeners.map(f => f(eventName, eventData, this))];\n    }\n    offAll(eventName?: keyof M & string) {\n        if (eventName) {\n            this._listeners[eventName] = [];\n        } else {\n            this._listeners = { [$AnyEventType]: [] };\n        }\n    }\n    listenerCount(eventName: keyof M & string) {\n        const anyListenerCount = this._listeners[$AnyEventType].length;\n        if (!(eventName in this._listeners)) return anyListenerCount;\n        return this._listeners[eventName].length + anyListenerCount;\n    }\n}\n\nexport default TypedEventEmitter;\n","export const ImporterDirSelfObject = Symbol(\"__JSPatcher_ImporterDirSelfObject\");\nexport const ImportedStaticMethodObject = Symbol(\"__JSPatcher_ImportedStaticMethodObject\");\nexport const SharedDataNoValue = Symbol(\"__JSPatcher_ShareDataNoValue\");\nexport const TempManagerFolder = Symbol(\"__JSPatcher_TempManagerFolder\");\n","/* eslint-disable arrow-body-style */\nimport type { TPatcherProps } from \"../core/patcher/Patcher\";\nimport type { TMIDIEvent, TBPF, TRect, TPresentationRect, ProjectItemType, RawPatcher, TMaxPatcher, TAudioUnit } from \"../core/types\";\n\nexport const isStringArray = (x: any): x is string[] => Array.isArray(x) && x.every(e => typeof e === \"string\");\nexport const isNumberArray = (x: any): x is number[] => Array.isArray(x) && x.every(e => typeof e === \"number\");\nexport const isTRect = (x: any): x is TRect => {\n    return isNumberArray(x)\n        && x.length === 4\n        && x[0] >= 0\n        && x[1] >= 0\n        && x[2] >= 15\n        && x[3] >= 15;\n};\nexport const isTPresentationRect = (x: any): x is TPresentationRect => {\n    return Array.isArray(x)\n        && x.length === 4\n        && x.every(v => typeof v === \"number\" || typeof v === \"string\");\n};\nexport const isRectMovable = (x: any): x is [number, number, number | string, number | string] => {\n    return isTPresentationRect(x) && typeof x[0] === \"number\" && typeof x[1] === \"number\";\n};\nexport const isRectResizable = (x: any): x is TRect => isTRect(x);\nexport const isMIDIEvent = (x: any): x is TMIDIEvent => (isNumberArray(x) || x instanceof Uint8Array) && x.length === 3;\nexport const stringifyError = (data: any) => {\n    if (typeof data === \"string\") return data;\n    if (data instanceof Error) return data.message;\n    if (typeof data === \"object\") return JSON.stringify(data);\n    return `${data}`;\n};\nexport const parseToPrimitive = (value: any) => {\n    try {\n        return JSON.parse(value);\n    } catch (e) {\n        return value.toString();\n    }\n};\nexport const rgbaMax2Css = (maxColor: number[]) => {\n    const cssColor = [255, 255, 255, 1] as TRect;\n    if (Array.isArray(maxColor)) {\n        for (let i = 0; i < 3; i++) {\n            if (typeof maxColor[i] === \"number\") cssColor[i] = Math.floor(maxColor[i] * 255);\n        }\n        if (typeof maxColor[3] === \"number\") cssColor[3] = maxColor[3];\n    }\n    return `rgba(${cssColor.join(\",\")})`;\n};\nexport const css2RgbaMax = (color: string) => {\n    const maxColor = [0.2, 0.2, 0.2, 1] as TRect;\n    const matched = color.match(/rgba\\((.+)\\)/);\n    if (!matched) return maxColor;\n    const cssColor = matched[1].split(\",\").map(s => +s);\n    for (let i = 0; i < 3; i++) {\n        if (typeof cssColor[i] === \"number\") maxColor[i] = cssColor[i] / 255;\n        if (typeof cssColor[3] === \"number\") maxColor[3] = cssColor[3];\n    }\n    return maxColor;\n};\n/**\n * A BPF can be described as a succesion of three number tuples.\n * i.e. `1 1 0.5 2 1 1` curve mode means go to 0 immediately then go to 1 in 1s with a curve of e^0.5, then go to 2 in 1s linear.\n * The function transform the string to number[][], i.e. `[[1, 1, 0.5], [2, 1, 1]]`\n *\n * @param {TBPF} sIn\n * @returns {number[][]}\n */\nexport const decodeBPF = (sIn: TBPF, tupleLength: number): number[][] => {\n    if (typeof sIn === \"number\") return [[sIn]];\n    if (isNumberArray(sIn)) return [sIn];\n    if (Array.isArray(sIn) && sIn.every(a => isNumberArray(a))) return sIn;\n    if (typeof sIn !== \"string\") throw new Error(\"Failed to decode curve.\");\n    const numbers = sIn.split(\" \").filter(s => !!s).map(s => +s);\n    if (numbers.find(v => !isFinite(v))) throw new Error(\"BPF contains invalid number.\");\n    const tuples: number[][] = [];\n    for (let i = 0; i < numbers.length; i++) {\n        const $tuple = ~~(i / tupleLength);\n        const $ = i % tupleLength;\n        if (!tuples[$tuple]) tuples[$tuple] = [];\n        tuples[$tuple][$] = numbers[i];\n    }\n    return tuples;\n};\nexport const decodeCurve = (sIn: TBPF) => decodeBPF(sIn, 3);\nexport const decodeLine = (sIn: TBPF) => decodeBPF(sIn, 2);\n\n/**\n * Gives OS name as follows:\n * \"Windows\"    for all versions of Windows,\n * \"MacOS\"      for all versions of Macintosh OS,\n * \"Linux\"      for all versions of Linux,\n * \"UNIX\"       for all other UNIX flavors,\n * \"Unknown\" indicates failure to detect the OS\n *\n * @returns {\"Windows\" | \"MacOS\" | \"UNIX\" | \"Linux\" | \"Unknown\"} OS name\n */\nexport const detectOS = (): \"Windows\" | \"MacOS\" | \"UNIX\" | \"Linux\" | \"Unknown\" => {\n    const { appVersion } = navigator;\n    if (appVersion.indexOf(\"Win\") !== -1) return \"Windows\";\n    if (appVersion.indexOf(\"Mac\") !== -1) return \"MacOS\";\n    if (appVersion.indexOf(\"X11\") !== -1) return \"UNIX\";\n    if (appVersion.indexOf(\"Linux\") !== -1) return \"Linux\";\n    return \"Unknown\";\n};\nexport const detectBrowserCore = () => {\n    if ((window as any).chrome) return \"Chromium\";\n    if ((window as any).InstallTrigger) return \"Gecko\";\n    if (navigator.vendor.indexOf(\"Apple\") !== -1) return \"WebKit\";\n    return \"Unknown\";\n};\nexport const roundedRect = (ctx: CanvasRenderingContext2D, x: number, y: number, width: number, height: number, radius: number | number[]) => {\n    const radii = [0, 0, 0, 0];\n    if (typeof radius === \"number\") radii.fill(radius);\n    else radius.forEach((v, i) => radii[i] = v);\n    ctx.beginPath();\n    ctx.moveTo(x + radii[0], y);\n    ctx.lineTo(x + width - radii[1], y);\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radii[1]);\n    ctx.lineTo(x + width, y + height - radii[2]);\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radii[2], y + height);\n    ctx.lineTo(x + radii[3], y + height);\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radii[3]);\n    ctx.lineTo(x, y + radii[0]);\n    ctx.quadraticCurveTo(x, y, x + radii[0], y);\n    ctx.closePath();\n    ctx.stroke();\n};\nexport const fillRoundedRect = (ctx: CanvasRenderingContext2D, x: number, y: number, width: number, height: number, radius: number | number[]) => {\n    const radii = [0, 0, 0, 0];\n    if (typeof radius === \"number\") radii.fill(radius);\n    else radius.forEach((v, i) => radii[i] = v);\n    ctx.beginPath();\n    ctx.moveTo(x + radii[0], y);\n    ctx.lineTo(x + width - radii[1], y);\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radii[1]);\n    ctx.lineTo(x + width, y + height - radii[2]);\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radii[2], y + height);\n    ctx.lineTo(x + radii[3], y + height);\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radii[3]);\n    ctx.lineTo(x, y + radii[0]);\n    ctx.quadraticCurveTo(x, y, x + radii[0], y);\n    ctx.closePath();\n    ctx.fill();\n};\nexport const selectElementRange = (e: HTMLElement) => {\n    const elementIsEditable = (e: HTMLElement): e is HTMLInputElement | HTMLTextAreaElement => !!e.nodeName.match(/^(INPUT|TEXTAREA)$/i);\n    const selection = window.getSelection();\n    if (elementIsEditable(e)) {\n        e.focus();\n        e.select();\n        return;\n    }\n    if (selection.setBaseAndExtent) {\n        // Safari\n        selection.setBaseAndExtent(e, 0, e, e.hasChildNodes() ? 1 : 0);\n        return;\n    }\n    if (selection.addRange && selection.removeAllRanges && document.createRange) {\n        // Mozilla or Opera 10.5+\n        const range = document.createRange();\n        range.selectNodeContents(e);\n        selection.removeAllRanges();\n        selection.addRange(range);\n    }\n};\nexport const selectElementPos = (e: HTMLElement, pos: number) => {\n    const range = document.createRange();\n    const selection = window.getSelection();\n    range.setStart(e.childNodes[0], pos);\n    range.collapse(true);\n    selection.removeAllRanges();\n    selection.addRange(range);\n};\nexport const findFromAscendants = (e: HTMLElement, predict: (e: HTMLElement) => boolean) => {\n    const ascendants = [];\n    let parent = e.parentElement;\n    while (parent !== document.body) {\n        ascendants.push(parent);\n        parent = parent.parentElement;\n    }\n    return ascendants.find(predict);\n};\n// eslint-disable-next-line arrow-body-style\nexport const getPropertyDescriptor = (obj: Record<string, any>, key: string): PropertyDescriptor => {\n    return Object.getOwnPropertyDescriptor(obj, key) || getPropertyDescriptor(Object.getPrototypeOf(obj), key);\n};\nexport const getPropertyDescriptors = (obj: Function | Record<string, any>): PropertyDescriptorMap => {\n    if (typeof obj === \"function\") return Object.getOwnPropertyDescriptors(obj);\n    const proto = Object.getPrototypeOf(obj);\n    if (obj !== Object.prototype && proto === Object.prototype) return Object.getOwnPropertyDescriptors(obj);\n    return Object.assign(proto ? getPropertyDescriptors(proto) : {}, Object.getOwnPropertyDescriptors(obj));\n};\n\nexport const extToType = (ext: string): Exclude<ProjectItemType, \"folder\"> => {\n    if ([\"jspat\", \"maxpat\", \"gendsp\", \"dsppat\"].indexOf(ext) !== -1) return \"patcher\";\n    if ([\"wav\", \"aif\", \"aiff\", \"mp3\", \"aac\", \"flac\", \"ogg\", \"m4a\"].indexOf(ext) !== -1) return \"audio\";\n    if ([\"txt\", \"json\"].indexOf(ext) !== -1) return \"text\";\n    if ([\"apng\", \"avif\", \"gif\", \"jpg\", \"jpeg\", \"jfif\", \"pjpeg\", \"pjp\", \"png\", \"svg\", \"webp\", \"bmp\", \"ico\", \"cur\", \"tif\", \"tiff\"].indexOf(ext) !== -1) return \"image\";\n    if ([\"mp4\", \"webm\", \"3gp\"].indexOf(ext) !== -1) return \"video\";\n    return \"unknown\";\n};\n\nexport const max2js = (patcherIn: TMaxPatcher, mode = \"max\" as TPatcherProps[\"mode\"]): RawPatcher => {\n    const patcher: RawPatcher = { boxes: {}, lines: {} };\n    const maxPatcher = (patcherIn as TMaxPatcher).patcher;\n    patcher.props = {\n        bgColor: rgbaMax2Css(maxPatcher.bgcolor),\n        editingBgColor: rgbaMax2Css(maxPatcher.editing_bgcolor),\n        dependencies: [],\n        grid: maxPatcher.gridsize,\n        openInPresentation: !!maxPatcher.openinpresentation,\n        mode\n    };\n    const maxBoxes = maxPatcher.boxes;\n    const maxLines = maxPatcher.lines;\n    for (let i = 0; i < maxBoxes.length; i++) {\n        const maxBox = maxBoxes[i].box;\n        const numID = parseInt(maxBox.id.match(/\\d+/)[0]);\n        const id = \"box-\" + numID;\n        patcher.boxes[id] = {\n            id,\n            inlets: maxBox.numinlets,\n            outlets: maxBox.numoutlets,\n            rect: maxBox.patching_rect,\n            presentationRect: maxBox.presentation_rect,\n            background: !!maxBox.background,\n            presentation: !!maxBox.presentation,\n            text: (maxBox.maxclass === \"newobj\" ? \"\" : maxBox.maxclass + \" \") + (maxBox.text ? maxBox.text : \"\")\n        };\n    }\n    for (let i = 0; i < maxLines.length; i++) {\n        const lineArgs = maxLines[i].patchline;\n        const id = \"line-\" + i;\n        patcher.lines[id] = {\n            id,\n            src: [lineArgs.source[0].replace(/obj/, \"box\"), lineArgs.source[1]],\n            dest: [lineArgs.destination[0].replace(/obj/, \"box\"), lineArgs.destination[1]]\n        };\n    }\n    return patcher;\n};\n\nexport const js2max = (patcherIn: RawPatcher): TMaxPatcher => {\n    const maxPatcher: TMaxPatcher[\"patcher\"] = {\n        boxes: [],\n        lines: [],\n        rect: undefined,\n        bgcolor: css2RgbaMax(patcherIn.props.bgColor),\n        editing_bgcolor: css2RgbaMax(patcherIn.props.editingBgColor),\n        gridsize: patcherIn.props.grid,\n        openinpresentation: +patcherIn.props.openInPresentation\n    };\n    for (const id in patcherIn.boxes) {\n        const box = patcherIn.boxes[id];\n        const numID = parseInt(id.match(/\\d+/)[0]);\n        maxPatcher.boxes.push({\n            box: {\n                id: `obj-${numID}`,\n                maxclass: \"newobj\",\n                numinlets: box.inlets,\n                numoutlets: box.outlets,\n                patching_rect: box.rect,\n                presentation: +box.presentation,\n                background: +box.background,\n                text: box.text\n            }\n        });\n    }\n    for (const id in patcherIn.lines) {\n        const line = patcherIn.lines[id];\n        maxPatcher.lines.push({\n            patchline: {\n                source: [line.src[0].replace(/box/, \"obj\"), line.src[1]],\n                destination: [line.dest[0].replace(/box/, \"obj\"), line.dest[1]]\n            }\n        });\n    }\n    return { patcher: maxPatcher };\n};\n\nexport const convertSampleToUnit = (sample: number, unit: TAudioUnit, { sampleRate = 48000, bpm = 60, beatsPerMeasure = 4, division = 16 }) => {\n    if (unit === \"sample\") return { unit, str: sample.toString(), value: sample, values: [sample] };\n    const milliseconds = sample * 1000 / sampleRate;\n    const roundedMs = Math.round(milliseconds);\n    if (unit === \"measure\") {\n        const dpms = bpm * division / 60000;\n        const totalDivisions = dpms * milliseconds;\n        const roundedTotalDivisions = dpms * milliseconds;\n        const divisions = ~~(roundedTotalDivisions % division);\n        const beats = ~~(roundedTotalDivisions / division) % beatsPerMeasure + 1;\n        const measure = ~~(roundedTotalDivisions / beatsPerMeasure / division) + 1;\n        const str = `${measure}:${beats}.${divisions.toString().padStart(2, \"0\")}`;\n        return { unit, str, value: totalDivisions / division, values: [measure, beats, divisions] };\n    }\n    // if (unit === \"time\")\n    const ms = roundedMs % 1000;\n    const s = ~~(roundedMs / 1000) % 60;\n    const min = ~~(roundedMs / 60000) % 60;\n    const h = ~~(roundedMs / 3600000);\n    const str = !min ? `${s}.${ms.toString().padStart(3, \"0\")}`\n        : !h ? `${min}:${s.toString().padStart(2, \"0\")}.${ms.toString().padStart(3, \"0\")}`\n            : `${h}:${min.toString().padStart(2, \"0\")}:${s.toString().padStart(2, \"0\")}.${ms.toString().padStart(3, \"0\")}`;\n    return { unit, str, value: milliseconds / 1000, values: [h, min, s, ms] };\n};\nexport const MEASURE_UNIT_REGEX = /^((\\d+):)?(\\d+)\\.?(\\d+)?$/;\nexport const TIME_UNIT_REGEX = /^((\\d+):)??((\\d+):)?(\\d+)\\.?(\\d+)?$/;\nexport const convertUnitToSample = (str: string, unit: TAudioUnit, { sampleRate = 48000, bpm = 60, beatsPerMeasure = 4, division = 16 }) => {\n    if (unit === \"sample\") return +str || 0;\n    if (unit === \"measure\") {\n        const matched = str.match(MEASURE_UNIT_REGEX);\n        if (!matched) throw new Error(`String ${str} cannot be parsed to ${unit}`);\n        const [, , measureIn, beatsIn, divisionsIn] = matched;\n        const bps = bpm / 60;\n        const samplesPerBeat = sampleRate / bps;\n        let measures = +measureIn || 0;\n        let beats = +beatsIn || 0;\n        let divisions = +divisionsIn || 0;\n        beats += ~~(divisions / division);\n        divisions %= division;\n        measures += ~~(beats / beatsPerMeasure);\n        beats %= beatsPerMeasure;\n        return (measures * beatsPerMeasure + beats + divisions / division) * samplesPerBeat;\n    }\n    const matched = str.match(TIME_UNIT_REGEX);\n    if (!matched) throw new Error(`String ${str} cannot be parsed to ${unit}`);\n    const [, , hIn, , minIn, sIn, msIn] = matched;\n    let h = +hIn || 0;\n    let min = +minIn || 0;\n    let s = +sIn || 0;\n    let ms = +msIn || 0;\n    s += ~~(ms / 1000);\n    ms %= 1000;\n    min += ~~(s / 60);\n    s %= 60;\n    h += ~~(min / 60);\n    min %= 60;\n    return (h * 3600 + min * 60 + s + ms / 1000) * sampleRate;\n};\n\nexport const ab2sab = (ab: SharedArrayBuffer | ArrayBuffer) => {\n    if (ab instanceof ArrayBuffer) return ab;\n    const sab = new SharedArrayBuffer(ab.byteLength);\n    const ui8ab = new Uint8Array(ab);\n    const ui8sab = new Uint8Array(sab);\n    for (let i = 0; i < ui8ab.length; i++) {\n        ui8sab[i] = ui8ab[i];\n    }\n    return sab;\n};\n\nexport const sab2ab = (sab: SharedArrayBuffer | ArrayBuffer) => {\n    if (sab instanceof SharedArrayBuffer) return sab;\n    const ab = new ArrayBuffer(sab.byteLength);\n    const ui8ab = new Uint8Array(ab);\n    const ui8sab = new Uint8Array(sab);\n    for (let i = 0; i < ui8sab.length; i++) {\n        ui8ab[i] = ui8sab[i];\n    }\n    return ab;\n};\nexport const ab2str = (buf: ArrayBuffer) => {\n    return String.fromCharCode.apply(null, new Uint16Array(buf));\n};\n\nexport const str2ab = (str: string) => {\n    const buf = new ArrayBuffer(str.length * 2); // 2 bytes for each char\n    const bufView = new Uint16Array(buf);\n    for (let i = 0, strLen = str.length; i < strLen; i++) {\n        bufView[i] = str.charCodeAt(i);\n    }\n    return buf;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","import AudioWorkletProxyProcessor from \"./AudioWorkletProxyProcessor\";\nimport TaskManager from \"../TaskMgr\";\nimport TemporaryProjectItemManager from \"../file/TemporaryProjectItemManager\";\nimport TypedEventEmitter from \"../../utils/TypedEventEmitter\";\nimport WorkletProjectItemManager from \"../file/WorkletProjectItemManager\";\nimport WorkletGlobalPackageManager from \"../WorkletGlobalPackageManager\";\nimport Project from \"../Project\";\nimport JSPatcherWorkletSDK from \"../WorkletSDK\";\nimport type { WorkletEnvParameters, IWorkletEnvNode, IWorkletEnvProcessor, WorkletEnvOptions } from \"./WorkletEnv.types\";\nimport type { AudioWorkletGlobalScope, TypedAudioWorkletNodeOptions } from \"./TypedAudioWorklet\";\nimport type { Task, TaskError } from \"../TaskMgr\";\nimport type { EnvEventMap, IJSPatcherEnv } from \"../Env\";\nimport type { IFileEditor } from \"../file/FileEditor\";\nimport type { IFileInstance } from \"../file/FileInstance\";\nimport type { ProjectItemManagerDataForDiff } from \"../file/PersistentProjectItemManager\";\nimport type { TErrorLevel } from \"../types\";\n\nexport const processorId = \"__JSPatcher_WorkletEnv\";\ndeclare const globalThis: AudioWorkletGlobalScope;\nconst { registerProcessor } = globalThis;\n\nexport default class WorkletEnvProcessor extends AudioWorkletProxyProcessor<IWorkletEnvProcessor, IWorkletEnvNode, WorkletEnvParameters, WorkletEnvOptions> implements IWorkletEnvProcessor, IJSPatcherEnv {\n    static fnNames: (keyof IWorkletEnvNode)[] = [\"envNewLog\", \"taskBegin\", \"taskUpdate\", \"taskError\", \"taskEnd\", \"fileMgrExists\", \"fileMgrGetFileDetails\", \"fileMgrPutFile\", \"fileMgrReadDir\", \"fileMgrReadFile\", \"fileMgrWriteFile\", \"fileMgrGetPathIdMap\", \"fileMgrDiff\", \"addObjects\", \"addWorkletModule\"];\n    private readonly ee = new TypedEventEmitter<EnvEventMap>();\n    readonly thread = \"AudioWorklet\";\n    readonly os: \"Windows\" | \"MacOS\" | \"UNIX\" | \"Linux\" | \"Unknown\";\n    readonly browser: \"Unknown\" | \"Chromium\" | \"Gecko\" | \"WebKit\";\n    readonly language: string;\n    readonly generatedId: Uint32Array;\n    readonly taskMgr = new TaskManager();\n    readonly fileMgr: WorkletProjectItemManager;\n    readonly tempMgr: TemporaryProjectItemManager;\n    readonly pkgMgr: WorkletGlobalPackageManager;\n    readonly sdk = new JSPatcherWorkletSDK();\n    currentProject: Project;\n    constructor(options?: TypedAudioWorkletNodeOptions<WorkletEnvOptions>) {\n        super(options);\n        globalThis.jspatcherEnv = this;\n        const { os, browser, language, generatedId } = options.processorOptions;\n        this.os = os;\n        this.browser = browser;\n        this.language = language;\n        this.generatedId = generatedId;\n        this.fileMgr = new WorkletProjectItemManager(this);\n        this.tempMgr = new TemporaryProjectItemManager(this);\n        this.pkgMgr = new WorkletGlobalPackageManager(this);\n    }\n    async init() {\n        await this.pkgMgr.init();\n        this.currentProject = new Project(this);\n        await this.fileMgr.init();\n        await this.tempMgr.init();\n        this.bindTaskMgr();\n        this.bindFileMgr();\n    }\n    instances = new Set<IFileInstance>();\n    activeInstance: IFileInstance;\n    activeEditor: IFileEditor;\n    newLog(errorLevel: TErrorLevel, title: string, message: string, emitterIn?: any) {\n        const emitter = typeof emitterIn === \"string\" ? emitterIn : typeof emitterIn === \"object\" ? emitterIn.constructor.name : typeof emitterIn === \"function\" ? emitterIn.name : \"\";\n        this.envNewLog(errorLevel, title, message, emitter);\n    }\n    generateId(objectIn: object) {\n        return this.thread + objectIn.constructor.name + Atomics.add(this.generatedId, 0, 1);\n    }\n    registerInstance(i: IFileInstance, id?: string) {\n        this.instances.add(i);\n        i.on(\"destroy\", () => {\n            this.instances.delete(i);\n            this.ee.emit(\"instances\", Array.from(this.instances));\n        });\n        this.ee.emit(\"instances\", Array.from(this.instances));\n        if (!id) return this.generateId(i);\n        return id;\n    }\n    getInstanceById(id: string) {\n        for (const instance of this.instances) {\n            if (instance.id === id) return instance;\n        }\n        return null;\n    }\n    // get _listeners() { return this.ee._listeners; }\n    // get getListeners() { return this.ee.getListeners; }\n    get listeners() { return this.ee.listeners; }\n    get on() { return this.ee.on; }\n    get once() { return this.ee.once; }\n    get onAny() { return this.ee.onAny; }\n    get off() { return this.ee.off; }\n    get offAny() { return this.ee.offAny; }\n    get offAll() { return this.ee.offAll; }\n    get emit() { return this.ee.emit; }\n    get emitSerial() { return this.ee.emitSerial; }\n    get emitSync() { return this.ee.emitSync; }\n    get listenerCount() { return this.ee.listenerCount; }\n    bindTaskMgr() {\n        const handleTaskBegin = ({ id, message, emitter }: Task) => this.taskBegin({ id, message, emitter: typeof emitter === \"string\" ? emitter : emitter.constructor?.name });\n        const handleTaskUpdate = ({ id, message }: Task) => this.taskUpdate({ id, message });\n        const handleTaskError = ({ id, error }: TaskError) => this.taskError({ id, error });\n        const handleTaskEnd = ({ id }: Task) => this.taskEnd({ id });\n        this.taskMgr.on(\"taskBegin\", handleTaskBegin);\n        this.taskMgr.on(\"taskUpdate\", handleTaskUpdate);\n        this.taskMgr.on(\"taskError\", handleTaskError);\n        this.taskMgr.on(\"taskEnd\", handleTaskEnd);\n    }\n    handleFileMgrChange = () => {\n        if (this.fileMgr.disabled) return;\n        this.fileMgrDiff(this.fileMgr.getDataForDiff());\n    };\n    bindFileMgr() {\n        this.fileMgr.on(\"changed\", this.handleFileMgrChange);\n    }\n    async workletFileMgrDiff(diff: ProjectItemManagerDataForDiff) {\n        this.fileMgr.off(\"changed\", this.handleFileMgrChange);\n        await this.fileMgr.processDiff(diff);\n        this.fileMgr.on(\"changed\", this.handleFileMgrChange);\n    }\n    async importPackage(url: string, id: string) {\n        await this.pkgMgr.importPackage(url, id);\n    }\n    process(inputs: Float32Array[][], outputs: Float32Array[][]) {\n        if (this._disposed) return false;\n        return true;\n    }\n}\n\ntry {\n    registerProcessor(processorId, WorkletEnvProcessor);\n} catch (error) {\n    // eslint-disable-next-line no-console\n    console.warn(error);\n}\n"],"sourceRoot":""}