{"version":3,"file":"src_core_image_PatcherImage_ts.js/006728419813a3d551d6.worklet.js","mappings":"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","sources":["webpack://JSPatcher/./src/core/image/ImageEditor.ts","webpack://JSPatcher/./src/core/image/PatcherImage.ts"],"sourcesContent":["import type { SemanticICONS } from \"semantic-ui-react\";\nimport FileEditor from \"../file/FileEditor\";\nimport History from \"../file/History\";\nimport type PersistentProjectFile from \"../file/PersistentProjectFile\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\nimport type PatcherImage from \"./PatcherImage\";\n\nexport interface ImageEditorEventMap {}\n\nexport default class ImageEditor extends FileEditor<PatcherImage, ImageEditorEventMap> {\n    static async fromProjectItem({ file, env, project, instanceId }: { file: PersistentProjectFile; env: IJSPatcherEnv; project?: IProject; instanceId: string }) {\n        const image = await file.instantiate({ env, project, instanceId }) as PatcherImage;\n        const editor = new this(image);\n        return editor.init();\n    }\n    readonly _history: History;\n    get fileExtension() {\n        return \"png\";\n    }\n    get fileIcon(): SemanticICONS {\n        return \"picture\";\n    }\n    get history() {\n        return this._history;\n    }\n    async init() {\n        if (!this.instance.isReady) {\n            await new Promise<void>((resolve, reject) => {\n                const handleReady = () => {\n                    resolve();\n                    this.instance.off(\"ready\", handleReady);\n                };\n                this.instance.on(\"ready\", handleReady);\n            });\n        }\n        this._isReady = true;\n        this.emit(\"ready\");\n        return this;\n    }\n    async undo() {}\n    async redo() {}\n    async copy() {}\n    async cut() {}\n    async paste() {}\n    async deleteSelected() {}\n    async selectAll() {}\n    onUiResized() {}\n}\n","import FileInstance from \"../file/FileInstance\";\nimport ImageEditor from \"./ImageEditor\";\nimport type PersistentProjectFile from \"../file/PersistentProjectFile\";\nimport type { IJSPatcherEnv } from \"../Env\";\nimport type { IProject } from \"../Project\";\n\nexport interface PatcherImageEventMap {}\n\nexport default class PatcherImage extends FileInstance<PatcherImageEventMap, PersistentProjectFile> {\n    static async fromProjectItem(options: { file: PersistentProjectFile; env: IJSPatcherEnv; project?: IProject; instanceId?: string }) {\n        return new this(options).init(options.file.data);\n    }\n    objectURL: string;\n    async getEditor() {\n        const editor = new ImageEditor(this);\n        return editor.init();\n    }\n    async init(data?: ArrayBuffer) {\n        if (data) this.objectURL = URL.createObjectURL(await new Response(data).blob());\n        else this.objectURL = \"\";\n        this._isReady = true;\n        this.emit(\"ready\");\n        return this;\n    }\n    async serialize() {\n        return (await fetch(this.objectURL)).arrayBuffer();\n    }\n    clone() {\n        const patcherText = new PatcherImage({ env: this.env, project: this.project, file: this.file });\n        patcherText.objectURL = this.objectURL;\n        return patcherText;\n    }\n}\n"],"names":["FileEditor","ImageEditor","fromProjectItem","file","env","project","instanceId","image","instantiate","editor","init","fileExtension","fileIcon","history","_history","instance","isReady","Promise","resolve","reject","handleReady","off","on","_isReady","emit","undo","redo","copy","cut","paste","deleteSelected","selectAll","onUiResized","FileInstance","PatcherImage","options","data","getEditor","objectURL","URL","createObjectURL","Response","blob","serialize","fetch","arrayBuffer","clone","patcherText"],"sourceRoot":""}