{"version":3,"file":"js/5af80e80309bef5f41c2.js","mappings":";;;;;;;;;;;;;;;;;;;CAAiD;;AACjD;AACA;AAMA,MAAMG,WAAW,GAAG,qBAApB;AAEe,MAAMC,WAAN,SAA0BH,2DAA1B,CAA4I;AAKvJI,EAAAA,WAAW,CAACC,OAAD,EAA4BC,OAA5B,EAA+G;AACtH,UAAMD,OAAN,EAAeH,WAAf,EAA4B;AACxBK,MAAAA,cAAc,EAAED,OAAO,CAACE,MADA;AAExBC,MAAAA,eAAe,EAAEH,OAAO,CAACI,OAFD;AAGxBC,MAAAA,gBAAgB,EAAE,UAHM;AAIxBC,MAAAA,qBAAqB,EAAE,UAJC;AAKxBC,MAAAA,gBAAgB,EAAE;AAAEC,QAAAA,UAAU,EAAER,OAAO,CAACQ,UAAtB;AAAkCC,QAAAA,MAAM,EAAET,OAAO,CAACS,MAAlD;AAA0DC,QAAAA,IAAI,EAAEV,OAAO,CAACU;AAAxE;AALM,KAA5B;;AADsH;;AAAA,2CAkB1G,MAAM;AAClB,YAAMC,QAAQ,GAAG,KAAKC,OAAL,CAAaC,OAAb,CAAqBC,WAArB,EAAjB;AACA,WAAKC,IAAL,CAAUJ,QAAV;AACH,KArByH;;AAAA,yCAsB3GK,CAAD,IAAqC,KAAKC,EAAL,CAAQD,CAAC,CAACN,IAAV,EAAgBM,CAAC,CAACE,KAAlB,CAtBuE;;AAAA,2CAuB1G,MAAM,KAAKC,OAAL,EAvBoG;;AAQtH,SAAKP,OAAL,GAAeZ,OAAO,CAACoB,GAAR,CAAYC,eAAZ,CAA4BrB,OAAO,CAACQ,UAApC,CAAf;AACA,SAAKI,OAAL,CAAaU,EAAb,CAAgB,SAAhB,EAA2B,KAAKC,aAAhC;AACA,SAAKX,OAAL,CAAaU,EAAb,CAAgB,WAAhB,EAA6B,KAAKE,WAAlC;AACA,SAAKZ,OAAL,CAAaU,EAAb,CAAgB,SAAhB,EAA2B,KAAKG,aAAhC;AACA,UAAMC,QAAQ,GAAG,KAAKP,OAAtB;;AACA,SAAKA,OAAL,GAAe,YAAY;AACvB,YAAMO,QAAQ,CAACC,IAAT,CAAc,IAAd,CAAN;AACA,WAAKC,SAAL,GAAiB,IAAjB;AACH,KAHD;AAIH;;AAODC,EAAAA,MAAM,CAACC,IAAD,EAAepB,IAAf,EAA0B;AAC5B,SAAKE,OAAL,CAAaiB,MAAb,CAAoBC,IAApB,EAA0BpB,IAA1B;AACH;;AACDqB,EAAAA,qBAAqB,CAACC,KAAD,EAAgBC,SAAhB,EAAmCC,SAAnC,EAAmD;AAAA;;AACpE,oCAAO,KAAKtB,OAAL,CAAauB,KAAb,CAAmBH,KAAnB,CAAP,0DAAO,sBAA2BI,MAA3B,CAAkCC,IAAlC,CAAuCJ,SAAvC,EAAyDC,SAAzD,CAAP;AACH;;AAlCsJ;;gBAAtIrC,4BACID;;gBADJC,yBAEEyC,YAAD,IAAgC3C,mEAAA,CAA8B2C,YAA9B,EAA4C1C,WAA5C,EAAyDH,4DAAzD;;gBAFjCI,wBAG6B,CAAC,MAAD,EAAS,IAAT,EAAe,MAAf,EAAuB,YAAvB,EAAqC,SAArC;;;;;;;;;;ACblD,iBAAiB,qBAAuB","sources":["webpack://JSPatcher/./src/core/worklets/PatcherNode.ts","webpack://JSPatcher/./src/core/worklets/Patcher.worklet.ts"],"sourcesContent":["import processorURL from \"./Patcher.worklet.ts\"; // eslint-disable-line import/extensions\nimport AudioWorkletProxyNode from \"./AudioWorkletProxyNode\";\nimport AudioWorkletRegister from \"./AudioWorkletRegister\";\nimport type Patcher from \"../patcher/Patcher\";\nimport type { PatcherEventMap } from \"../patcher/Patcher\";\nimport type { IPatcherNode, IPatcherProcessor, PatcherOptions, PatcherParameters } from \"./PatcherWorklet.types\";\nimport type { IJSPatcherEnv } from \"../Env\";\n\nconst processorId = \"__JSPatcher_Patcher\";\n\nexport default class PatcherNode extends AudioWorkletProxyNode<IPatcherNode, IPatcherProcessor, PatcherParameters, PatcherOptions> implements IPatcherNode {\n    static processorId = processorId;\n    static register = (audioWorklet: AudioWorklet) => AudioWorkletRegister.register(audioWorklet, processorId, processorURL);\n    static fnNames: (keyof IPatcherProcessor)[] = [\"init\", \"fn\", \"sync\", \"objectEmit\", \"destroy\"];\n    readonly patcher: Patcher;\n    constructor(context: BaseAudioContext, options: { env: IJSPatcherEnv; inputs: number; outputs: number } & PatcherOptions) {\n        super(context, processorId, {\n            numberOfInputs: options.inputs,\n            numberOfOutputs: options.outputs,\n            channelCountMode: \"explicit\",\n            channelInterpretation: \"discrete\",\n            processorOptions: { instanceId: options.instanceId, fileId: options.fileId, data: options.data }\n        });\n        this.patcher = options.env.getInstanceById(options.instanceId) as Patcher;\n        this.patcher.on(\"changed\", this.handleChanged);\n        this.patcher.on(\"dataInput\", this.handleInput);\n        this.patcher.on(\"destroy\", this.handleDestroy);\n        const _destroy = this.destroy;\n        this.destroy = async () => {\n            await _destroy.call(this);\n            this._disposed = true;\n        };\n    }\n    handleChanged = () => {\n        const syncData = this.patcher.history.getSyncData();\n        this.sync(syncData);\n    };\n    handleInput = (e: PatcherEventMap[\"dataInput\"]) => this.fn(e.data, e.inlet);\n    handleDestroy = () => this.destroy();\n    outlet(port: number, data: any) {\n        this.patcher.outlet(port, data);\n    }\n    objectEmitFromWorklet(boxId: string, eventName: string, eventData: any) {\n        return this.patcher.boxes[boxId]?.object.emit(eventName as any, eventData);\n    }\n}\n","module.exports = __webpack_public_path__ + \"js/d7c431b73aee550d8d90.worklet.js\";"],"names":["processorURL","AudioWorkletProxyNode","AudioWorkletRegister","processorId","PatcherNode","constructor","context","options","numberOfInputs","inputs","numberOfOutputs","outputs","channelCountMode","channelInterpretation","processorOptions","instanceId","fileId","data","syncData","patcher","history","getSyncData","sync","e","fn","inlet","destroy","env","getInstanceById","on","handleChanged","handleInput","handleDestroy","_destroy","call","_disposed","outlet","port","objectEmitFromWorklet","boxId","eventName","eventData","boxes","object","emit","audioWorklet","register"],"sourceRoot":""}